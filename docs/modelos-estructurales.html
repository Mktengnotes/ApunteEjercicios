<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Modelos Estructurales | Apunte Problemas Resueltos</title>
  <meta name="description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Modelos Estructurales | Apunte Problemas Resueltos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Modelos Estructurales | Apunte Problemas Resueltos" />
  
  <meta name="twitter:description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  

<meta name="author" content="Marcel Goic" />


<meta name="date" content="2025-11-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-probabilisticos.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="custom-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Marketing Engineering</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prologo</a></li>
<li class="chapter" data-level="1" data-path="formulas-utiles.html"><a href="formulas-utiles.html"><i class="fa fa-check"></i><b>1</b> Formulas utiles</a></li>
<li class="chapter" data-level="2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html"><i class="fa fa-check"></i><b>2</b> Modelos de Regresion</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#metodología"><i class="fa fa-check"></i><b>2.2</b> Metodología</a></li>
<li class="chapter" data-level="2.3" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problemas-teóricos"><i class="fa fa-check"></i><b>2.3</b> Problemas Teóricos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e1-signo-esperado-y-significancia"><i class="fa fa-check"></i><b>2.3.1</b> E1: Signo esperado y significancia</a></li>
<li class="chapter" data-level="2.3.2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e2-regresión-lineal-vs-de-poisson"><i class="fa fa-check"></i><b>2.3.2</b> E2: Regresión Lineal vs de Poisson</a></li>
<li class="chapter" data-level="2.3.3" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e3-selección-automática-de-variables"><i class="fa fa-check"></i><b>2.3.3</b> E3: Selección automática de variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e4-regresión-log-nivel-y-log-log"><i class="fa fa-check"></i><b>2.3.4</b> E4: Regresión Log-Nivel y Log-Log</a></li>
<li class="chapter" data-level="2.3.5" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e5-capturar-efectos"><i class="fa fa-check"></i><b>2.3.5</b> E5: Capturar efectos</a></li>
<li class="chapter" data-level="2.3.6" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e6-coeficientes-y-parámetros"><i class="fa fa-check"></i><b>2.3.6</b> E6: Coeficientes y Parámetros</a></li>
<li class="chapter" data-level="2.3.7" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e7-qué-es-un-modelo-de-regresión"><i class="fa fa-check"></i><b>2.3.7</b> E7: ¿Qué es un modelo de Regresión?</a></li>
<li class="chapter" data-level="2.3.8" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#solución-problemas-teóricos"><i class="fa fa-check"></i><b>2.3.8</b> Solución problemas teóricos</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problemas-aplicados"><i class="fa fa-check"></i><b>2.4</b> Problemas Aplicados</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-1"><i class="fa fa-check"></i><b>2.4.1</b> Problema 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-2"><i class="fa fa-check"></i><b>2.4.2</b> Problema 2</a></li>
<li class="chapter" data-level="2.4.3" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-3"><i class="fa fa-check"></i><b>2.4.3</b> Problema 3</a></li>
<li class="chapter" data-level="2.4.4" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-4---p1-control-1-primavera-2025"><i class="fa fa-check"></i><b>2.4.4</b> Problema 4 - P1 Control 1 Primavera 2025</a></li>
<li class="chapter" data-level="2.4.5" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-5---p1-control-otoño-2025"><i class="fa fa-check"></i><b>2.4.5</b> Problema 5 - P1 Control Otoño 2025</a></li>
<li class="chapter" data-level="2.4.6" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-6---p1-control-primavera-2024"><i class="fa fa-check"></i><b>2.4.6</b> Problema 6 - P1 Control Primavera 2024</a></li>
<li class="chapter" data-level="2.4.7" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-7---p1-control-1-otoño-2024"><i class="fa fa-check"></i><b>2.4.7</b> Problema 7 - P1 Control 1 Otoño 2024</a></li>
<li class="chapter" data-level="2.4.8" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-8---p1-control-primavera-2023"><i class="fa fa-check"></i><b>2.4.8</b> Problema 8 - P1 Control Primavera 2023</a></li>
<li class="chapter" data-level="2.4.9" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-9---p1-control-otoño-2023"><i class="fa fa-check"></i><b>2.4.9</b> Problema 9 - P1 Control Otoño 2023</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html"><i class="fa fa-check"></i><b>3</b> Modelos Probabilisticos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#introducción-1"><i class="fa fa-check"></i><b>3.1</b> Introducción</a></li>
<li class="chapter" data-level="3.2" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#metodología-1"><i class="fa fa-check"></i><b>3.2</b> Metodología</a></li>
<li class="chapter" data-level="3.3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problemas-teóricos-1"><i class="fa fa-check"></i><b>3.3</b> Problemas Teóricos</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e1-tasa-de-respuesta"><i class="fa fa-check"></i><b>3.3.1</b> E1: Tasa de respuesta</a></li>
<li class="chapter" data-level="3.3.2" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e2-distribución-weibull"><i class="fa fa-check"></i><b>3.3.2</b> E2: Distribución Weibull</a></li>
<li class="chapter" data-level="3.3.3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e3-distribución-gamma-y-heterogeneidad"><i class="fa fa-check"></i><b>3.3.3</b> E3: Distribución Gamma y Heterogeneidad</a></li>
<li class="chapter" data-level="3.3.4" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e4-modelos-de-duración"><i class="fa fa-check"></i><b>3.3.4</b> E4: Modelos de Duración</a></li>
<li class="chapter" data-level="3.3.5" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e5-modelo-nbd"><i class="fa fa-check"></i><b>3.3.5</b> E5: Modelo NBD</a></li>
<li class="chapter" data-level="3.3.6" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e6-modelos-de-conteo"><i class="fa fa-check"></i><b>3.3.6</b> E6: Modelos de Conteo</a></li>
<li class="chapter" data-level="3.3.7" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e7-tiempo-discreto-en-modelos-de-duración"><i class="fa fa-check"></i><b>3.3.7</b> E7: Tiempo discreto en Modelos de Duración</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problemas-aplicados-1"><i class="fa fa-check"></i><b>3.4</b> Problemas Aplicados</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-1-control-2-2025-2"><i class="fa fa-check"></i><b>3.4.1</b> Problema 1 (Control 2 2025-2)</a></li>
<li class="chapter" data-level="3.4.2" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-2-1"><i class="fa fa-check"></i><b>3.4.2</b> Problema 2</a></li>
<li class="chapter" data-level="3.4.3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-3-1"><i class="fa fa-check"></i><b>3.4.3</b> Problema 3</a></li>
<li class="chapter" data-level="3.4.4" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-4"><i class="fa fa-check"></i><b>3.4.4</b> Problema 4</a></li>
<li class="chapter" data-level="3.4.5" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-5"><i class="fa fa-check"></i><b>3.4.5</b> Problema 5</a></li>
<li class="chapter" data-level="3.4.6" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-6"><i class="fa fa-check"></i><b>3.4.6</b> Problema 6</a></li>
<li class="chapter" data-level="3.4.7" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-7"><i class="fa fa-check"></i><b>3.4.7</b> Problema 7</a></li>
<li class="chapter" data-level="3.4.8" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-8"><i class="fa fa-check"></i><b>3.4.8</b> Problema 8</a></li>
<li class="chapter" data-level="3.4.9" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-9"><i class="fa fa-check"></i><b>3.4.9</b> Problema 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html"><i class="fa fa-check"></i><b>4</b> Modelos Estructurales</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#introducción-2"><i class="fa fa-check"></i><b>4.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelo-logit"><i class="fa fa-check"></i><b>4.1.1</b> Modelo Logit</a></li>
<li class="chapter" data-level="4.1.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelo-probit"><i class="fa fa-check"></i><b>4.1.2</b> Modelo Probit</a></li>
<li class="chapter" data-level="4.1.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelo-nested-logit"><i class="fa fa-check"></i><b>4.1.3</b> Modelo Nested Logit</a></li>
<li class="chapter" data-level="4.1.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelo-mixed-logit"><i class="fa fa-check"></i><b>4.1.4</b> Modelo Mixed Logit</a></li>
<li class="chapter" data-level="4.1.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#logit-con-clases-latentes"><i class="fa fa-check"></i><b>4.1.5</b> Logit con Clases Latentes</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#metodología-2"><i class="fa fa-check"></i><b>4.2</b> Metodología</a></li>
<li class="chapter" data-level="4.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#problemas-teóricos-2"><i class="fa fa-check"></i><b>4.3</b> Problemas Teóricos</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-1"><i class="fa fa-check"></i><b>4.3.1</b> Pregunta 1</a></li>
<li class="chapter" data-level="4.3.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-2"><i class="fa fa-check"></i><b>4.3.2</b> Pregunta 2</a></li>
<li class="chapter" data-level="4.3.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-3"><i class="fa fa-check"></i><b>4.3.3</b> Pregunta 3</a></li>
<li class="chapter" data-level="4.3.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-4"><i class="fa fa-check"></i><b>4.3.4</b> Pregunta 4</a></li>
<li class="chapter" data-level="4.3.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-5"><i class="fa fa-check"></i><b>4.3.5</b> Pregunta 5</a></li>
<li class="chapter" data-level="4.3.6" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-6"><i class="fa fa-check"></i><b>4.3.6</b> Pregunta 6</a></li>
<li class="chapter" data-level="4.3.7" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#soluciones"><i class="fa fa-check"></i><b>4.3.7</b> Soluciones</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#problemas-aplicados-2"><i class="fa fa-check"></i><b>4.4</b> Problemas Aplicados</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-1-1"><i class="fa fa-check"></i><b>4.4.1</b> Pregunta 1</a></li>
<li class="chapter" data-level="4.4.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-2-1"><i class="fa fa-check"></i><b>4.4.2</b> Pregunta 2</a></li>
<li class="chapter" data-level="4.4.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-3-1"><i class="fa fa-check"></i><b>4.4.3</b> Pregunta 3</a></li>
<li class="chapter" data-level="4.4.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-4-1"><i class="fa fa-check"></i><b>4.4.4</b> Pregunta 4</a></li>
<li class="chapter" data-level="4.4.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-5-1"><i class="fa fa-check"></i><b>4.4.5</b> Pregunta 5</a></li>
<li class="chapter" data-level="4.4.6" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-6-1"><i class="fa fa-check"></i><b>4.4.6</b> Pregunta 6</a></li>
<li class="chapter" data-level="4.4.7" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-7"><i class="fa fa-check"></i><b>4.4.7</b> Pregunta 7</a></li>
<li class="chapter" data-level="4.4.8" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-8"><i class="fa fa-check"></i><b>4.4.8</b> Pregunta 8</a></li>
<li class="chapter" data-level="4.4.9" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-9"><i class="fa fa-check"></i><b>4.4.9</b> Pregunta 9</a></li>
<li class="chapter" data-level="4.4.10" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#pregunta-10"><i class="fa fa-check"></i><b>4.4.10</b> Pregunta 10</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Apunte Problemas Resueltos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-estructurales" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Modelos Estructurales<a href="modelos-estructurales.html#modelos-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducción-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introducción<a href="modelos-estructurales.html#introducción-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los modelos de elección discreta buscan modelar <strong>comportamiento</strong> (toma de decisiones), describiendo la probabilidad de que un agente <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span>, es decir, <span class="math inline">\(P_{ni}\)</span>. Se asume que el individuo decide entre las alternativas tal que éste maximiza sus utilidades <span class="math inline">\(u_{ni}\)</span>.</p>
<p>En general, los modelos de decisión discreta se definen como <span class="math inline">\(u_{ni} = v_{ni} + \varepsilon_{ni}\)</span>, con <span class="math inline">\(v_{ni}\)</span> la componente determinista y <span class="math inline">\(\varepsilon_{ni}\)</span> la componente estocástica.</p>
<p>A continuación se presentan los modelos estructurales abordados en el curso:</p>
<div id="modelo-logit" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Modelo Logit<a href="modelos-estructurales.html#modelo-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo logit es un modelo de elección discreta ampliamente utilizado para analizar decisiones en las que un individuo selecciona una alternativa entre un conjunto finito de opciones. Este modelo asume que los individuos maximizan su utilidad <span class="math inline">\(u_{ni}\)</span>, la cual se divide en una componente determinista (observable) <span class="math inline">\(v_{ni}\)</span> y una estocástica (no observable) <span class="math inline">\(\varepsilon_{ni}\)</span>, con la componente estocástica siguiendo una distribución de valor extremo Gumbel tipo 1.</p>
<p>La probabilidad de que un agente <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> viene dada por:</p>
<p><span class="math display">\[P_{ni} = \frac{e^{v_{ni}}}{\sum_j e^{v_{nj}}}\]</span></p>
<p>Donde los parámetros del modelo pueden ser estimados usando el método de máxima verosimilitud con <span class="math inline">\(v_{ni} = \beta&#39; x_{ni}\)</span>:</p>
<p><span class="math display">\[LL(\beta) = \sum_n \sum_i y_{ni} \ln(P_{ni})\]</span></p>
<p>Con <span class="math inline">\(x_{ni}\)</span> un conjunto de covariables y <span class="math inline">\(y_{ni} = 1\)</span> si <span class="math inline">\(n\)</span> elige la alternativa <span class="math inline">\(i\)</span>, 0 en caso contrario.</p>
<div id="persistencia-de-elección-lealtad-y-precios-de-referencia" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Persistencia de Elección (Lealtad) y Precios de Referencia<a href="modelos-estructurales.html#persistencia-de-elección-lealtad-y-precios-de-referencia" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En modelos de panel con observaciones repetidas, es posible incorporar efectos dinámicos como la <strong>lealtad</strong> y los <strong>precios de referencia</strong>:</p>
<p><strong>Lealtad:</strong> Se introduce una variable de lealtad latente <span class="math inline">\(z_{nit}\)</span> que captura la propensión del individuo a repetir elecciones previas:</p>
<p><span class="math display">\[z_{nit} = \lambda z_{nit-1} + (1-\lambda) y_{nit-1}\]</span></p>
<p>donde <span class="math inline">\(0 \leq \lambda \leq 1\)</span> es un parámetro de decaimiento.</p>
<p><strong>Precios de Referencia:</strong> Los consumidores comparan precios actuales con un precio de referencia interno formado a partir de precios observados en el pasado:</p>
<p><span class="math display">\[RP_{nit} = \lambda RP_{nit-1} + (1-\lambda) P_{nit-1}\]</span></p>
<p>La utilidad se especifica incorporando la desviación respecto al precio de referencia:</p>
<p><span class="math display">\[u_{nit} = \alpha_i + \beta_1 P_{nit} - \beta_2(P_{nit} - RP_{nit}) + \delta x_{nit} + \varepsilon_{nit}\]</span></p>
</div>
</div>
<div id="modelo-probit" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Modelo Probit<a href="modelos-estructurales.html#modelo-probit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo probit es un modelo de elección discreta utilizado para analizar decisiones en las que un individuo selecciona una alternativa entre un conjunto finito de opciones. Este modelo asume que los individuos maximizan su utilidad <span class="math inline">\(u_{ni}\)</span>, la cual se divide en una componente determinista (observable) <span class="math inline">\(v_{ni}\)</span> y una estocástica (no observable) <span class="math inline">\(\varepsilon_{ni}\)</span>, con la componente estocástica siguiendo una <strong>distribución normal estándar</strong>.</p>
<p>Asumiendo que el término del error <span class="math inline">\(\varepsilon_{ni}\)</span> se distribuye normal multivariado centrado en 0:</p>
<p><span class="math display">\[\phi(\varepsilon_n) = \frac{1}{(2\pi)^{I/2} |\Sigma|^{1/2}} e^{-\frac{1}{2} \varepsilon&#39;_n \Sigma^{-1} \varepsilon_n}\]</span></p>
<p>La matriz de covarianza <span class="math inline">\(\Sigma\)</span> tiene una dimensión <span class="math inline">\(I \times I\)</span>, con <span class="math inline">\(I\)</span> la cantidad de alternativas de elección. Como la matriz es simétrica, esta tiene <span class="math inline">\(I(I+1)/2\)</span> parámetros.</p>
<p>La probabilidad de elección se aproxima mediante simulación:</p>
<p><span class="math display">\[\hat{P}_{ni} \approx \frac{1}{R} \sum_{r=1}^R \mathbb{1}[\varepsilon^r_{nj} - \varepsilon^r_{ni} &lt; v_{ni} - v_{nj}, \forall j \neq i]\]</span></p>
<p>Los parámetros del modelo se estiman usando el <strong>método simulado de máxima verosimilitud (SMLE)</strong>:</p>
<p><span class="math display">\[\hat{\theta} = \arg\max \sum_n \sum_i y_{ni} \ln(\hat{P}_{ni})\]</span></p>
</div>
<div id="modelo-nested-logit" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Modelo Nested Logit<a href="modelos-estructurales.html#modelo-nested-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo Nested Logit es una extensión del modelo Logit que organiza las alternativas en ‘nidos’ o grupos que comparten características comunes, permitiendo modelar correlaciones entre opciones dentro de un mismo nido. Este modelo relaja la suposición de independencia de alternativas irrelevantes (IIA) al introducir un parámetro de correlación para cada nido.</p>
<p>La probabilidad de que un agente <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(j\)</span> se descompone como el producto de la probabilidad de elegir la alternativa <span class="math inline">\(j\)</span> dado que eligió el nodo <span class="math inline">\(B_k\)</span> que contiene la alternativa <span class="math inline">\(j\)</span>, multiplicado por la probabilidad de elegir el nodo <span class="math inline">\(B_k\)</span>:</p>
<p><span class="math display">\[P_{nj} = P_{nj|B_k} \cdot P_{nB_k}\]</span></p>
<p>Donde:</p>
<p><span class="math display">\[P_{nj|B_k} = \frac{e^{v_{nj}/\lambda_k}}{\sum_{i \in B_k} e^{v_{ni}/\lambda_k}}\]</span></p>
<p><span class="math display">\[P_{nB_k} = \frac{e^{w_{nk} + \lambda_k IV_{nk}}}{\sum_h e^{w_{nh} + \lambda_h IV_{nh}}}\]</span></p>
<p>Con <span class="math inline">\(IV_{nk} = \ln\left(\sum_{j \in B_k} \exp\left(\frac{v_{nj}}{\lambda_k}\right)\right)\)</span> el valor inclusivo del nido.</p>
<p>El conjunto de parámetros <span class="math inline">\(\{\lambda_k\}_{k=1}^K\)</span> mide el grado relativo de independencia en la parte no observable de la utilidad entre las alternativas del nido <span class="math inline">\(k\)</span>. Probar que <span class="math inline">\(\lambda_k = 1\)</span> para todos los nidos podría llevarnos de vuelta al modelo logit simple.</p>
</div>
<div id="modelo-mixed-logit" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Modelo Mixed Logit<a href="modelos-estructurales.html#modelo-mixed-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo Mixed Logit es una extensión del modelo Logit que permite modelar la heterogeneidad de preferencias entre los individuos. A diferencia del modelo Logit tradicional, los parámetros de la utilidad <span class="math inline">\(u_{ni}\)</span> no son constantes, sino que varían aleatoriamente en la población.</p>
<p>La utilidad de un individuo <span class="math inline">\(n\)</span> para una alternativa <span class="math inline">\(i\)</span> se define como:</p>
<p><span class="math display">\[u_{ni} = \beta&#39;_n x_{ni} + \varepsilon_{ni}\]</span></p>
<p>donde <span class="math inline">\(\beta_n\)</span> es un vector de coeficientes específicos de cada individuo, que sigue una distribución probabilística <span class="math inline">\(f(\beta|\theta)\)</span> en la población.</p>
<p>La probabilidad de elección de la alternativa <span class="math inline">\(i\)</span> por el individuo <span class="math inline">\(n\)</span> es:</p>
<p><span class="math display">\[P_{ni} = \int \frac{e^{\beta&#39; x_{ni}}}{\sum_j e^{\beta&#39; x_{nj}}} f(\beta|\theta) d\beta\]</span></p>
<p>donde <span class="math inline">\(f(\beta|\theta)\)</span> describe la distribución de los parámetros en la población, comúnmente asumida como normal multivariada: <span class="math inline">\(\beta \sim N(b, V_b)\)</span>.</p>
<p><strong>Estimación:</strong> Para estimar los parámetros, se utiliza el <strong>método de máxima verosimilitud simulada (SMLE)</strong>. La probabilidad simulada se calcula como:</p>
<p><span class="math display">\[\hat{P}_{ni} = \frac{1}{R} \sum_{r=1}^R \frac{e^{\beta&#39;_r x_{ni}}}{\sum_j e^{\beta&#39;_r x_{nj}}}\]</span></p>
<p>con <span class="math inline">\(\beta_r\)</span> siendo una muestra de <span class="math inline">\(f(\beta|\theta)\)</span> y <span class="math inline">\(R\)</span> el número de simulaciones.</p>
</div>
<div id="logit-con-clases-latentes" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Logit con Clases Latentes<a href="modelos-estructurales.html#logit-con-clases-latentes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo de Clases Latentes asume que la población está compuesta por un número finito de segmentos o clases, cada uno con parámetros específicos de preferencia. A diferencia del Mixed Logit, aquí se considera que las preferencias dentro de cada clase son homogéneas, pero varían entre clases.</p>
<p>La utilidad de un individuo <span class="math inline">\(n\)</span> para una alternativa <span class="math inline">\(i\)</span> en la clase <span class="math inline">\(m\)</span> se define como:</p>
<p><span class="math display">\[u_{ni|m} = \beta&#39;_m x_{ni} + \varepsilon_{ni}\]</span></p>
<p>La probabilidad de que el individuo <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> se define como:</p>
<p><span class="math display">\[P_{ni} = \sum_m s_m \frac{e^{\beta&#39;_m x_{ni}}}{\sum_j e^{\beta&#39;_m x_{nj}}}\]</span></p>
<p>donde <span class="math inline">\(s_m\)</span> es la proporción de la población en la clase <span class="math inline">\(m\)</span> y <span class="math inline">\(\beta_m\)</span> son los parámetros específicos de la clase <span class="math inline">\(m\)</span>.</p>
<p><strong>Estimación:</strong> Para estimar los parámetros, se maximiza la función de verosimilitud:</p>
<p><span class="math display">\[LL(\{\beta_m, s_m\}_{m=1}^M) = \sum_n \sum_i y_{ni} \ln\left(\sum_m s_m \frac{e^{\beta&#39;_m x_{ni}}}{\sum_j e^{\beta&#39;_m x_{nj}}}\right)\]</span></p>
<p>con restricciones sobre <span class="math inline">\(s_m\)</span> para asegurar que representen proporciones válidas: <span class="math inline">\(0 \leq s_m \leq 1\)</span> y <span class="math inline">\(\sum_m s_m = 1\)</span>.</p>
</div>
</div>
<div id="metodología-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Metodología<a href="modelos-estructurales.html#metodología-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La estimación de los modelos estructurales comparte una metodología:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Especificación de la utilidad:</strong> Definir la función de utilidad <span class="math inline">\(u_{ni}\)</span> con sus componentes determinísticas <span class="math inline">\(v_{ni}\)</span> y estocásticas <span class="math inline">\(\varepsilon_{ni}\)</span>.</p></li>
<li><p><strong>Derivación de probabilidades:</strong> Calcular las probabilidades de elección <span class="math inline">\(P_{ni}\)</span> según el modelo especificado (Logit, Probit, Nested Logit, Mixed Logit, o Clases Latentes).</p></li>
<li><p><strong>Construcción de la verosimilitud:</strong> Escribir la función de (log-)verosimilitud basada en las observaciones <span class="math inline">\(y_{ni}\)</span>.</p></li>
<li><p><strong>Estimación:</strong> Para modelos con solución cerrada (Logit, Nested Logit, Clases Latentes), se utiliza <strong>máxima verosimilitud directa</strong>. Para modelos sin solución cerrada (Probit, Mixed Logit), se emplea <strong>máxima verosimilitud simulada (SMLE)</strong>.</p></li>
<li><p><strong>Evaluación:</strong> Calcular métricas de ajuste como <span class="math inline">\(\rho\)</span> de McFadden, AIC, BIC y validar la significancia estadística de los parámetros.</p></li>
<li><p><strong>Interpretación:</strong> Analizar los parámetros estimados, calcular elasticidades y evaluar implicaciones para la toma de decisiones.</p></li>
</ol>
</div>
<div id="problemas-teóricos-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Problemas Teóricos<a href="modelos-estructurales.html#problemas-teóricos-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pregunta-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Pregunta 1<a href="modelos-estructurales.html#pregunta-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que dispone de una muestra de tamaño <span class="math inline">\(R\)</span> de los parámetros que definen la utilidad de elección en un modelo logit. Describa cómo estimar la probabilidad que un consumidor <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span>.</p>
</div>
<div id="pregunta-2" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Pregunta 2<a href="modelos-estructurales.html#pregunta-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>¿Cómo se calcula el Akaike Information Criterion (AIC) para un modelo cuya verosimilitud <span class="math inline">\(f(X|\theta)\)</span> es maximizada en un único valor de <span class="math inline">\(\hat{\theta} = (\hat{\theta}_1, \hat{\theta}_2)\)</span>?</p>
</div>
<div id="pregunta-3" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Pregunta 3<a href="modelos-estructurales.html#pregunta-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que la componente determinística de la utilidad de los consumidores que pertenecen al segmento <span class="math inline">\(i\)</span> puede calcularse como <span class="math inline">\(v(\theta_i)\)</span>. ¿Cuál es la probabilidad de elección en un modelo logit binario si asumimos que en la población solo existen dos clases caracterizadas por los set de parámetros <span class="math inline">\(\theta_1\)</span> y <span class="math inline">\(\theta_2\)</span> y además asumimos que la utilidad de no elegir está normalizada a 0?</p>
</div>
<div id="pregunta-4" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Pregunta 4<a href="modelos-estructurales.html#pregunta-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Describa cómo incluir que los consumidores eligen usando precios de referencia en un modelo logit.</p>
</div>
<div id="pregunta-5" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Pregunta 5<a href="modelos-estructurales.html#pregunta-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Explique una situación en la que un modelo mixed logit (o de heterogeneidad continua) podría preferirse en comparación a un modelo logit con clases latentes.</p>
</div>
<div id="pregunta-6" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Pregunta 6<a href="modelos-estructurales.html#pregunta-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponga que estamos interesados en estudiar el efecto del ingreso de los hogares en la elasticidad precio en las compras de una categoría. Explicar por qué para estudiar este efecto es informativo poner atención al coeficiente <span class="math inline">\(\delta\)</span> que acompaña a <span class="math inline">\(Precio \times Ingreso\)</span> en la definición en la función de utilidad.</p>
</div>
<div id="soluciones" class="section level3 hasAnchor" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> Soluciones<a href="modelos-estructurales.html#soluciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Dicha probabilidad puede estimarse como:</p>
<p><span class="math display">\[\hat{P}_{ni} = \frac{1}{R} \sum_{r=1}^R \frac{\exp(v_i(\theta^{(r)}))}{\sum_k \exp(v_k(\theta^{(r)}))}\]</span></p>
<p>donde <span class="math inline">\(v_i(\theta)\)</span> es la componente determinística de la utilidad que el tomador de decisión deriva al elegir la alternativa <span class="math inline">\(i\)</span>.</p></li>
<li><p>Aplicamos la definición directamente:</p>
<p><span class="math display">\[AIC = -2 \ln(f(X|\hat{\theta})) + 2k = -2 \ln(f(X|\hat{\theta})) + 4\]</span></p></li>
<li><p>Sea <span class="math inline">\(\pi\)</span> la probabilidad de que un cliente pertenezca al segmento 1. Entonces, la probabilidad de elección viene dada por:</p>
<p><span class="math display">\[P_{ni} = \pi \frac{\exp(v(\theta_1))}{1 + \exp(v(\theta_1))} + (1-\pi) \frac{\exp(v(\theta_2))}{1 + \exp(v(\theta_2))}\]</span></p></li>
<li><p>Definimos la componente determinística de la utilidad como:</p>
<p><span class="math display">\[v_{nit} = \beta_0 + \beta_1(P_{nit} - RP_{nit})\]</span></p>
<p>donde <span class="math inline">\(P_{nit}\)</span> es el precio de la alternativa <span class="math inline">\(i\)</span> al que se enfrenta el cliente <span class="math inline">\(n\)</span> en la ocasión de compra <span class="math inline">\(t\)</span> y <span class="math inline">\(RP_{nit}\)</span> es el precio de referencia que típicamente definimos como:</p>
<p><span class="math display">\[RP_{nit} = \lambda RP_{nit-1} + (1-\lambda) P_{nit-1}\]</span></p>
<p>Con esta especificación de la utilidad, la probabilidad de elección se calcula usando la fórmula estándar del modelo logit.</p></li>
<li><p>Cuando una distribución discreta no describe bien la heterogeneidad de los parámetros en la población. Por ejemplo, si esperamos que la distribución de un parámetro tenga colas pesadas (i.e. una proporción significativa de la población se aleja de la media), entonces se requerirá demasiadas clases para aproximar la heterogeneidad en la población.</p></li>
<li><p>El efecto del ingreso en la elasticidad precio depende directamente del parámetro <span class="math inline">\(\gamma_1\)</span> de la siguiente ecuación:</p>
<p><span class="math display">\[\gamma_{precio} = \gamma_0 + \gamma_1 Ingreso\]</span></p>
<p>Al reemplazar dicha ecuación en la definición de la función de utilidad obtenemos:</p>
<p><span class="math display">\[u_{nit} = \beta_0 + \gamma_0 Precio + \gamma_1 Ingreso \cdot Precio\]</span></p></li>
</ol>
</div>
</div>
<div id="problemas-aplicados-2" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Problemas Aplicados<a href="modelos-estructurales.html#problemas-aplicados-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pregunta-1-1" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Pregunta 1<a href="modelos-estructurales.html#pregunta-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un administrador de la categoría aceites de una sala del centro de Santiago de una importante retailer nacional, se dispone a analizar datos de panel que reportan <span class="math inline">\(y_{ijt}\)</span> que toma el valor 1 si el hogar <span class="math inline">\(i\)</span> compra la marca-tamaño <span class="math inline">\(j\)</span> en la semana <span class="math inline">\(t\)</span> y 0 en caso contrario (<span class="math inline">\(i = 1, \ldots, N\)</span>, <span class="math inline">\(j = 1, \ldots, J\)</span>, <span class="math inline">\(t = 1, \ldots, T\)</span>). Junto con las elecciones semanales de cada hogar, el panel provee <span class="math inline">\(PRICE_{jt}\)</span> correspondiente al precio por centímetro cúbico de la alternativa <span class="math inline">\(j\)</span> en la semana <span class="math inline">\(t\)</span> y <span class="math inline">\(COUPON_{ijt}\)</span> que toma el valor 1 si el cliente <span class="math inline">\(i\)</span> dispone de un cupón de descuento para la alternativa <span class="math inline">\(j\)</span> en la semana <span class="math inline">\(t\)</span> (aunque el valor de descuento de los cupones varía entre alternativas y de semana a semana, los valores típicamente rondan el 10% del precio de lista).</p>
<p>Después de una reunión de trabajo con administradores de categoría en otras salas se ha acordado que un buen punto de partida es usar un modelo estructural en que la componente determinística de la utilidad de compra viene dada por:</p>
<p><span class="math display">\[v_{ijt} = \alpha_{ij} + \beta_{i1} PRICE_{jt} + \beta_{i2} COUPON_{ijt}\]</span></p>
<p>Sin embargo, hasta el momento no hay demasiada claridad respecto a cómo introducir heterogeneidad en el modelo, por lo que se barajan varias alternativas.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Escriba la log-verosimilitud de un modelo logit con dos clases latentes. La expresión debe quedar expresada directamente en función de los parámetros que ingresarán como variables de decisión en la maximización irrestricta de la log-verosimilitud.</p></li>
<li><p>Escriba una (aproximación a) la log-verosimilitud de un modelo logit mezclado. Al igual que en el caso anterior, la expresión debe quedar expresada directamente en función de los parámetros que ingresarán como variables de decisión en la maximización irrestricta de la log-verosimilitud. Para ello puede asumir que dispone de una función que le permite samplear desde cualquier distribución de probabilidad generando una muestra de tamaño <span class="math inline">\(R\)</span> del vector de parámetros <span class="math inline">\(\alpha_{ij}\)</span>, <span class="math inline">\(\beta_1\)</span> y <span class="math inline">\(\beta_2\)</span>.</p></li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>La función de log-verosimilitud viene dada por:</p>
<p><span class="math display">\[LL = \sum_i \sum_j \sum_t y_{ijt} \ln\left[\frac{\exp(\lambda)}{1 + \exp(\lambda)} \frac{\exp(v_{ijt}^1)}{\sum_k \exp(v_{ikt}^1)} + \frac{1}{1 + \exp(\lambda)} \frac{\exp(v_{ijt}^2)}{\sum_k \exp(v_{ikt}^2)}\right]\]</span></p>
<p>donde <span class="math inline">\(v_{ijt}^1\)</span> y <span class="math inline">\(v_{ijt}^2\)</span> son las componentes sistemáticas de la utilidad de los clientes pertenecientes a las clases 1 y 2 respectivamente y vienen dadas por:</p>
<p><span class="math display">\[v_{ijt}^1 = \alpha_{ij}^1 + \beta_{i1}^1 PRICE_{jt} + \beta_{i2}^1 COUPON_{ijt}\]</span>
<span class="math display">\[v_{ijt}^2 = \alpha_{ij}^2 + \beta_{i1}^2 PRICE_{jt} + \beta_{i2}^2 COUPON_{ijt}\]</span></p>
<p>Los parámetros <span class="math inline">\(\alpha_{ij}^1\)</span>, <span class="math inline">\(\beta_{i1}^1\)</span> y <span class="math inline">\(\beta_{i2}^1\)</span> corresponden a los parámetros caracterizando a la clase 1 y <span class="math inline">\(\alpha_{ij}^2\)</span>, <span class="math inline">\(\beta_{i1}^2\)</span> y <span class="math inline">\(\beta_{i2}^2\)</span> los que caracterizan a la clase 2. El parámetro <span class="math inline">\(\lambda\)</span> determina el tamaño relativo de cada clase y la transformación logística sobre <span class="math inline">\(\lambda\)</span> garantiza que las proporciones estén en el rango [0,1] y sumen 1.</p></li>
<li><p>La (aproximación de la) función de log-verosimilitud viene dada por:</p>
<p><span class="math display">\[LL = \sum_i \sum_j \sum_t y_{ijt} \ln\left(\frac{1}{R} \sum_r \frac{\exp(v_{ijt}^r)}{\sum_k \exp(v_{ikt}^r)}\right)\]</span></p>
<p>donde <span class="math inline">\(v_{ijt}^r\)</span> son las componentes sistemáticas de la utilidad de los clientes si los parámetros toman los valores <span class="math inline">\(\alpha_{ij}^r\)</span>, <span class="math inline">\(\beta_1^r\)</span> y <span class="math inline">\(\beta_2^r\)</span>.</p></li>
</ol>
</div>
<div id="pregunta-2-1" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Pregunta 2<a href="modelos-estructurales.html#pregunta-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Suponga que un analista propone usar un modelo logit para estudiar el comportamiento de compra de 5 marcas de margarina las que pueden ofrecerse en formato pan o pote.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Escriba la función de utilidad si los clientes tienen preferencias dependientes exclusivamente de precio y formato.</p></li>
<li><p>Escriba la función de utilidad si los clientes tienen preferencias dependientes de precio, marca y formato.</p></li>
<li><p>Escriba la función de utilidad si se quiere evaluar cuánto influye la interacción entre el nivel de ingreso <span class="math inline">\(ING_n\)</span> y el precio en la utilidad del cliente <span class="math inline">\(n\)</span>.</p></li>
</ol></li>
<li><p>Considere un agente que se enfrenta a la elección entre dos alternativas <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> de modo que las componentes determinísticas de su utilidad vienen dadas por <span class="math inline">\(v_A = v_B = 1\)</span>. Usted como analista ha decidido modelar la elección usando un modelo probit con una matriz de varianza-covarianza completamente general, es decir sobre la cual no se ha impuesto ninguna restricción más allá de la simetría. Calcule explícitamente:</p>
<p><span class="math display">\[P_A = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \mathbb{1}(v_A + \varepsilon_A &gt; v_B + \varepsilon_B) \phi(\varepsilon_A, \varepsilon_B) d\varepsilon_A d\varepsilon_B\]</span></p>
<p>Justifique su respuesta e interprete el resultado.</p></li>
<li><p>Considere un cliente comprando por tres periodos en una categoría con dos marcas <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> como lo indica la siguiente tabla:</p>
<table>
<thead>
<tr class="header">
<th>Periodo</th>
<th>Marca A</th>
<th>Marca B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Calcule una medida de lealtad para cada marca y periodo usando un modelo de suavización exponencial con parámetro de factor de alisamiento <span class="math inline">\(\lambda\)</span>. Para ello inicialice las medidas de lealtad en <span class="math inline">\(\frac{1}{2}\)</span> para el periodo 0 en ambas marcas.</p></li>
<li><p>Para analizar el comportamiento de compra de los clientes en un mercado de alimentos enlatados, una importante empresa consultora ha implementado una rutina de maximización de verosimilitud para estimar los parámetros de un modelo logit que se aplica sobre una base de 324 clientes que hacen 3615 compras en la categoría. En la rutina propuesta, los parámetros máximo verosímiles se obtienen usando el comando <code>mymle = optim(par=0.01*rep(1,3), fn=loglikel, hessian=TRUE, method="BFGS")</code>.</p>
<p>Al terminar la rutina, un analista de la empresa consultora quiere explorar los resultados de la estimación para lo que ejecuta una serie de comandos sencillos en la consola obteniendo los siguientes resultados:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="modelos-estructurales.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mymle<span class="sc">$</span>par</span>
<span id="cb1-2"><a href="modelos-estructurales.html#cb1-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.124</span> <span class="fl">0.486</span> <span class="sc">-</span><span class="fl">2.351</span></span>
<span id="cb1-3"><a href="modelos-estructurales.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mymle<span class="sc">$</span>value</span>
<span id="cb1-4"><a href="modelos-estructurales.html#cb1-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1344.35</span></span></code></pre></div>
<p>¿Cuál es el BIC del modelo estimado por la empresa consultora?</p></li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li><p>La utilidad que experimenta un cliente <span class="math inline">\(n\)</span> respecto a la marca <span class="math inline">\(i\)</span> en la ocasión de compra <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display">\[u_{nit} = \beta_{PRECIO} PRECIO_{it} + \beta_{PAN} PAN_i + \varepsilon_{nit}\]</span></p>
<p>donde <span class="math inline">\(PAN_i\)</span> toma el valor 1 si la alternativa <span class="math inline">\(i\)</span> corresponde al formato pan, <span class="math inline">\(PRECIO_{it}\)</span> es el precio de la alternativa <span class="math inline">\(i\)</span> en la oportunidad de compra <span class="math inline">\(t\)</span> y <span class="math inline">\(\varepsilon_{nit}\)</span> independientes e idénticamente distribuidas valor extremo tipo I. Notar que por motivos de identificación, este modelo hemos fijado en cero la utilidad intrínseca de la alternativa pote.</p></li>
<li><p>Hay al menos dos formas de modelar este problema. La primera en que los interceptos se definen al nivel marca-formato y otra en que los interceptos se definen en términos de marca y formato:</p>
<ol style="list-style-type: lower-roman">
<li><p>La utilidad que experimenta un cliente <span class="math inline">\(n\)</span> respecto a la marca <span class="math inline">\(i\)</span> en la ocasión de compra <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display">\[u_{nit} = \beta_{PRECIO} PRECIO_{it} + \beta_{PAN} PAN_i + \sum_{j=1}^{4} \alpha_j M_{ij} + \varepsilon_{nit}\]</span></p>
<p>donde <span class="math inline">\(PAN_i\)</span> toma el valor 1 si la alternativa <span class="math inline">\(i\)</span> corresponde al formato pan, <span class="math inline">\(M_{ij}\)</span> toma el valor 1 si la alternativa <span class="math inline">\(i\)</span> es de la marca <span class="math inline">\(j\)</span>, <span class="math inline">\(PRECIO_{it}\)</span> es el precio de la alternativa <span class="math inline">\(i\)</span> en la oportunidad de compra <span class="math inline">\(t\)</span> y <span class="math inline">\(\varepsilon_{nit}\)</span> independientes e idénticamente distribuidas valor extremo tipo I. Notar que por motivos de identificación, este modelo hemos fijado en cero la utilidad intrínseca de la alternativa pote y de la última marca (Es por esto que la sumatoria llega hasta 4 y no hasta 5).</p></li>
<li><p>La utilidad que experimenta un cliente <span class="math inline">\(n\)</span> respecto a la marca <span class="math inline">\(i\)</span> en la ocasión de compra <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display">\[u_{nit} = \beta_{PRECIO} PRECIO_{it} + \sum_{j=1}^{N-1} \alpha_j MF_{ij} + \varepsilon_{nit}\]</span></p>
<p>donde <span class="math inline">\(MF_{ij}\)</span> toma el valor 1 si la alternativa <span class="math inline">\(i\)</span> corresponde a la marca-formato <span class="math inline">\(j\)</span>, <span class="math inline">\(PRECIO_{it}\)</span> es el precio de la alternativa <span class="math inline">\(i\)</span> en la oportunidad de compra <span class="math inline">\(t\)</span> y <span class="math inline">\(\varepsilon_{nit}\)</span> independientes e idénticamente distribuidas valor extremo tipo I. Si todas las marcas están disponibles en todos los formatos, entonces tenemos <span class="math inline">\(N = 2 \times 5\)</span> marca-formatos, de los cuales solo podemos identificar <span class="math inline">\(N-1\)</span> interceptos.</p></li>
</ol></li>
<li><p>Asumiendo que la utilidad que experimenta un cliente <span class="math inline">\(n\)</span> respecto a la marca <span class="math inline">\(i\)</span> en la ocasión de compra <span class="math inline">\(t\)</span> depende exclusivamente del precio (si dependiera de otros factores simplemente tendríamos que agregar los términos correspondientes), la función de utilidad puede expresarse como:</p>
<p><span class="math display">\[u_{nit} = \beta_{0p} + \beta_{1p} ING_n + \beta_{2p} PRECIO_{it} + \beta_{3p} ING_n + PRECIO_{it} + \varepsilon_{nit}\]</span></p>
<p>donde <span class="math inline">\(PRECIO_{it}\)</span> es el precio de la alternativa <span class="math inline">\(i\)</span> en la oportunidad de compra <span class="math inline">\(t\)</span> y <span class="math inline">\(\varepsilon_{nit}\)</span> independientes e idénticamente distribuidas valor extremo tipo I.</p></li>
</ol></li>
<li><p><span class="math inline">\(P_A\)</span> no es más que la probabilidad de elegir la alternativa <span class="math inline">\(A\)</span>. La clave para calcular su valor viene de observar que <span class="math inline">\(v_A = v_B\)</span>. Si las dos alternativas tienen el mismo valor de la componente sistemática, entonces el cálculo de <span class="math inline">\(P_A\)</span> corresponde a la probabilidad de que una componente sea mayor que la otra en una distribución normal bivariada centrada en 0, la que evidentemente toma el valor <span class="math inline">\(\frac{1}{2}\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:probit-bivariado"></span>
<img src="images/probit_bivariado.png" alt="Plot de variables transformadas logarítmicamente." width="50%" />
<p class="caption">
Figure 4.1: Plot de variables transformadas logarítmicamente.
</p>
</div>
<p>La interpretación es sencilla. Estamos describiendo una situación de un tomador de decisión que, a excepción de una perturbación normal centrada en cero. Dada la simetría de la normal las perturbaciones son igualmente probables de inclinar la balanza en favor de la alternativa <span class="math inline">\(A\)</span> como de la alternativa <span class="math inline">\(B\)</span> y por tanto la probabilidad final que el tomador de decisión elija la alternativa <span class="math inline">\(A\)</span> es simplemente <span class="math inline">\(\frac{1}{2}\)</span>.</p></li>
<li><p>Podemos calcular las medidas de lealtad con que el cliente se enfrenta a las siguientes 3 ocasiones de compra:</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Periodo</th>
<th>Marca A</th>
<th>Marca B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td><span class="math inline">\((1-\lambda)/2\)</span></td>
<td><span class="math inline">\(\lambda + (1-\lambda)/2\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td><span class="math inline">\((1-\lambda)^2/2\)</span></td>
<td><span class="math inline">\(\lambda(1-\lambda) + (1-\lambda)^2/2\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td><span class="math inline">\(\lambda + (1-\lambda)^3/2\)</span></td>
<td><span class="math inline">\((1-\lambda)\lambda + (1-\lambda)^2 + (1-\lambda)^3/2\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>Por definición:</p>
<p><span class="math display">\[BIC = -2LL(\hat{\theta}) + k \ln(n)\]</span></p>
<p>donde <span class="math inline">\(LL(\hat{\theta})\)</span> es la log verosimilitud evaluada en el estimador máximo verosímil, <span class="math inline">\(k\)</span> el número de parámetros en el modelo y <span class="math inline">\(n\)</span> el número de observaciones sobre la que se calcula la verosimilitud. Entonces:</p>
<p><span class="math display">\[BIC = -2(-1344.35) + 3 \ln(3615) = 2713.279\]</span></p></li>
</ol>
</div>
<div id="pregunta-3-1" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Pregunta 3<a href="modelos-estructurales.html#pregunta-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una compañía de telefonía móvil de reciente ingreso al país ha iniciado una fuerte campaña en algunas redes sociales y busca estudiar el perfil de los clientes que han evaluado favorablemente la campaña. Para eso se ha construido una base de datos de 5243 usuarios de facebook que vieron al menos uno de los elementos considerados en la campaña (video, afiche, álbum de fotos, etc.). Junto con información de los usuarios considerados en la muestra, la base de datos contiene una variable <span class="math inline">\(y_n\)</span> que toma el valor 1 si el usuario <span class="math inline">\(n\)</span> le dio un “me gusta” a alguno de las componentes de la campaña. La siguiente tabla contiene una breve descripción de la información disponible en la base.</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Descripción</th>
<th>Promedio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y_n\)</span></td>
<td>1 si a usuario <span class="math inline">\(n\)</span> le gusta alguna componente de la campaña</td>
<td>0.093</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Hombre_n\)</span></td>
<td>1 si usuario <span class="math inline">\(n\)</span> es hombre</td>
<td>0.421</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Twitter_n\)</span></td>
<td>1 si usuario <span class="math inline">\(n\)</span> es usuario de twitter</td>
<td>0.134</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Edad_n\)</span></td>
<td>Edad usuario <span class="math inline">\(n\)</span></td>
<td>23.18</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Suponga que para perfilar a los clientes se propone un modelo logit en que el usuario <span class="math inline">\(n\)</span> deriva una utilidad <span class="math inline">\(u_n\)</span> por darle un “me gusta” a alguna de las componentes de la campaña y 0 si no. Escriba la log-verosimilitud del problema asumiendo que la componente determinística de la utilidad depende linealmente de <span class="math inline">\(x_n = (Hombre_n, Twitter_n, Edad_n, Edad_n^2)\)</span>.</li>
</ol>
<p>Suponga que analistas dentro de la compañía han codificado la verosimilitud anterior en R en una función <code>loglikel</code> que recibe como primer argumento el intercepto de la función de utilidad y los cuatro siguientes los otros parámetros de la utilidad en el orden antes planteado. Para encontrar los estimadores máximo verosímiles se ha ejecutado el siguiente comando:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="modelos-estructurales.html#cb2-1" aria-hidden="true" tabindex="-1"></a>mymle <span class="ot">=</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fl">0.01</span><span class="sc">*</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">fn=</span>loglikel, <span class="at">hessian=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">&quot;BFGS&quot;</span>)</span></code></pre></div>
<p>Al terminar la rutina, los analistas quieren hacer inferencia sobre los parámetros para lo que ejecutan el siguiente comandos en la consola generando los resultados correspondientes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="modelos-estructurales.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">cbind</span>(mymle<span class="sc">$</span>par, <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(mymle<span class="sc">$</span>hessian))))</span>
<span id="cb3-2"><a href="modelos-estructurales.html#cb3-2" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>]      [,<span class="dv">2</span>]</span>
<span id="cb3-3"><a href="modelos-estructurales.html#cb3-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.9623</span>  <span class="fl">0.2069</span></span>
<span id="cb3-4"><a href="modelos-estructurales.html#cb3-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">3.4340</span>  <span class="fl">0.0518</span></span>
<span id="cb3-5"><a href="modelos-estructurales.html#cb3-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">0.0047</span>  <span class="fl">0.0522</span></span>
<span id="cb3-6"><a href="modelos-estructurales.html#cb3-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.0365</span>  <span class="fl">0.0043</span></span>
<span id="cb3-7"><a href="modelos-estructurales.html#cb3-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.0048</span>  <span class="fl">0.0025</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>¿Cuál es la probabilidad que una mujer de 20 años que no es usuaria de twitter le de un “me gusta” a la campaña?</p></li>
<li><p>¿Cómo varía la probabilidad de elección anterior si la mujer sí es usuaria de twitter? Describa que implicancias podría tener su resultado en la elaboración de próximas campañas.</p></li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>La componente determinística de la utilidad viene dada por:</p>
<p><span class="math display">\[v_n = \beta_0 + \beta_1 Hombre_n + \beta_2 Twitter_n + \beta_3 Edad_n + \beta_4 Edad_n^2\]</span></p>
<p>Luego, la log-verosimilitud puede escribirse como:</p>
<p><span class="math display">\[LL = \sum_n y_n \ln\frac{\exp(v_n)}{1 + \exp(v_n)} + (1-y_n) \ln\frac{1}{1 + \exp(v_n)}\]</span></p></li>
<li><p>Para esta mujer, la componente sistemática de la utilidad viene dada por:</p>
<p><span class="math display">\[v_n = -0.9623 + 3.4340 \times 0 + 0.0047 \times 0 + 0.0365 \times 20 - 0.0048 \times 400 = -2.1523\]</span></p>
<p>Entonces:</p>
<p><span class="math display">\[Pr(y_n = 1) = \frac{\exp(v_n)}{1 + \exp(v_n)} = 0.10412\]</span></p></li>
<li><p>Si fuere usuaria de twitter, basta modificar la componente determinística de la utilidad <span class="math inline">\(v_n \to v_n + 0.047 = -2.1476\)</span> y recalcular la probabilidad:</p>
<p><span class="math display">\[Pr(y_n = 1) = \frac{\exp(v_n)}{1 + \exp(v_n)} = 0.10456\]</span></p>
<p>Como el cambio de probabilidad es muy bajo, podemos concluir que ser usuario de twitter no es muy relevante para explicar si una persona le dará un “me gusta” a alguna componente de la campaña (notar que esto se puede inferir directamente de los estimadores máximo verosímiles). Para los próximos elementos de la campaña, probablemente convenga concentrarse en el género y edad de los usuarios.</p></li>
</ol>
</div>
<div id="pregunta-4-1" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Pregunta 4<a href="modelos-estructurales.html#pregunta-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el departamento de estudios de una importante multitienda buscan analizar simultáneamente los montos de compra en la tienda y el uso de la tarjeta de crédito de la casa comercial. Para eso la empresa ha recopilado, para cada cliente <span class="math inline">\(n\)</span>, una serie de variables que caracterizan su relación con la firma en el último año, como describe la siguiente tabla.</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Descripción</th>
<th>Promedio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y_n\)</span></td>
<td>Monto total gastado por cliente <span class="math inline">\(n\)</span> con la tienda</td>
<td>124.045</td>
</tr>
<tr class="even">
<td><span class="math inline">\(w_n\)</span></td>
<td>1 si cliente <span class="math inline">\(n\)</span> tiene la tarjeta de crédito de la tienda</td>
<td>0.64</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Mujer_n\)</span></td>
<td>1 si cliente <span class="math inline">\(n\)</span> es mujer</td>
<td>0.462</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Edad_n\)</span></td>
<td>Edad cliente <span class="math inline">\(n\)</span></td>
<td>36.21</td>
</tr>
</tbody>
</table>
<p>Como primera aproximación, los analistas del departamento de estudio han propuesto describir el gasto en tienda usando el siguiente modelo:</p>
<p><span class="math display">\[y_n = \begin{cases}
\beta_0 + \beta_1 Mujer_n + \beta_2 Edad_n + \varepsilon_{1n}, &amp; \text{si } w_n = 1 \\
\beta&#39;_0 + \beta&#39;_1 Mujer_n + \beta&#39;_2 Edad_n + \varepsilon_{2n}, &amp; \text{si } w_n = 0
\end{cases}\]</span></p>
<p>Y para la decisión de adquisición de tarjeta:</p>
<p><span class="math display">\[u_n = \begin{cases}
\gamma_0 + \gamma_1 Mujer_n + \gamma_2 Edad_n + \varepsilon_{3n}, &amp; \text{adquiere tarjeta} \\
\varepsilon_{4n}, &amp; \text{no adquiere}
\end{cases}\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Suponga que <span class="math inline">\(\varepsilon_{3n}\)</span> y <span class="math inline">\(\varepsilon_{4n}\)</span> son independientes y están idénticamente distribuidos valor extremo tipo 1. Calcule una expresión para la probabilidad que el cliente <span class="math inline">\(n\)</span> elija adquirir la tarjeta de la tienda.</p></li>
<li><p>Suponga que <span class="math inline">\(\varepsilon_{1n}\)</span> y <span class="math inline">\(\varepsilon_{2n}\)</span> son independientes y están normalmente distribuidos con media 0 y varianzas <span class="math inline">\(\sigma_1\)</span> y <span class="math inline">\(\sigma_2\)</span>. Calcule una expresión para la verosimilitud de observar un gasto <span class="math inline">\(y_n\)</span> condicional en que el cliente tiene tarjeta y otra para el gasto en que el cliente no tiene tarjeta.</p></li>
<li><p>Suponga que <span class="math inline">\(\varepsilon_{1n}\)</span> y <span class="math inline">\(\varepsilon_{2n}\)</span> son independientes de <span class="math inline">\(\varepsilon_{3n}\)</span> y <span class="math inline">\(\varepsilon_{4n}\)</span>. Escriba la log-verosimilitud de observar simultáneamente <span class="math inline">\(\{y_n\}_{n=1}^N\)</span> y <span class="math inline">\(\{w_n\}_{n=1}^N\)</span>.</p></li>
<li><p>La empresa está especialmente interesada en identificar si hay alguna diferencia en los patrones de gasto entre aquellos clientes que tienen tarjeta con respecto a aquellos que no tienen. Para ello se estima el modelo antes planteado obteniendo una log-verosimilitud <span class="math inline">\(LL_0 = -2.332,57\)</span> y luego otro en que se impone <span class="math inline">\(\beta_0 = \beta&#39;_0\)</span>, <span class="math inline">\(\beta_1 = \beta&#39;_1\)</span>, <span class="math inline">\(\beta_2 = \beta&#39;_2\)</span> con una log-verosimilitud <span class="math inline">\(LL_1 = -2.418,42\)</span>. Basado en el test de ratios de verosimilitud, determine si la tenencia de tarjeta afecta los patrones de gasto en tienda.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\nu\)</span></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\chi^2_\nu\)</span></td>
<td>3.84</td>
<td>5.99</td>
<td>7.81</td>
<td>9.49</td>
<td>11.07</td>
<td>12.59</td>
<td>14.07</td>
<td>15.51</td>
</tr>
</tbody>
</table>
<p>La tabla indica los valores de <span class="math inline">\(\chi^2_\nu\)</span> tales que <span class="math inline">\(Pr(\chi^2_\nu \leq \chi^2_\nu) = 0.95\)</span>.</p>
<ol start="5" style="list-style-type: decimal">
<li>Si las componentes <span class="math inline">\(\varepsilon_{1n}\)</span>, <span class="math inline">\(\varepsilon_{2n}\)</span>, <span class="math inline">\(\varepsilon_{3n}\)</span>, <span class="math inline">\(\varepsilon_{4n}\)</span> son todos independientes, discuta brevemente si hay algún beneficio de estudiar simultáneamente los comportamientos de gasto y tenencia de tarjeta.</li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Si <span class="math inline">\(\varepsilon_{3n}\)</span> y <span class="math inline">\(\varepsilon_{4n}\)</span> son independientes y distribuidos valor extremo, entonces la probabilidad que el cliente elija adquirir la tarjeta viene dada directamente por la fórmula del logit, donde la utilidad de no adquisición se ha normalizado en 0:</p>
<p><span class="math display">\[P_n = \frac{\exp(\gamma_0 + \gamma_1 Mujer_n + \gamma_2 Edad_n)}{1 + \exp(\gamma_0 + \gamma_1 Mujer_n + \gamma_2 Edad_n)}\]</span></p></li>
<li><p>Dada la distribución de los errores, los montos gastados para ambos casos estarán normalmente distribuidos. Entonces, las verosimilitudes condicionales vienen dadas por:</p>
<p><span class="math display">\[L(y_n|w_n = 1) = \frac{1}{\sqrt{2\pi\sigma_1^2}} \exp\left(-\frac{1}{2\sigma_1^2}(y_n - (\beta_0 + \beta_1 Mujer_n + \beta_2 Edad_n))^2\right)\]</span></p>
<p><span class="math display">\[L(y_n|w_n = 0) = \frac{1}{\sqrt{2\pi\sigma_2^2}} \exp\left(-\frac{1}{2\sigma_2^2}(y_n - (\beta&#39;_0 + \beta&#39;_1 Mujer_n + \beta&#39;_2 Edad_n))^2\right)\]</span></p></li>
<li><p>La respuesta se deriva directamente de la definición de verosimilitud y la fórmula de probabilidades totales:</p>
<p><span class="math display">\[LL = \sum_n \ln(P_n L(y_n|w_n = 1) + (1-P_n)L(y_n|w_n = 0))\]</span></p></li>
<li><p>La restricción propuesta implicaría que los patrones de gastos entre clientes con y sin tarjeta serán equivalentes. Para testear esta hipótesis se puede usar el test de ratios de verosimilitud directamente:</p>
<p><span class="math display">\[LR = 2(LL_0 - LL_1) = 2(-2332.57 - (-2418.42)) = 171.7\]</span></p>
<p>De acuerdo al número de restricciones, el <span class="math inline">\(LR\)</span> se distribuye <span class="math inline">\(\chi^2_{k=3}\)</span>. Por tanto, como el estadístico es mayor que el valor crítico <span class="math inline">\(\chi^2_{0.05,3} = 7.81\)</span>, rechazamos la hipótesis nula que el comportamiento de gasto es igual en los casos de clientes con y sin tarjeta.</p></li>
<li><p>El enfoque de modelación es útil principalmente para estudiar la interacción entre las decisiones de apertura de tarjeta y gasto. Si asumimos que los errores son independientes entonces podríamos enfrentar el problema simplemente como dos problemas separados. La respuesta esperada es que no hay beneficio en términos de la captura del fenómeno de comportamiento. Argumentar en favor de un modelo integrado en virtud de su escalabilidad y posibilidad de comparar con modelos más complejos son también respuestas correctas.</p></li>
</ol>
</div>
<div id="pregunta-5-1" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Pregunta 5<a href="modelos-estructurales.html#pregunta-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con el avenimiento de los espectáculos masivos, las productoras que organizan los eventos han puesto en práctica múltiples tácticas de discriminación de precios. A continuación nos enfocaremos en el estudio del comportamiento de clientes respecto a las ventas anticipadas de tickets o <em>pre-venta</em>, donde los clientes pueden comprar anticipadamente a un precio <span class="math inline">\(p_1\)</span> menor que <span class="math inline">\(p_2\)</span>, el precio de las entradas el día del evento. Para ello, nos enfocaremos exclusivamente en los clientes interesados en comprar tickets, cuyo comportamiento se describirá usando un modelo logit anidado. En este modelo, los clientes primero deciden si comprar anticipadamente o si esperan al día del evento. En el día del evento, los clientes deciden si asistir o no, generando cuatro escenarios como queda descrito en la siguiente figura.</p>
<p><img src="images/arbol_decision_tickets.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Para completar el modelo se ha propuesto las siguientes especificaciones para las componentes sistemática de la utilidad:</p>
<p><span class="math display">\[v_{PA} = \alpha_1 - \beta p_1\]</span>
<span class="math display">\[v_{PN} = \alpha_2 - \beta p_1\]</span>
<span class="math display">\[v_{EA} = \alpha_3 - \beta p_2\]</span>
<span class="math display">\[v_{EN} = 0\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Escriba una expresión para <span class="math inline">\(P_{EA}\)</span>, la probabilidad que un cliente espere sin comprar en la pre-venta y luego decida asistir al evento.</p></li>
<li><p>Suponga que observa el comportamiento de <span class="math inline">\(N\)</span> clientes, para cada uno de los cuales se observa <span class="math inline">\(y_{ni}\)</span> que toma valor 1 si el cliente decide la alternativa <span class="math inline">\(i \in \{PA, PN, EA, EN\}\)</span> (0 en caso contrario). Escriba una expresión para la log-verosimilitud <span class="math inline">\(LL(\theta = (\alpha_1, \alpha_2, \alpha_3, \beta, \lambda))\)</span>. Para eso asuma conocidas las expresiones de <span class="math inline">\(P_i(\theta)\)</span> <span class="math inline">\(\forall i \in I\)</span>.</p></li>
<li><p>Como analista, le interesa investigar las restricciones de comportamiento <span class="math inline">\(\alpha_1 = \alpha_3\)</span> y <span class="math inline">\(\alpha_2 = 0\)</span>. Explique qué interpretación podría tener dichas hipótesis y cómo podrían testearse.</p></li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Partimos por calcular la probabilidad condicional de asistir al evento condicional en que esperó. Esta probabilidad viene dada directamente por la fórmula del logit:</p>
<p><span class="math display">\[P_{A|E} = \frac{\exp(\alpha_3 - \beta p_2)}{\exp(\alpha_3 - \beta p_2) + 1}\]</span></p>
<p>Luego calculamos la probabilidad de esperar no comprando en la preventa:</p>
<p><span class="math display">\[P_E = \frac{\exp(\lambda IV_E)}{\exp(\lambda IV_P) + \exp(\lambda IV_E)}\]</span></p>
<p>donde <span class="math inline">\(IV_P\)</span> y <span class="math inline">\(IV_E\)</span> son los valores inclusivos de comprar y no comprar en la preventa respectivamente:</p>
<p><span class="math display">\[IV_P = \ln(\exp(\alpha_1 - \beta p_1) + \exp(\alpha_2 - \beta p_1))\]</span>
<span class="math display">\[IV_E = \ln(\exp(\alpha_3 - \beta p_2) + 1)\]</span></p>
<p>Finalmente, la probabilidad total viene dada por la multiplicación de las dos probabilidades anteriores:</p>
<p><span class="math display">\[P_{EA} = P_{A|E} \cdot P_E\]</span></p></li>
<li><p>Aplicamos directamente la definición de la verosimilitud:</p>
<p><span class="math display">\[LL(\theta) = \sum_n \sum_{i \in I} y_{ni} \ln(P_i(\theta))\]</span></p></li>
<li><p>Imponer que <span class="math inline">\(\alpha_1 = \alpha_3\)</span> implicaría que la utilidad intrínseca que los clientes derivan por asistir al evento es la misma independiente de si compraron en la preventa o no. Del mismo modo, imponer que <span class="math inline">\(\alpha_2 = 0\)</span> implicaría que no hay una pérdida de utilidad por comprar los boletos y no asistir más allá del precio pagado. Para testear cada hipótesis, usamos test de ratios de verosimilitud, lo que implica (i) el cálculo de la log-verosimilitud de los modelos con (<span class="math inline">\(LL_A\)</span>) y sin (<span class="math inline">\(LL_B\)</span>) restricciones, (ii) el cálculo del estadístico <span class="math inline">\(LR = 2(LL_A - LL_B)\)</span> y (iii) la comparación de dicho estadístico contra el valor crítico una <span class="math inline">\(\chi^2_1\)</span> con un grado de libertad.</p></li>
</ol>
</div>
<div id="pregunta-6-1" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Pregunta 6<a href="modelos-estructurales.html#pregunta-6-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una empresa busca estudiar el impacto del gasto publicitario en su producto estrella, donde tiene una posición monopólica en un mercado de tamaño conocido. Para ello ha reunido las series de precios (<span class="math inline">\(p_t\)</span>), ventas (<span class="math inline">\(q_t\)</span>) y gasto publicitario (<span class="math inline">\(ADV_t\)</span>) para las últimas 205 semanas y ha propuesto un modelo de elección binaria basado en la siguiente función de utilidad <span class="math inline">\(u_t = \alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t + \varepsilon_t\)</span>, donde <span class="math inline">\(\nu_t\)</span> están normalmente distribuidos con media 0 y <span class="math inline">\(\varepsilon_t\)</span> están distribuidos valor extremo.</p>
<ol style="list-style-type: decimal">
<li><p>Muestre que si <span class="math inline">\(s_t\)</span> es la participación de mercado del producto, los parámetros <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> y <span class="math inline">\(\gamma\)</span> pueden estimarse usando un enfoque de mínimos cuadrados ordinarios sobre la siguiente ecuación:</p>
<p><span class="math display">\[\ln(s_t) - \ln(1-s_t) = \alpha + \beta \ln(p_t) + \gamma ADV_t\]</span></p></li>
<li><p>Usando un enfoque de regresión se ha estimado el modelo, obteniendo los siguientes resultados:</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th>Parámetro</th>
<th>MLE</th>
<th>s.e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>-1.76</td>
<td>0.27</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta\)</span></td>
<td>-1.23</td>
<td>0.02</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\gamma\)</span></td>
<td>0.31</td>
<td>0.09</td>
</tr>
</tbody>
</table>
<p>Si se mantiene el precio constante en 1 y el gasto publicitario sube de 10 a 20, ¿cuántos puntos porcentuales aumenta la demanda por el producto?</p>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Aplicando la definición del modelo logit:</p>
<p><span class="math display">\[s_t = \frac{\exp(\alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t)}{1 + \exp(\alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t)}\]</span></p>
<p><span class="math display">\[1 - s_t = \frac{1}{1 + \exp(\alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t)}\]</span></p>
<p>Como los denominadores son iguales:</p>
<p><span class="math display">\[\frac{s_t}{1-s_t} = \exp(\alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t)\]</span></p>
<p>Aplicando logaritmo y reordenando términos:</p>
<p><span class="math display">\[\ln(s_t) - \ln(1-s_t) = \alpha + \beta \ln(p_t) + \gamma ADV_t + \nu_t\]</span></p>
<p>Como <span class="math inline">\(\nu_t\)</span> está normalmente distribuido, se satisfacen las condiciones para aplicar mínimos cuadrados ordinarios.</p></li>
<li><p>Evaluamos directamente:</p>
<p><span class="math display">\[s_t(ADV_t = 10) = \frac{\exp(-1.76 - 1.23 \ln(1) + 0.31 \times 10)}{1 + \exp(-1.76 - 1.23 \ln(1) + 0.31 \times 10)} = 0.792\]</span></p>
<p><span class="math display">\[s_t(ADV_t = 20) = \frac{\exp(-1.76 - 1.23 \ln(1) + 0.31 \times 20)}{1 + \exp(-1.76 - 1.23 \ln(1) + 0.31 \times 20)} = 0.988\]</span></p>
<p>Por lo tanto hay un incremento de <span class="math inline">\(\Delta = 19.6\)</span> puntos porcentuales.</p></li>
</ol>
</div>
<div id="pregunta-7" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> Pregunta 7<a href="modelos-estructurales.html#pregunta-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pizza a Pieza es un servicio de pizzas a domicilio que lleva varios años operando en el sector sur de la capital. Los administradores de la tienda quieren estudiar el comportamiento de compra de sus clientes. Para eso, se proponen calibrar modelos de elección discreta usando una base de clientes registrados en la compañía y que hayan comprado al menos una vez en los últimos 6 meses. La base de datos está compuesta por 763 clientes de los que se conoce su número telefónico, la edad y género del jefe de hogar y si han comprado en cada semana <span class="math inline">\(t\)</span> durante los últimos 6 meses de operación (<span class="math inline">\(y_{nt} = 1\)</span> si el cliente <span class="math inline">\(n\)</span> compró en la semana <span class="math inline">\(t\)</span>). Además, para cada semana se conoce el precio de lista de las pizzas (que por políticas de la empresa es el mismo independiente de la variedad de la pizza) y si se repartieron volantes con publicidad.</p>
<ol style="list-style-type: decimal">
<li><p>Suponga que la utilidad que un cliente <span class="math inline">\(n\)</span> deriva por comprar en un semana <span class="math inline">\(t\)</span> puede describirse como <span class="math inline">\(u_{nt} = \beta_0&#39; x_{nt} + \varepsilon_{nt}\)</span>. Si <span class="math inline">\(\{\varepsilon_{nt}\}\)</span> con <span class="math inline">\(n = 1, \ldots, N\)</span> y <span class="math inline">\(t = 1, \ldots, T\)</span> están independiente e idénticamente distribuidos valor extremo tipo I, escriba la log-verosimilitud de un modelo que describa las compras de la base de clientes.</p></li>
<li><p>Al revisar la data, los analistas se dan cuenta que en los últimos 6 meses de operación, los precios de las pizzas ha sido exactamente los mismos. ¿Es posible estimar la sensibilidad al precio de la demanda con datos de esta naturaleza? Si no fuera posible, describa qué otra información podría recolectarse para hacer la estimación.</p></li>
<li><p>Un largo debate en el ámbito de la planificación comercial es el rol que juega la publicidad en afectar el comportamiento del consumidor. El primer argumento indica que la publicidad afecta directamente la utilidad de elección. Bajo este argumento un consumidor obtendrá un mayor beneficio al consumir un producto sobre el que ha sido expuesto a avisaje comercial con respecto a uno en que no ha sido expuesto. Un segundo argumento indica que la publicidad no implica una mayor utilidad en el consumo, pero hace a los consumidores menos sensibles al precio. Siguiendo los pasos que se indican, proponga un procedimiento para determinar cuál de estos argumentos describe mejor el comportamiento de los clientes de Pizza a Pieza.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Resulta plausible suponer que el efecto de la publicidad se manifiesta en el mediano plazo. Esto es, el avisaje publicitario hoy no afecta sólo el comportamiento de compra hoy sino que también en los próximos días. Proponga una métrica para capturar la intensidad acumulada de la publicidad.</p></li>
<li><p>Usando una métrica de intensidad acumulada de publicidad, escriba la función de utilidad que ejemplifique la situación en que la publicidad afecta directamente la utilidad del consumo.</p></li>
<li><p>Usando una métrica de intensidad acumulada de publicidad, escriba la función de utilidad que ejemplifique la situación en que la publicidad afecte indirectamente a través de la sensibilidad al precio.</p></li>
<li><p>Describa cómo evaluaría cuál de los dos modelos describe mejor el comportamiento de compra de los clientes.</p></li>
</ol></li>
<li><p>Después de explorar la data se ha acordado estimar dos modelos sin heterogeneidad. El primero (M1) considera solo un intercepto y una variable de lealtad que permita diferenciar de aquellos clientes que compran mucho de aquellos que compran menos. El segundo, junto con las variables anteriores consideran además un coeficiente de precio, otro de promoción y finalmente el efecto (directo) de la publicidad (M2). Los estimadores máximo verosímiles de estos dos modelos se encuentran disponibles en la siguiente tabla:</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th>Parámetros</th>
<th>M1</th>
<th>M2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercepto</td>
<td>5.23</td>
<td>5.54</td>
</tr>
<tr class="even">
<td>Lealtad</td>
<td>3.17</td>
<td>X</td>
</tr>
<tr class="odd">
<td>Precio</td>
<td>-</td>
<td>-3.25</td>
</tr>
<tr class="even">
<td>Promoción</td>
<td>-</td>
<td>4.73</td>
</tr>
<tr class="odd">
<td>Publicidad</td>
<td>-</td>
<td>0.04</td>
</tr>
<tr class="even">
<td><span class="math inline">\(-2LL\)</span></td>
<td>20.17</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>BIC</td>
<td>3145</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p>Discuta si valores de X, Y y Z debieran ser, mayores o menores que los estimadores máximo verosímiles del M1.</p>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Como la componente aleatoria de la probabilidad se distribuye valor extremo tipo I, entonces resulta un modelo logit, cuya log verosimilitud viene dada por:</p>
<p><span class="math display">\[LL = \sum_n \sum_t y_{nt} \ln\frac{\exp(\beta_0&#39; x_{nt})}{1 + \exp(\beta_0&#39; x_{nt})} + (1-y_{nt}) \ln\frac{1}{1 + \exp(\beta_0&#39; x_{nt})}\]</span></p></li>
<li><p>Si no hay variabilidad entonces no podemos saber cuál es el efecto del precio. Otras variables que podrían recolectarse son algunas actividades promocionales que hagan variar el precio de lista como uso de cupones o promociones. También podría saber variabilidad de precio de alternativas cercanas como otras pizzerías cercanas o de incluso otros restaurantes con cobertura de reparto similar.</p></li>
<li><ol style="list-style-type: lower-alpha">
<li>Al igual como hemos usado para medir el impacto acumulado de algunos comportamientos, para capturar la publicidad podemos usar una media móvil. Sea <span class="math inline">\(a_t = 1\)</span> si la firma repartió volantes publicitarios en la semana <span class="math inline">\(t\)</span> y <span class="math inline">\(\lambda \in (0,1)\)</span>, entonces la métrica acumulada de publicidad en <span class="math inline">\(t\)</span> (<span class="math inline">\(ADV_t\)</span>) puede definirse como:</li>
</ol>
<p><span class="math display">\[ADV_t = \lambda ADV_{t-1} + (1-\lambda) a_{t-1}\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Aunque otras formas funcionales son posibles, lo más sencillo es imponer que la publicidad acumulada entra aditivamente en la función de utilidad:</li>
</ol>
<p><span class="math display">\[u_{nt} = \beta_0&#39; x_{nt} + \delta ADV_t + \varepsilon_{nt}\]</span></p>
<p>donde <span class="math inline">\(x_{nt}\)</span> incluye cualquier otra variable explicativa que quiera usarse para describir la utilidad de elección.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Aunque otras formas funcionales son posibles, lo más sencillo es imponer que la publicidad acumulada entra aditivamente en la sensibilidad al precio:</li>
</ol>
<p><span class="math display">\[u_{nt} = \beta_0&#39; w_{nt} + (\beta_1 + \delta ADV_t) PRICE_{nt} + \varepsilon_{nt}\]</span></p>
<p>donde <span class="math inline">\(w_{nt}\)</span> incluye cualquier otra variable explicativa que quiera usarse para describir la sensibilidad al precio.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Habría que estimar ambos modelos y evaluar cuál de los dos ajusta mejor a la data. Para eso se deben comparar métricas como pseudo-<span class="math inline">\(R^2\)</span>, AIC, BIC y MAPE.</li>
</ol></li>
<li><p>Como hay más variables explicativas, <span class="math inline">\(-2LL\)</span> debiera ser menor o igual (es decir Y debiera ser menor que 20.17). Como BIC penaliza usar más variables, Z puede subir o bajar. Por último, tal como vimos en clases, X debiera subir. Esto es porque al no controlar por promoción y publicidad, no podremos identificar que a veces clientes relativamente leales dejan de comprar por variaciones en la oferta.</p></li>
</ol>
</div>
<div id="pregunta-8" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> Pregunta 8<a href="modelos-estructurales.html#pregunta-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un retailer nacional está interesado en determinar el impacto de las publicaciones en su sitio web en sus ventas online. Esto es, la evaluación de cómo la promoción de un determinado producto afecta el volumen de sus ventas. Para esto, se ha propuesto un modelo estructural en donde la componente determinística de la utilidad de comprar un producto <span class="math inline">\(i\)</span> de cada cliente <span class="math inline">\(n\)</span> en el día <span class="math inline">\(t\)</span> está dada por (note que es plausible que un cliente compre más de un producto por día):</p>
<p><span class="math display">\[v_{nit} = \alpha_i + \beta_{PR} Precio_{it} + \beta_S Size_{it} + \beta_{POS} Posicion_{it} + \beta_M Mail_{nt}\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Plantee un modelo logit para describir el comportamiento de compra de los usuarios. Si hay <span class="math inline">\(I\)</span> productos disponibles y cada día <span class="math inline">\(t\)</span> llegan a la tienda <span class="math inline">\(N_t\)</span> clientes, escriba la log-verosimilitud del modelo.</p></li>
<li><p>Si en vez de plantear un modelo logit, se prefiriera un modelo probit, ¿qué dimensión tendría la matriz de varianzas-covarianzas?</p></li>
<li><p>Para el modelo logit, determine el número esperado de ventas del producto <span class="math inline">\(i\)</span> en un día <span class="math inline">\(t\)</span>.</p></li>
<li><p>Escriba la expresión aproximada de la log-verosimilitud de un mixed logit, cuyos parámetros son generados a partir de un sampleo de <span class="math inline">\(R\)</span> valores de una distribución normal.</p></li>
</ol>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Bajo un modelo logit, la probabilidad que el cliente <span class="math inline">\(n\)</span> elija compre el producto <span class="math inline">\(i\)</span> en el día <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display">\[p_{nit} = \frac{\exp(v_{nit})}{1 + \exp(v_{nit})}\]</span></p>
<p>Luego, si <span class="math inline">\(y_{nit}\)</span> toma el valor 1 si el cliente <span class="math inline">\(n\)</span> compró el producto <span class="math inline">\(i\)</span> en <span class="math inline">\(t\)</span>, entonces la log verosimilitud viene dada por:</p>
<p><span class="math display">\[LL = \sum_i \sum_t \sum_{n=1}^{N_t} y_{nit} \ln(p_{nit}) + (1-y_{nit}) \ln(1-p_{nit})\]</span></p></li>
<li><p>La elección es binaria por lo que matriz de varianza covarianza tiene dos filas y dos columnas. Se puede argumentar también que por temas de identificación hay solo un parámetro identificable.</p></li>
<li><p>El número esperado es directamente <span class="math inline">\(\sum_{n=1}^{N_t} p_{nit}\)</span>.</p></li>
<li><p>La expresión es idéntica a la anterior, pero ahora no tenemos una fórmula cerrada para <span class="math inline">\(p_{nit}\)</span> y debemos aproximarlo:</p>
<p><span class="math display">\[p_{nit} \approx \frac{1}{R} \sum_{r=1}^R \frac{\exp(v_{nit}(\theta^r))}{1 + \exp(v_{nit}(\theta^r))}\]</span></p></li>
</ol>
</div>
<div id="pregunta-9" class="section level3 hasAnchor" number="4.4.9">
<h3><span class="header-section-number">4.4.9</span> Pregunta 9<a href="modelos-estructurales.html#pregunta-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con el reciente sorteo de la Copa América Chile 2015 (cómo pasó tan rápido el tiempo), el comité organizador está interesado en estudiar cómo los hinchas deciden a qué partido asistir. Como primera aproximación se busca un modelo que indique si un hincha decide asistir o no a los partidos que juega su equipo preferido. Suponga que usted tiene total certeza que su equipo favorito llegará a la final. A continuación se presenta los datos con los que dispone.</p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(DISTANCIA_{ij}\)</span></td>
<td>Distancia del hincha <span class="math inline">\(i\)</span> para el partido <span class="math inline">\(j\)</span> de su equipo favorito</td>
</tr>
<tr class="even">
<td><span class="math inline">\(FASE_{ij}\)</span></td>
<td>Fase del partido <span class="math inline">\(j\)</span> del equipo favorito del hincha <span class="math inline">\(i\)</span> (eg: semifinal)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(RIVAL_{ij}\)</span></td>
<td>Rival en el partido <span class="math inline">\(j\)</span> del equipo favorito del hincha <span class="math inline">\(i\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(PRECIO_{ij}\)</span></td>
<td>Precio de la entrada del partido <span class="math inline">\(j\)</span> del equipo favorito del hincha <span class="math inline">\(i\)</span></td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>Escriba la utilidad para un modelo de elección discreta que considere que (i) cada fase (grupos, cuartos, semi, final) agrega más público, (ii) la distancia afecta de manera no lineal (discuta qué forma funcional podría ser adecuada) y que (iii) los rivales Brasil y Argentina atraen más público que el resto.</p></li>
<li><p>Los datos que muestra la tabla a continuación son de un espectador que podría haber asistido a 2 partidos, pero solo asiste a uno. Escriba explícitamente la log-verosimilitud de un modelo logit para este hincha.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th>Partido</th>
<th>Compra</th>
<th>Fase</th>
<th>Rival</th>
<th>Precio Entrada</th>
<th>Distancia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>Grupos</td>
<td>Colombia</td>
<td>$5.000</td>
<td>5.5 km</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>Cuartos de Final</td>
<td>Brasil</td>
<td>$7.000</td>
<td>474 km</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Proponga un modelo de decisión anidado en dos etapas especificando las probabilidades que permitan describir el proceso de compra de abonos para la fase grupal. En esta modalidad, los hinchas deben pagar por anticipado <span class="math inline">\(P_{abono}\)</span> por los tres partidos de la fase de grupos. Una vez comprado el abono el hincha debe decidir si asistir a uno, dos o a los tres partidos de la etapa de grupos. Por simplicidad suponga que las componentes determinísticas de las utilidades de asistir a <span class="math inline">\(k\)</span> partidos es <span class="math inline">\(v_k\)</span>.</p></li>
<li><p>Suponga que el gobierno instaura un programa para estudiantes que les da un descuento para que pueda asistir a un único partido de la fase de grupos. En este programa, los estudiantes pueden elegir de entre los tres partidos programados. Suponga que para estudiar este comportamiento se estima un modelo probit sobre datos de encuestas a potenciales beneficiarios y se encuentra una matriz varianza-covarianza (desnormalizada) como sigue. Interprete los resultados.</p></li>
</ol>
<p><span class="math display">\[\Sigma = \begin{bmatrix} 0.198 &amp; 0.533 &amp; 0 \\ 0.533 &amp; 0.360 &amp; 0.258 \\ 0 &amp; 0.258 &amp; 0.852 \end{bmatrix}\]</span></p>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Un modelo que soporta la situación descrita viene dado por:</p>
<p><span class="math display">\[v_{ij} = \beta_0 + \beta_1 \delta(cuartos_j) + \beta_2 \delta(semis_j) + \beta_3 \delta(final_j) + \beta_4 distancia_{ij} + \beta_5 distancia_{ij}^2 + \beta_6 \delta(ArgBra_j)\]</span></p>
<p>Al respecto, es útil comentar algunos puntos:</p>
<ol style="list-style-type: decimal">
<li><p>En este modelo la asistencia diferenciada por etapa queda incluida a través de variables dummies (una etapa debe excluirse por identificación). Alternativamente, podría crearse una variable <span class="math inline">\(NumEtapa_{ij}\)</span> que tome el valor 1 para grupos, 2 para cuartos, 3 para semis y 4 para la final e ingresarse directamente en la definición de la utilidad. Notar sin embargo que esto asume un aumento lineal.</p></li>
<li><p>En esta especificación se propone una forma polinomial flexible para el efecto de la distancia. Si por ejemplo se asume una forma logarítmica se debiera explicar porque se espera que la distancia tenga efectos decrecientes.</p></li>
</ol></li>
<li><p>Basta reemplazar la especificación anterior con los datos de la tabla. Sean:</p>
<p><span class="math display">\[w_1 = \beta_0 + \beta_4 \times 5.5 + \beta_5 \times 5.5^2\]</span>
<span class="math display">\[w_2 = \beta_0 + \beta_1 + \beta_4 \times 474 + \beta_5 \times 474^2 + \beta_6\]</span></p>
<p>Entonces, la contribución a la log-verosimilitud viene dada por:</p>
<p><span class="math display">\[LL = \ln\left(\frac{1}{1 + e^{w_1}}\right) + \ln\left(\frac{e^{w_2}}{1 + e^{w_2}}\right)\]</span></p></li>
<li><p>Las probabilidades de los números de partidos en la segunda etapa vienen dados directamente por:</p>
<p><span class="math display">\[p_{1|A} = \frac{e^{v_1}}{e^{v_1} + e^{v_2} + e^{v_3}}\]</span>
<span class="math display">\[p_{2|A} = \frac{e^{v_2}}{e^{v_1} + e^{v_2} + e^{v_3}}\]</span>
<span class="math display">\[p_{3|A} = \frac{e^{v_3}}{e^{v_1} + e^{v_2} + e^{v_3}}\]</span></p>
<p>Finalmente, la decisión de si abonarse o no, viene dada por:</p>
<p><span class="math display">\[p_a = \frac{e^{\lambda IV - Precio_{Abono}}}{1 + e^{\lambda IV - Precio_{Abono}}}\]</span></p>
<p>donde el valor inclusivo viene dado por <span class="math inline">\(IV = \ln(e^{v_1} + e^{v_2} + e^{v_3})\)</span>.</p></li>
<li><p>Aunque se puede elaborar más, es importante reconocer al menos dos factores:</p>
<ul>
<li><p>Los términos de la diagonal son crecientes indicando que la utilidad del tercer partido tiene mayor variabilidad que el segundo y este más que el primero.</p></li>
<li><p>El 0 en la esquina superior derecha indica que no hay correlación entre las componentes no observables del primer con el tercer partido.</p></li>
</ul></li>
</ol>
</div>
<div id="pregunta-10" class="section level3 hasAnchor" number="4.4.10">
<h3><span class="header-section-number">4.4.10</span> Pregunta 10<a href="modelos-estructurales.html#pregunta-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En cada periodo <span class="math inline">\(t\)</span>, una agencia de medios está encargada de seleccionar los soportes publicitarios en que se emitirán las campañas de cada uno de sus <span class="math inline">\(K\)</span> clientes de acuerdo a los requerimientos que ellos indiquen. Por ejemplo una marca puede indicar que quiere distribuir su presupuesto para que las piezas publicitarias sean exhibidas solo en TV o en una mezcla de radio y vallas públicas. Aunque cada cliente puede requerir presencia en cualquier tipo de medio, el 86% de los clientes elige en alguno de los siguiente paquetes:</p>
<ul>
<li><p><strong>Masivo multimedia:</strong> en este paquete la agencia se compromete a alcanzar un cierto nivel de GRP para lo cuál puede hacer uso de cualquier medio. Los promedios históricos sugieren que un 40% se gasta en TV, un 25% en prensa escrita, un 20% en radio y un 10% en medios digitales.</p></li>
<li><p><strong>Nicho multimedia:</strong> en este paquete la agencia se compromete a alcanzar un cierto nivel de GRP, pero concentrado en medios especializados. Así, dependiendo del rubro, la marca puede elegir entre algunas de las variantes temáticas disponible como deportes, infantil, outdoors, entre otros.</p></li>
<li><p><strong>Nicho radio y escrito:</strong> Similar al paquete Nicho multimedia, pero restringiendo la parrilla a prensa escrita y a radio. A raíz de esta restricción el paquete conlleva un importante descuento en el precio.</p></li>
<li><p><strong>Solo online:</strong> En este paquete, todo el avisaje se realiza a través de medios digitales incluyendo sponsored links, banners y sitios de redes sociales. Junto con el bajo costo del paquete, esta propuesta permite menor granularidad en la selección de los segmentos objetivos y un incipiente módulo de analytics para reportar la efectividad de la propuesta.</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Escriba la utilidad total (determinista y aleatoria) que cada cliente <span class="math inline">\(k\)</span> deriva por la elección de cada alternativa <span class="math inline">\(i\)</span> en cada periodo <span class="math inline">\(t\)</span>, considerando que:</p>
<ul>
<li><p>Marcas de distintas industrias tienen distintas valoraciones intrínsecas por cada paquete. Por ejemplo, la industria bancaria tiene una gran valoración por el paquete Masivo Multimedia, mientras que los proveedores de servicios tecnológicos prefieren el Solo online.</p></li>
<li><p>Cada paquete <span class="math inline">\(i\)</span> tiene una fracción de su GRP en el segmento ABC1 (<span class="math inline">\(F_{ABC1i}\)</span>) y la valoración que cada cliente <span class="math inline">\(k\)</span> tiene respecto este porcentaje depende tanto de la penetración de la marca (<span class="math inline">\(PEN_{kt}\)</span>) cómo de su coeficiente de exclusividad (<span class="math inline">\(EX_k\)</span>) los que son definidos por una consultora externa.</p></li>
<li><p>Considerando la baja sofisticación técnica de la industria y que existen costos relevantes en la evaluación de cada propuesta, en la práctica se evidencia una alta inercia en la elección del mix de medios (i.e, marcas tienden a elegir lo que han elegido en periodos anteriores).</p></li>
</ul></li>
<li><p>Derive una expresión para la probabilidad que cada cliente elija cada alternativa. Para eso, considere que el paquete Solo online solo estuvo disponible en un set de semanas <span class="math inline">\(\tau\)</span>.</p></li>
<li><p>Escriba la log-verosimilitud del problema si existen dos clases latentes. Escriba de modo que todos los parámetros puedan ser estimados directamente a través de la maximización irrestricta de la log-verosimilitud.</p></li>
<li><p>Al estimar el modelo anterior con dos clases, el tamaño de la primera clase queda determinado por <span class="math inline">\(\lambda = 0\)</span>, estimado directamente de la maximización de la log-verosimilitud. ¿Qué fracción de clientes pertenece a la clase 2?</p></li>
<li><p>Se propone un modelo mixed logit. Para estimarlo se implementa el método de la máxima verosimilitud simulada con tres simulaciones por iteración (<span class="math inline">\(R = 3\)</span>). La tabla describe los valores de la última iteración para el periodo 53 para el cliente 114. ¿Cuál es la probabilidad que dicho cliente elija Nicho Multimedia en dicho periodo?</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th>Paquete</th>
<th>R=1</th>
<th>R=2</th>
<th>R=3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Masivo multimedia</td>
<td>0.3</td>
<td>0.3</td>
<td>0.4</td>
</tr>
<tr class="even">
<td>Nicho multimedia</td>
<td>0.2</td>
<td>0.3</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td>Nicho radio y escrito</td>
<td>0.4</td>
<td>0.3</td>
<td>0.2</td>
</tr>
<tr class="even">
<td>Solo online</td>
<td>0.1</td>
<td>0.1</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p><strong>Solución:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Sea <span class="math inline">\(y_{ikt} = 1\)</span> si el cliente <span class="math inline">\(k\)</span> elige el paquete <span class="math inline">\(i\)</span> en la semana <span class="math inline">\(t\)</span> y <span class="math inline">\(\delta_{kj} = 1\)</span> si el cliente <span class="math inline">\(k\)</span> pertenece al rubro <span class="math inline">\(j\)</span>. Entonces, la utilidad total viene dada por <span class="math inline">\(u_{ikt} = v_{ikt} + \varepsilon_{ikt}\)</span> donde <span class="math inline">\(\varepsilon_{ikt}\)</span> distribuye valor extremo tipo I y <span class="math inline">\(v_{ikt}\)</span> viene dada por:</p>
<p><span class="math display">\[v_{ikt}(\beta) = \sum_j \beta_{ikj} \delta_{kj} + \gamma_{kt} F_{ABC1ikt} + \omega y_{ikt-1}\]</span>
<span class="math display">\[v_{ikt}(\beta) = \sum_j \beta_{ikj} \delta_{kj} + (\gamma_0 + \gamma_1 PEN_{kt} + \gamma_2 EX_k) F_{ABC1ikt} + \omega y_{ikt-1}\]</span></p></li>
<li><p>Aplicamos directamente la fórmula del logit, con la única salvedad que el conjunto de alternativas difiere en algunos casos:</p>
<p><span class="math display">\[p_{ikt}(\beta) = \begin{cases}
0 &amp; t \notin \tau \land i = 4 \\
\frac{\exp(v_{ikt}(\beta))}{\sum_{j=1}^{3} \exp(v_{jkt}(\beta))} &amp; t \notin \tau \land i &lt; 4 \\
\frac{\exp(v_{ikt}(\beta))}{\sum_{j=1}^{4} \exp(v_{jkt}(\beta))} &amp; t \in \tau
\end{cases}\]</span></p></li>
<li><p>Escribimos directamente:</p>
<p><span class="math display">\[LL(\beta_1, \beta_2, \lambda) = \sum_k \sum_i \sum_t \left[\frac{\exp(\lambda)}{1 + \exp(\lambda)} y_{ikt} \ln(p_{ikt}(\beta_1)) + \frac{1}{1 + \exp(\lambda)} \ln(p_{ikt}(\beta_2))\right]\]</span></p></li>
<li><p>La probabilidad de pertenecer al segmento 2 viene dada por:</p>
<p><span class="math display">\[s_2 = \frac{1}{1 + \exp(\lambda)} = \frac{1}{2}\]</span></p></li>
<li><p>Simplemente tomamos el promedio de las 3 muestras:</p>
<p><span class="math display">\[p_{ikt} = \frac{1}{R} \sum_r p_{ikt}^r = \frac{0.2 + 0.3 + 0.3}{3} = 0.2667\]</span></p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-probabilisticos.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/04-estructurales.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
