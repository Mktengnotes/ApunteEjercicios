<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 Modelos Probabilisticos | Apunte Problemas Resueltos</title>
  <meta name="description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 Modelos Probabilisticos | Apunte Problemas Resueltos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 Modelos Probabilisticos | Apunte Problemas Resueltos" />
  
  <meta name="twitter:description" content="Apunte de ejercicios realizados durante el curso de Marketing II" />
  

<meta name="author" content="Marcel Goic" />


<meta name="date" content="2025-10-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-de-regresion.html"/>
<link rel="next" href="modelos-estructurales.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Apunte de Problemas Resueltos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prologo</a></li>
<li class="chapter" data-level="1" data-path="formulas-utiles.html"><a href="formulas-utiles.html"><i class="fa fa-check"></i><b>1</b> Formulas utiles</a></li>
<li class="chapter" data-level="2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html"><i class="fa fa-check"></i><b>2</b> Modelos de Regresion</a>
<ul>
<li class="chapter" data-level="2.1" data-path="03-probabilisticos.html"><a href="#introducci%C3%B3n"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="03-probabilisticos.html"><a href="#metodolog%C3%ADa"><i class="fa fa-check"></i><b>2.2</b> Metodología</a></li>
<li class="chapter" data-level="2.3" data-path="03-probabilisticos.html"><a href="#problemas-te%C3%B3ricos"><i class="fa fa-check"></i><b>2.3</b> Problemas Teóricos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e1-signo-esperado-y-significancia"><i class="fa fa-check"></i><b>2.3.1</b> E1: Signo esperado y significancia</a></li>
<li class="chapter" data-level="2.3.2" data-path="03-probabilisticos.html"><a href="#e2-regresi%C3%B3n-lineal-vs-de-poisson"><i class="fa fa-check"></i><b>2.3.2</b> E2: Regresión Lineal vs de Poisson</a></li>
<li class="chapter" data-level="2.3.3" data-path="03-probabilisticos.html"><a href="#e3-selecci%C3%B3n-autom%C3%A1tica-de-variables"><i class="fa fa-check"></i><b>2.3.3</b> E3: Selección automática de variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="03-probabilisticos.html"><a href="#e4-regresi%C3%B3n-log-nivel-y-log-log"><i class="fa fa-check"></i><b>2.3.4</b> E4: Regresión Log-Nivel y Log-Log</a></li>
<li class="chapter" data-level="2.3.5" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#e5-capturar-efectos"><i class="fa fa-check"></i><b>2.3.5</b> E5: Capturar efectos</a></li>
<li class="chapter" data-level="2.3.6" data-path="03-probabilisticos.html"><a href="#e6-coeficientes-y-par%C3%A1metros"><i class="fa fa-check"></i><b>2.3.6</b> E6: Coeficientes y Parámetros</a></li>
<li class="chapter" data-level="2.3.7" data-path="03-probabilisticos.html"><a href="#e7-qu%C3%A9-es-un-modelo-de-regresi%C3%B3n"><i class="fa fa-check"></i><b>2.3.7</b> E7: ¿Qué es un modelo de Regresión?</a></li>
<li class="chapter" data-level="2.3.8" data-path="03-probabilisticos.html"><a href="#soluci%C3%B3n-problemas-te%C3%B3ricos"><i class="fa fa-check"></i><b>2.3.8</b> Solución problemas teóricos</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problemas-aplicados"><i class="fa fa-check"></i><b>2.4</b> Problemas Aplicados</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-1"><i class="fa fa-check"></i><b>2.4.1</b> Problema 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-2"><i class="fa fa-check"></i><b>2.4.2</b> Problema 2</a></li>
<li class="chapter" data-level="2.4.3" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-3"><i class="fa fa-check"></i><b>2.4.3</b> Problema 3</a></li>
<li class="chapter" data-level="2.4.4" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-4---p1-control-1-primavera-2025"><i class="fa fa-check"></i><b>2.4.4</b> Problema 4 - P1 Control 1 Primavera 2025</a></li>
<li class="chapter" data-level="2.4.5" data-path="03-probabilisticos.html"><a href="#problema-5---p1-control-oto%C3%B1o-2025"><i class="fa fa-check"></i><b>2.4.5</b> Problema 5 - P1 Control Otoño 2025</a></li>
<li class="chapter" data-level="2.4.6" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-6---p1-control-primavera-2024"><i class="fa fa-check"></i><b>2.4.6</b> Problema 6 - P1 Control Primavera 2024</a></li>
<li class="chapter" data-level="2.4.7" data-path="03-probabilisticos.html"><a href="#problema-7---p1-control-1-oto%C3%B1o-2024"><i class="fa fa-check"></i><b>2.4.7</b> Problema 7 - P1 Control 1 Otoño 2024</a></li>
<li class="chapter" data-level="2.4.8" data-path="modelos-de-regresion.html"><a href="modelos-de-regresion.html#problema-8---p1-control-primavera-2023"><i class="fa fa-check"></i><b>2.4.8</b> Problema 8 - P1 Control Primavera 2023</a></li>
<li class="chapter" data-level="2.4.9" data-path="03-probabilisticos.html"><a href="#problema-9---p1-control-oto%C3%B1o-2023"><i class="fa fa-check"></i><b>2.4.9</b> Problema 9 - P1 Control Otoño 2023</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html"><i class="fa fa-check"></i><b>3</b> Modelos Probabilisticos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-probabilisticos.html"><a href="#introducci%C3%B3n-1"><i class="fa fa-check"></i><b>3.1</b> Introducción</a></li>
<li class="chapter" data-level="3.2" data-path="03-probabilisticos.html"><a href="#metodolog%C3%ADa-1"><i class="fa fa-check"></i><b>3.2</b> Metodología</a></li>
<li class="chapter" data-level="3.3" data-path="03-probabilisticos.html"><a href="#problemas-te%C3%B3ricos-1"><i class="fa fa-check"></i><b>3.3</b> Problemas Teóricos</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e1-tasa-de-respuesta"><i class="fa fa-check"></i><b>3.3.1</b> E1: Tasa de respuesta</a></li>
<li class="chapter" data-level="3.3.2" data-path="03-probabilisticos.html"><a href="#e2-distribuci%C3%B3n-weibull"><i class="fa fa-check"></i><b>3.3.2</b> E2: Distribución Weibull</a></li>
<li class="chapter" data-level="3.3.3" data-path="03-probabilisticos.html"><a href="#e3-distribuci%C3%B3n-gamma-y-heterogeneidad"><i class="fa fa-check"></i><b>3.3.3</b> E3: Distribución Gamma y Heterogeneidad</a></li>
<li class="chapter" data-level="3.3.4" data-path="03-probabilisticos.html"><a href="#e4-modelos-de-duraci%C3%B3n"><i class="fa fa-check"></i><b>3.3.4</b> E4: Modelos de Duración</a></li>
<li class="chapter" data-level="3.3.5" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e5-modelo-nbd"><i class="fa fa-check"></i><b>3.3.5</b> E5: Modelo NBD</a></li>
<li class="chapter" data-level="3.3.6" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#e6-modelos-de-conteo"><i class="fa fa-check"></i><b>3.3.6</b> E6: Modelos de Conteo</a></li>
<li class="chapter" data-level="3.3.7" data-path="03-probabilisticos.html"><a href="#e7-tiempo-discreto-en-modelos-de-duraci%C3%B3n"><i class="fa fa-check"></i><b>3.3.7</b> E7: Tiempo discreto en Modelos de Duración</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problemas-aplicados-1"><i class="fa fa-check"></i><b>3.4</b> Problemas Aplicados</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-1-control-2-2025-2"><i class="fa fa-check"></i><b>3.4.1</b> Problema 1 (Control 2 2025-2)</a></li>
<li class="chapter" data-level="3.4.2" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-2-1"><i class="fa fa-check"></i><b>3.4.2</b> Problema 2</a></li>
<li class="chapter" data-level="3.4.3" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-3-1"><i class="fa fa-check"></i><b>3.4.3</b> Problema 3</a></li>
<li class="chapter" data-level="3.4.4" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-4"><i class="fa fa-check"></i><b>3.4.4</b> Problema 4</a></li>
<li class="chapter" data-level="3.4.5" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-5"><i class="fa fa-check"></i><b>3.4.5</b> Problema 5</a></li>
<li class="chapter" data-level="3.4.6" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-6"><i class="fa fa-check"></i><b>3.4.6</b> Problema 6</a></li>
<li class="chapter" data-level="3.4.7" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-7"><i class="fa fa-check"></i><b>3.4.7</b> Problema 7</a></li>
<li class="chapter" data-level="3.4.8" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-8"><i class="fa fa-check"></i><b>3.4.8</b> Problema 8</a></li>
<li class="chapter" data-level="3.4.9" data-path="modelos-probabilisticos.html"><a href="modelos-probabilisticos.html#problema-9"><i class="fa fa-check"></i><b>3.4.9</b> Problema 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html"><i class="fa fa-check"></i><b>4</b> Modelos Estructurales</a>
<ul>
<li class="chapter" data-level="4.1" data-path="03-probabilisticos.html"><a href="#introducci%C3%B3n-2"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#problemas"><i class="fa fa-check"></i><b>4.2</b> Problemas</a></li>
<li class="chapter" data-level="4.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#soluciones"><i class="fa fa-check"></i><b>4.3</b> Soluciones</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Apunte Problemas Resueltos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-probabilisticos" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítulo 3</span> Modelos Probabilisticos<a href="modelos-probabilisticos.html#modelos-probabilisticos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducción-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introducción<a href="#introducci%C3%B3n-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En este capítulo se abarcarán problemas con un enfoque probabilístico,
esto es, que se asume que los tomadores de decisiones se comportan
aleatoriamente. Esto permite abordar una gran cantidad de problemas
asociados al Marketing, los cuales se pueden caracterizar en tres tipos
de modelos básicos:</p>
<ul>
<li><p><em>Duración</em>: La pregunta clave es ¿Cuándo? Son situaciones ligadas a
la duración de una determinada conducta del cliente, como por
ejemplo: tiempo de permanencia en una compañía, tiempo de adopción
de un cierto producto innovador, entre otros. Puede ser con tiempo
continuo, o discreto.</p></li>
<li><p><em>Conteo</em>: La pregunta clave es ¿Cuántos? Son situaciones ligadas al
estudio de llegadas de clientes y contabilización de una determinada
conducta, como por ejemplo: número de visitas a un portal web y la
cantidad de productos comprados en una tienda de retail.</p></li>
<li><p><em>Elección</em>: La pregunta clave es ¿Cuál? Son situaciones asociadas a
las decisiones de elección de un determinado cliente, como por
ejemplo: clientes que eligen responder (o no) a una campaña
publicitaria y la elección de cambiar (o no) de canal de televisión.</p></li>
</ul>
<p>Cada uno se estos modelos tiene muchas aplicaciones dentro de diversas
situaciones en la vida real. Comportamientos más complejos pueden ser
descritos usando combinaciones de los modelos básicos.</p>
</div>
<div id="metodología-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Metodología<a href="#metodolog%C3%ADa-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dicho enfoque posee una metodología de modelamiento sugerida, que
comparten los modelos vistos a lo largo del curso.</p>
<p>La metodología consiste en:</p>
<ol style="list-style-type: decimal">
<li><p>Determinar el problema de decisión a estudiar y la información
requerida.</p></li>
<li><p>Identificar el comportamiento observable (heterogeneidad) de interés
a nivel individual. Típicamente, se denota con una <span class="math inline">\(x_i\)</span>.</p></li>
<li><p>Seleccionar la distribución de probabilidad que caracterice el
comportamiento individual. Se consideran los parámetros de esta
distribución, como características latentes a nivel individual.
Típicamente, se denota con <span class="math inline">\(f(x|\theta)\)</span>.</p></li>
<li><p>Escoger la distribución que caracterice cómo las características
latentes están distribuidas en la población. Se le llama
distribución mixta o heterogénea. Típicamente, se denota con
<span class="math inline">\(g(\theta)\)</span></p></li>
<li><p>Derivar la distribución agregada, o distribución observable, del
comportamiento de interés.</p>
<p><span class="math display" id="eq:caso-continuo">\[
f(x) = \int f(x|\theta)\, g(\theta)\, d\theta
\quad \tag{3.1}
\]</span></p>
<p><span class="math display" id="eq:caso-discreto">\[
p(x) = \sum_{i} f(x|\theta)\, Pr(\theta = \theta_{i})
\quad \tag{3.2}
\]</span></p></li>
</ol>
<!-- -->
<ol start="6" style="list-style-type: decimal">
<li><p>Estimar los parámetros del modelo (de la distribución mixta),
mediante el ajuste de la distribución agregada a los datos
observados.</p></li>
<li><p>Usar los resultados para tomar una decisión sobre el problema de
marketing en cuestión.</p></li>
</ol>
</div>
<div id="problemas-teóricos-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Problemas Teóricos<a href="#problemas-te%C3%B3ricos-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="e1-tasa-de-respuesta" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> E1: Tasa de respuesta<a href="modelos-probabilisticos.html#e1-tasa-de-respuesta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una compañía de venta de ropa por catálogo busca decidir a que segmento
enviar los catálogos de la próxima colección. Para ello analiza la tasa
de respuesta de una muestra de clientes de cada segmento (esto es el
ratio entre número de clientes que compra y número de catálogos
enviados). Al mirar el primer segmento observa que de los 18 clientes a
quienes se les envió el catálogo, ninguno compró y por tanto decide no
enviar catálogos a ningún cliente de ese segmento. Esta compañía:</p>
<ol style="list-style-type: lower-alpha">
<li>Muy probablemente esté subestimando la tasa de respuesta de ese
segmento.</li>
<li>Debiera redefinir los criterios de segmentación para hacer grupos
más grandes y accionables.</li>
<li>Ha definido una política que da cuenta de su aversión al riesgo.</li>
<li>Debiera usar un modelo de duración en tiempo continuo con
dependencia en la duración.</li>
<li>Debiera incorporar variables explicativas en su modelo predictivo.</li>
</ol>
</div>
<div id="e2-distribución-weibull" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> E2: Distribución Weibull<a href="#e2-distribuci%C3%B3n-weibull" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En relación a la distribución Weibull:</p>
<ol style="list-style-type: lower-alpha">
<li>Es un caso particular de la Poisson.</li>
<li>Es una generalización de la Poisson.</li>
<li>Sólo tiene un parámetro <span class="math inline">\(c\)</span>.</li>
<li>Es muy flexible y permite incluso generar distribuciones bimodales.</li>
<li>Ninguna de las anteriores.</li>
</ol>
</div>
<div id="e3-distribución-gamma-y-heterogeneidad" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> E3: Distribución Gamma y Heterogeneidad<a href="#e3-distribuci%C3%B3n-gamma-y-heterogeneidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>¿Cuál de los siguientes factores motivan la utilización de una
distribución Gamma para modelar la heterogeneidad de las tasas de
adopción en un modelo de duración en tiempo continuo? (Puede elegir más
de un factor).</p>
<ol style="list-style-type: lower-roman">
<li>Consistencia con el dominio de la probabilidad de abandono en cada
período.</li>
<li>Para generar una fórmula recursiva de fácil implementación.</li>
<li>Flexibilidad para acomodar distintas formas de la distribución.</li>
<li>Para generar una fórmula cerrada que pueda ser calculada de manera
computacionalmente eficiente.</li>
</ol>
</div>
<div id="e4-modelos-de-duración" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> E4: Modelos de Duración<a href="#e4-modelos-de-duraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>¿Cuáles de los siguientes modelos NO describe la duración de la relación
de los clientes con una firma?</p>
<ol style="list-style-type: lower-alpha">
<li>Beta-geométrica desplazada.</li>
<li>Beta-geométrica NBD.</li>
<li>Gamma-Weibull.</li>
<li>Binomial Negativa.</li>
<li>Ninguna de las anteriores.</li>
</ol>
</div>
<div id="e5-modelo-nbd" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> E5: Modelo NBD<a href="modelos-probabilisticos.html#e5-modelo-nbd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un modelo NBD describe la demanda de botellas de <em>oporto</em> en los últimos
6 meses. Si con este modelo se estima la demanda del próximo mes:</p>
<ol style="list-style-type: lower-alpha">
<li>Hay que hacer un modelo de regresión que considere la dinámica del
problema.</li>
<li>El cálculo no se puede hacer directamente, sin embargo podemos
recalibrar el modelo considerando un horizonte de un mes.</li>
<li>El histograma del número de botellas consumidas por cliente se
moverá a la izquierda.</li>
<li>La probabilidad de comprar <span class="math inline">\(x\)</span> botellas resulta ser simplemente 1/6
veces las probabilidades calculadas para el primer semestre.</li>
<li>Ninguna de las anteriores.</li>
</ol>
</div>
<div id="e6-modelos-de-conteo" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> E6: Modelos de Conteo<a href="modelos-probabilisticos.html#e6-modelos-de-conteo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un analista propone el uso de modelos de conteo para describir la
intensidad de la participación de los usuarios de la red social <em>X</em>. Los
parámetros que describen el comportamiento de los usuarios han sido
estimados usando datos de 4 días de actividad. El modelo ajusta
extremadamente bien. Sin embargo, al usar las estimaciones para
pronosticar la actividad del quinto día el modelo no ajusta bien. Al
respecto, se debiera concluir que:</p>
<ol style="list-style-type: lower-alpha">
<li>Se debe agregar la data para considerar la actividad agregada en
todo el horizonte.</li>
<li>Probablemente el comportamiento de los usuarios en el quinto día
esté afectado por factores que no están presentes en los primeros
cuatro días.</li>
<li>Hay que calcular esperanzas condicionales.</li>
<li>Los supuestos de comportamiento son errados y hay que desechar el
modelo.</li>
<li>Todas las anteriores.</li>
</ol>
</div>
<div id="e7-tiempo-discreto-en-modelos-de-duración" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> E7: Tiempo discreto en Modelos de Duración<a href="#e7-tiempo-discreto-en-modelos-de-duraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En la práctica, siempre podemos discretizar el tiempo y por lo tanto no
hay motivos para usar modelo de duración en tiempo continuo. Discuta
respecto de la veracidad de esta afirmación.</p>
<ul>
<li>Para eventos con gran variabilidad de tiempos de ocurrencia, un
modelo de tiempo discreto podría requerir un número muy grande de
periodos para describir el apropiadamente comportamiento bajo
estudio.</li>
<li>Si el comportamiento tiene dependencia en la duración, dichas
dependencias son fáciles de incluir en un modelo de tiempo continuo.</li>
</ul>
<p><strong>Solucionario.</strong></p>
<p>E1: a<br />
E2: e<br />
E3: iii, iv<br />
E4: d<br />
E5: c<br />
E6: b</p>
<p><strong>E7: Tiempo discreto en Modelos de Duración</strong></p>
<ul>
<li><p><strong>Correcto.</strong> Esto muestra que en fenómenos con tiempos muy
dispersos, el modelo discreto se vuelve poco práctico, mientras que
el continuo es más parsimonioso.</p></li>
<li><p><strong>Correcto.</strong> En continuo se pueden modelar directamente con
funciones de riesgo (hazard) dependientes del tiempo, lo cual puede
ser más complejo de representar en discreto.</p></li>
</ul>
</div>
</div>
<div id="problemas-aplicados-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Problemas Aplicados<a href="modelos-probabilisticos.html#problemas-aplicados-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problema-1-control-2-2025-2" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Problema 1 (Control 2 2025-2)<a href="modelos-probabilisticos.html#problema-1-control-2-2025-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>VTV es una empresa aseguradora, en la que una de sus principales líneas
de negocio consiste en la provisión de cobertura de segunda línea para
clientes corporativos. En simple, VTV ofrece un seguro de salud que se
gatilla cuando ocurre un gasto médico, pero que se activa después de que
operen las coberturas obligatorias de Fonasa o Isapre. El servicio se
vende a empresas de distintos rubros para que sirvan como beneficio
complementario para sus trabajadores.</p>
<p>Recientemente, VTV ha lanzado un nuevo servicio llamado <em>TuBienestar</em>.
Este servicio ofrece que los empleados de las empresas clientes de VTV
puedan acceder a una batería de exámenes preventivos que aspiran a
detectar tempranamente problemas de consideración y así reducir los
gastos en salud a largo plazo. A continuación, usaremos modelos
probabilísticos para tener una primera aproximación del valor del
programa <em>TuBienestar</em>. Para eso, haremos uso de la base histórica de
gastos que contiene la valorización de todos los eventos de salud,
incluyendo consultas médicas, hospitalizaciones, exámenes y compra de
medicamentos. Aunque existe información más detallada de cada evento,
nos concentraremos en <span class="math inline">\(n_{ijkt}\)</span>, correspondiente al número de eventos
de salud en el periodo t del beneficiario i, que pertenece al grupo j de
la empresa k. Notar que en esta base, los eventos están agrupados por
periodos trimestrales y los beneficiarios de cada empresa están
separados por segmento, ya que distintos tipos de empleados podrían
acceder a distintos beneficios.</p>
<ol style="list-style-type: decimal">
<li>(2.0 puntos) Actualmente, VTV describe el número de eventos de cada
beneficiario usando un modelo de Poisson. En este modelo, como los
eventos de salud no son tan frecuentes, una gran proporción de los
beneficiarios no registra eventos en un trimestre dado y, por tanto,
el caso de cero eventos merece un tratamiento especial. Para modelar
los eventos de gasto, se considera que, si hay un evento, el número
de eventos se distribuye Poisson, pero que la probabilidad de no
observar ningún evento es mayor que la de un modelo de Poisson
tradicional. Escriba la log-verosimilitud de este modelo de conteo
con ceros inflados. <em><strong>Hint:</strong> Le puede resultar útil conceptualizar
el modelo pensando que con probabilidad</em> <span class="math inline">\(\pi\)</span> <em>no hay ningún evento
y que con probabilidad</em> <span class="math inline">\(1-\pi\)</span> <em>el proceso sigue distribución de
Poisson standard.</em></li>
<li>Suponga ahora que, en vez de describir el número de eventos de cada
beneficiario, nos concentramos en el número de beneficiarios que
registra al menos un evento dentro de cada segmento-compañía. Así,
como alternativa al modelo existente, se postula describir la
ocurrencia de eventos de salud como un modelo de elección binaria.
<ol style="list-style-type: lower-alpha">
<li>(1.0 puntos) Suponiendo que puede haber segmentos con mayor
propensión a registrar eventos, escriba la log-verosimilitud de
un modelo binomial con dos clases latentes.</li>
<li>(1.0 puntos) Suponga que ha estimado el modelo y los estimadores
máximos verosímiles vienen dados por
<span class="math inline">\((\theta_1, \theta_2, \pi) = (0.1, 0.6, 0.5)\)</span>. Considere un
segmento con 824 beneficiarios que, transcurrido un trimestre,
evidencia 17 eventos de salud. Escriba una expresión para la
probabilidad que este segmento corresponda a la clase de mayor
propensión a registrar eventos.</li>
</ol></li>
</ol>
<p>Para las descripciones anteriores considere que <span class="math inline">\(n_{jkt}\)</span> es el número
total de beneficiarios que tuvieron algún gasto de salud en el trimestre
t dentro del segmento j de la empresa k y que <span class="math inline">\(m_{jkt}\)</span> es el número
total de beneficiarios dentro de ese segmento, empresa y trimestre.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Como último enfoque, se estiman tres versiones de modelos
beta-binomiales. En los modelos que se incluye heterogeneidad
observable, se consideran variables asociadas tanto a
características del segmento como a variables estacionales y de
tendencia.</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Modelo 1</th>
<th>Modelo 2</th>
<th>Modelo 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>0,127 **</td>
<td>0,151 **</td>
<td>0,149 *</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta\)</span></td>
<td>3,503 ***</td>
<td>3,729 ***</td>
<td>3,852 ***</td>
</tr>
<tr class="odd">
<td>Sector:Minería</td>
<td></td>
<td>1,234 ***</td>
<td>1,108 ***</td>
</tr>
<tr class="even">
<td>Sector:Construcción</td>
<td></td>
<td>2,122 ***</td>
<td>1,432 **</td>
</tr>
<tr class="odd">
<td>Sector:Salud</td>
<td></td>
<td>1,784 ***</td>
<td>1,665 ***</td>
</tr>
<tr class="even">
<td>Tamaño-Mediana</td>
<td></td>
<td>0,145</td>
<td>-0,004</td>
</tr>
<tr class="odd">
<td>Tamaño-Grande</td>
<td></td>
<td>0,372 *</td>
<td>0,401 *</td>
</tr>
<tr class="even">
<td>AntiguedadContrato</td>
<td></td>
<td>0,188 **</td>
<td>0,193 **</td>
</tr>
<tr class="odd">
<td>TuBienestar</td>
<td></td>
<td></td>
<td>-0,089 **</td>
</tr>
<tr class="even">
<td>Invierno</td>
<td></td>
<td>2,921 ***</td>
<td>2,955 ***</td>
</tr>
<tr class="odd">
<td>Verano</td>
<td></td>
<td>-0,539 *</td>
<td>-0,564 *</td>
</tr>
<tr class="even">
<td>Tendencia</td>
<td></td>
<td>0,278 **</td>
<td>0,305 **</td>
</tr>
<tr class="odd">
<td><strong>N. Obs</strong></td>
<td>34.825</td>
<td>34.825</td>
<td>34.825</td>
</tr>
<tr class="even">
<td><strong>LL</strong></td>
<td>-51.771,8</td>
<td>-45.282,1</td>
<td>-41.321,9</td>
</tr>
<tr class="odd">
<td><strong>AIC</strong></td>
<td>107.543,6</td>
<td>90.580,2</td>
<td>82.665,8</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\text{Tabla 1. Estimadores máximo verosímiles de dos modelos beta-binomiales con variables explicativas.}\)</span></p>
<ol style="list-style-type: lower-alpha">
<li>(1.0 puntos) Discuta si el programa <em>TuBienestar</em> ayuda a
describir el comportamiento de los beneficiarios y si el
programa <em>TuBienestar</em> es bueno para la salud de los
beneficiarios.</li>
<li>(1.0 puntos) En otros mercados el valor esperado de la
probabilidad que un beneficiario exhiba un evento de salud en un
trimestre dado es 0.16. ¿Cómo testearía si los datos de Chile
son distintos a ese valor medio internacional?</li>
</ol></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Siguiendo la indicación, la probabilidad de los eventos viene dada
por:</p>
<p><span class="math display">\[
\Pr(N_{ijkt} = n \mid \lambda, \pi) =
\begin{cases}
\pi + (1 - \pi)e^{-\lambda} &amp; n = 0 \\
(1 - \pi) \dfrac{e^{-\lambda}\lambda^n}{n!} &amp; n &gt; 0
\end{cases}
\]</span></p>
<p>Entonces, la función log-verosimilitud viene dada por:</p>
<p><span class="math display">\[
LL = \sum_{i} \sum_{j} \sum_{k} \sum_{t}
\left[
    1_{n_{ijkt}=0} \ln\left( \pi + (1 - \pi)e^{-\lambda} \right) +
    1_{n_{ijkt}&gt;0} \ln\left( (1 - \pi) \dfrac{e^{-\lambda}\lambda^n}{n!} \right)
\right]
\]</span></p></li>
<li><p>Sean <span class="math inline">\(\theta_1\)</span> y <span class="math inline">\(\theta_2\)</span> las probabilidades de registrar un
evento de las clases 1 y 2 respectivamente.</p>
<ol style="list-style-type: lower-alpha">
<li><p>La probabilidad de observar exactamente <span class="math inline">\(n\)</span> eventos en el
segmento de clientes <span class="math inline">\(j\)</span> de la empresa <span class="math inline">\(k\)</span> en el trimestre <span class="math inline">\(t\)</span>
viene dada por:</p>
<p><span class="math display">\[ \Pr(n_{jkt} = n \mid \theta_1, \theta_2, \pi) = \pi \binom{m}{n_{jkt}} \theta_1^{n_{jkt}} (1 - \theta_1)^{m - n_{jkt}} + (1 - \pi) \binom{m}{n_{jkt}} \theta_2^{n_{jkt}} (1 - \theta_2)^{m - n_{jkt}} \]</span>Entonces,
la log-verosimilitud viene dada por:
<span class="math display">\[ LL \;=\; \sum_{j}\sum_{k}\sum_{t} \ln\!\Big( \Pr(n_{jkt} \mid \theta_1,\theta_2,\pi) \Big) \]</span></p></li>
<li><p>Aplicamos la fórmula de bayes directamente:
<span class="math display">\[ \Pr(\lambda=\lambda_2 \mid n_{jkt}=17) = \frac{\Pr(n_{jkt}=17 \mid \lambda=\lambda_2)\,\Pr(\lambda=\lambda_2)} {\Pr(n_{jkt}=17 \mid \lambda=\lambda_1)\,\Pr(\lambda=\lambda_1) + \Pr(n_{jkt}=17 \mid \lambda=\lambda_2)\,\Pr(\lambda=\lambda_2)}. \]</span>
Donde:
<span class="math display">\[ \Pr(n_{jkt}=17 \mid \lambda=\lambda_1) = \binom{824}{17}\,(0.1)^{17}\,(1-0.1)^{824-17}, \]</span>
<span class="math display">\[ \Pr(n_{jkt}=17 \mid \lambda=\lambda_2) = \binom{824}{17}\,(0.6)^{17}\,(1-0.6)^{824-17}, \]</span>
<span class="math display">\[ \Pr(\lambda=\lambda_1)=\Pr(\lambda=\lambda_2)=\tfrac{1}{2}. \]</span></p></li>
</ol></li>
<li><p>La parte a) requiere mirar los resultados de la tabla. La parte b)
puede contestarse independientemente.</p>
<ol style="list-style-type: lower-alpha">
<li><p>El AIC del modelo 2 es mayor que el AIC del modelo 3 que solo
agrega la variable tuBienestar, y por tanto, la variable tiene
valor explicativo. Se puede argumentar también que el
coeficiente mismo de la variable es significativo y por tanto
ayuda a explicar.</p>
<p>Respecto al impacto en la salud, como el coeficiente es
significativo y negativo, diríamos que aquellos que participan
del programa tienen una menor probabilidad de generar eventos y,
por tanto, el programa sería beneficioso. Sería deseable
discutir que este efecto no es necesariamente causal, pero no lo
consideraremos necesario.</p></li>
<li><p>Recordar que la esperanza de una <span class="math inline">\(Beta(\alpha,\beta)\)</span> viene dada
por <span class="math inline">\(\frac{\alpha}{\alpha+\beta}\)</span>. Por lo tanto, lo que
necesitamos testear es que <span class="math inline">\(\alpha=0.16(\alpha+\beta)\)</span>, que es
una restricción lineal que puede testearse usando un test de
ratios de verosimilitud.</p></li>
</ol></li>
</ol>
</div>
<div id="problema-2-1" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Problema 2<a href="modelos-probabilisticos.html#problema-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el contexto del marketing B2B (Business to Business) para servicios
profesionales, las empresas han comenzado a incorporar el marketing de
contenidos (Content Marketing, CM) como parte integral de sus
estrategias comerciales. Estas iniciativas buscan, principalmente,
generar oportunidades de venta (leads) y fidelizar clientes existentes,
mediante la entrega de información de valor. El marketing de contenidos
puede adoptar múltiples formas, tanto en entornos presenciales como
digitales. Las actividades presenciales incluyen eventos cara a cara,
como seminarios, conferencias o talleres; mientras que las digitales
abarcan webinars, seminarios virtuales y la distribución de contenido a
através de plataformas digitales, como los sitios web corporativos.</p>
<p>En los mercados B2B, donde un número reducido de cuentas clave suele
concentrar una parte importante de las ventas, la gestión del marketing
de contenidos debe articularse cuidadosamente con los procesos
tradicionales de vents. Es habitual que estas organizaciones estructuren
el proceso de ventas en dos grandes etapas: generación de leads y
conversión de leads. Un lead representa una oportunidad de negocio que
se manifiesta a través de señales tempranas de interés por parte de una
cuenta clave, como una consulta por correo electrónico, una llamada
comercial, la solicitud de una cotización o la descarga de un folleto
técnico. Un lead se considera convertido cuando se concreta la venta y
se formalizan los compromisos de pago.</p>
<p>Un desafío relevante para la gestión analítica del marketing de
contenidos consiste en identificar qué tipos de actividaeds
-presenciales o digitales- generan un mayor número de leads, cuáles de
ellas contribuyen de forma más efectiva a su conversión. Asimismo, se
plantea la hipótesis de que el nivel de particiapción (engagement) de
los empleados de las cuentas clave podría desempeñar un rol mediador en
estos procesos.</p>
<p>En este contexto, Vectorix, una empresa B2B que ofrece servicios
profesionales, busca comprender cuáles componentes de su estrategia de
marketing de contenidos resultan más efectivos. La empresa sospecha que
la participación digital (por ejemplo, en webinars o mediante el consumo
de contenido online) tiene un impacto positivo en la generación y
conversión de leads. Sin embargo, la efectividad relavita de las
actividades presenciales frente a las digitales sigue siendo una
incógnita.</p>
<p>Con base a sus registros históricos de actividades de marketing y
resultados comerciales, Vectorix se propone desarrollar un análisis
cuantitativo que le permita evaluar la efectividad comparada de las
distintas acciones de marketing de contenido. El objetivo final es
orientar la asignación presupuestaria para los próximos dos trimestres,
priorizando aquellas tácticas que maximicen tanto la generación como la
conversión de oportunidades comerciales.</p>
<p>Los registros históricos se han condesando en una única base de datos
que contiene las siguientes columnas:</p>
<ul>
<li><p>Idaccount: identificador de la cuenta clave.</p></li>
<li><p>Zone: área geográfica en que se encuentra la sede central de la
cuenta clave.</p></li>
<li><p>Industry: industria a la que pertenece la cuenta.</p></li>
<li><p>Tenure: Número de años transcurridos desde que la empresa comenzó su
relación con la cuenta.</p></li>
<li><p>Year: año fiscal.</p></li>
<li><p>Leads: Número de oportunidades generadas por la cuenta durante el
año fiscal correspondiente.</p></li>
<li><p>ConvertedLeads: Número de oportunidades cerradas para la cuenta
durante el año fiscal correspondiente.</p></li>
<li><p>NEventOffline: Número de eventos presenciales en los que partició la
cuenta clave durante el año fiscal.</p></li>
<li><p>NeventOnline: Número de eventos digitales en los que partició la
cuenta clave durante el año fiscal.</p></li>
<li><p>NEmployeeAccess: Número de empleados de la cuenta que ha tenido al
menos algún acceso o consumo de contenido digital durante el año
fiscal.</p></li>
<li><p>NAccessMean: Número promedio de accesos y consumos de contenido
digital para los empleados de la cuenta que interactúan durante el
año fiscal.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Proponga un modelo de conteo (debe definir la variable dependiente
utilizando la base de datos disponible, junto a sus índices) para
describir el número de oportunidades ganadas mediante un modelo que
integre heterogeneidad observable. Escriba la log-verosimilitud del
modelo anterior y especifique cuántos parámetros deben estimarse. Si
necesita, suponga conocida la cardinalidad de todos los índices del
modelo y que hay un año de desfase, por lo que debe considerar el
<span class="math inline">\(t\)</span> anterior. Para la construcción del modelo considere:</p>
<ol style="list-style-type: lower-alpha">
<li>La industria y la zona a la que pertenecen cada cuenta incide en
la posibilidad de generar y convertir más o menos oportunidades.</li>
<li>El tiempo de relación afecta las oportunidades ganadas. El
primer año de relación, en general, hay un numero grande de
oportunidades, el que cae marcadamente el segundo año para
repuntar y mantenerse relativamente estable a partir del tercer
año.</li>
<li>Se espera que la participación en eventos presenciales y
digitales tienen un efecto en conversión de oportunidades, pero
se hipotetiza que estos dos canales son sustitutos entre sí.
Considere que los datos tienen un año de desfase, por lo que
debe considerar el período anterior.</li>
<li>El número total de interacciones de los empleados debiera
aumentar las oportunidades convertidas, pero el efecto adicional
de cada nueva interacción tiende a ser menor a medida que el
número de interacción crece.</li>
<li>Los procesos de conversión son relativamente lentos, por lo que
las oportunidades convertidas dependen principalmente de la
actividad del año anterior y no del año en curso. Considere que
los datos tienen un año de desfase, por lo que debe considerar
el período anterior.</li>
</ol></li>
<li><p>Usando los mismos supuestos del modelo anterior, construya un modelo
de elección binaria con heterogeneidad observable para describir el
número de oportunidades ganadas. Escriba la log-verosimilitud y
especifique cuántos parámetros más deben estimarse con respecto al
modelo anterior. ¿Qué ventajas puede tener un modelo de elección
binario por sobre no de conteo (aplicado a este problema)?
<em><strong>Hint:</strong> Si le resulta conveniente en su notación, puede asumir
que la tasa del modelo de conteo que captura todas las componentes
relevantes del problema se denota</em> <span class="math inline">\(\lambda_{it}(x_{it})\)</span><em>, con</em>
<span class="math inline">\(x_{it}\)</span> <em>un conjunto de variables observables de la cuenta</em> <span class="math inline">\(i\)</span> <em>en
el año</em> <span class="math inline">\(t\)</span><em>.</em></p></li>
<li><p>Considerando que, quizás, la heterogeneidad observable no es
suficiente para capturar toda la variabilidad del fenómeno, se
consideró extender el modelo para incluir heterogeneidad no
observable. Aunque en este nuevo modelo el conjunto de variables
explicativas es algo distinto al del modelo sin heterogeneidad no
observable, el ajuste en términos de la log-verosimilitud es
bastante mejor, como indica la <a href="#tbl:loglike"><strong>??</strong></a>.</p>
<table>
<caption>Log-verosimilitud modelos alternativos. {#tbl:loglik}</caption>
<thead>
<tr class="header">
<th>Modelo</th>
<th>Log-Likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regresión Binomial</td>
<td>-10.145,0</td>
</tr>
<tr class="even">
<td>Regresión Beta-Binomial</td>
<td>-9.855,4</td>
</tr>
</tbody>
</table>
<p>En relación al modelo binomial, ¿cuántos parámetros debiera tener el
modelo de regresión beta-binomial para que sea preferido en términos
de AIC?</p></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>De acuerdo a las solicitudes:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Necesitamos incluir dummies para zonas (<span class="math inline">\(\text{Zone}_{ih_1}\)</span>) y
para industrias (<span class="math inline">\(\text{Industry}_{ih_2}\)</span>), donde <span class="math inline">\(h_1\)</span>
corresponde a una zona existente de la base de datos, al igual
que <span class="math inline">\(h_2\)</span>, que corresponde a una industria existente.</p></li>
<li><p>Se pueden generar dos variables para los niveles de antigüedad
(porque una de las tres debe ser la de referencia). Se genera
<span class="math inline">\(\text{Tenure2_{it}}\)</span>, que es equivalente a
<span class="math inline">\(\text{Tenure}_{it}\mathbf{1}\begin{cases} 1 &amp; \text{si } t = 2 \\ 0 &amp; \text{en otro caso} \end{cases}\)</span>
y <span class="math inline">\(\text{Tenure3}_{it}\)</span>, equivalente a
<span class="math inline">\(\text{Tenure}_{it}\mathbf{1}\begin{cases} 1 &amp; \text{si } t \geq 3 \\ 0 &amp; \text{en otro caso} \end{cases}\)</span>.</p></li>
<li><p>Hay que incluir el número de eventos físicos, digitales y su
interacción.</p></li>
<li><p>El número total de interacciones es la multiplicación del número
de empleados por el promedio de interacciones por usuario. Dado
los rendimientos decrecientes, se debe transformar la variable a
logaritmo.</p>
<p><span class="math display">\[
\begin{aligned}
\lambda_{it} &amp;= \big(\sum_{h_1} \alpha_{h_1} \text{Zone}_{ih_1}\big) + \big(\sum_{h_2} \alpha_{h_2} \text{Industry}_{ih_2}\big) + \beta_1 Tenure2_{it} + \beta_2 Tenure3_{it} \\
&amp;+ \beta_3 NEventOnline_{it-1} + \beta_4 NEventOffline_{it-1} \\
&amp;+ \beta_5 NEventOnline_{it-1} NEventOffline_{it-1} \\
&amp;+ \beta_6 ln\big(NEmployeeAccess_{it-1} NAccessMean_{it-1}\big)
\end{aligned}
\]</span></p>
<p>Este modelo tiene <span class="math inline">\(Z+I+6\)</span> parámetros a estimar, donde
<span class="math inline">\(Z = \sum_{h_1}\)</span> e <span class="math inline">\(I = \sum_{h_2}\)</span>.</p>
<p>La log-verosimilitud resulta de aplicar una distribución de
Poisson:</p>
<p><span class="math display">\[
LL = \sum_{i}\sum_{t} n_{it} \ln\left(\frac{(\lambda_{it}t)^{x_{it}}e^{\lambda_{it}t}}{x_{it}!}\right)
\]</span></p>
<p>Donde <span class="math inline">\(x_{it}\)</span> es el número de oportunidades convertidas por la
cuenta <span class="math inline">\(i\)</span> en el año <span class="math inline">\(t\)</span> y <span class="math inline">\(n_{it}\)</span> es el número de individuos
que tuvieron esas <span class="math inline">\(x_{it}\)</span> oportunidades convertidas. Acá la
heterogeneidad observada fue incluida en la regresión de Poisson
descrita.</p></li>
</ol></li>
<li><p>El modelo es idéntico al anterior, pero en vez de describir la
verosimilitud como un modelo de Poisson, ahora es un modelo
binomial. Entonces:</p>
<p><span class="math display">\[
LL = \sum_{i}\sum_{t} {m_{it} \choose n_{it}} p_{it}^{n_{it}}(1-p_{it})^{m_{it}-n_{it}}
\]</span></p>
<p>Aquí, <span class="math inline">\(m_{it}\)</span> es el número de <em>leads</em> generados por la cuenta en el
año y la probabilidad de conversión heterogenea viene dada por</p>
<p><span class="math display">\[
p_{it} = \frac{e^{\lambda_{it}(x_{it})}}{1+e^{\lambda_{it}(x_{it})}}
\]</span></p>
<p>El cual tiene el mismo número de parámetros que el caso anterior.</p></li>
<li><p>Para preferir el modelo beta binomial, el AIC debiera ser menor que
el de la regresión binomial. Entonces:</p>
<p><span class="math display">\[
(AIC_B = 2k_B - 2LL_B) &gt; (2k_{BB} - 2LL_{BB} = AIC_{BB})
\]</span></p>
<p>Despejando y reemplazando los valores, <span class="math inline">\(k_{BB} - k_{B} &lt; 290\)</span> (es
decir, el modelo de regresión beta-binomial podría tener hasta 290
parámetros más y seguiría siendo más preferido que el modelo de
regresión de Poisson.</p></li>
</ol>
</div>
<div id="problema-3-1" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Problema 3<a href="modelos-probabilisticos.html#problema-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Harcor es una importante firma latinoamericana que se concentra en la
producción y venta de caramelos y snacks. Aunque la compañía tiene una
estrategia multicanal, gran parte de sus ventas se concentra en el canal
tradicional de almacenes y kioscos. Este segmento es muy atomizado con
decenas de puntos de venta en el país y con una gran heterogeneidad
entre los almaceneros. Mientras algunos almacenes tienen un desarrollo
bien establecido con tiendas bien organizadas y sistemas automáticos de
registros de venta, otros operan en espacios informales y con malas
prácticas de gestión.</p>
<p>Para incentivar las ventas en el canal tradicional, Harcor ha creado un
programa de capacitación que ha denominado <em>El Club del Almacenero</em>, que
junto con proveer soporte en infraestructura de góndolas y estanterías
con las marcas de Harcor, ofrece también un plan de capacitación con las
mejores prácticas del comercio minorista, incluyendo temas de
publicidad, administración de inventarios, control de costos y
planificación de surtido. El plan de capacitación está inicialmente
pensado en 4 niveles de módulos, desde el más básico hasta al más
avanzado, de modo que para acceder a un nivel debe haberse completado el
nivel anterior.</p>
<p>Aunque el nivel de satisfacción de los participantes del programa de
capacitación es alto, el porcentaje de almaceneros que participa y
completa el programa ha sido más bien bajo en los primeros dos años de
operación por lo que Harcor está considerando hacer algunos ajustes al
programa. Para que los ajustes sean realizados basados en evidencia, el
equipo de analítica comercial se ha propuesto analizar los datos de
participación en las ediciones pasadas del programa. Para eso, a partir
de los registros históricos se ha generado una tabla, que, junto con un
conjunto de variables demográficas de los almaceneros, se registra
<span class="math inline">\(x_{ikt}\)</span> que toma el valor 1 si el almacenero <span class="math inline">\(i\)</span> participó en el nivel
<span class="math inline">\(k\)</span> en el programa de capacitación realizado en el año <span class="math inline">\(t\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Suponga que el número de niveles de los cuales participa un
almacenero queda descrito por un modelo beta geométrico desplazado
de parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</p>
<ol style="list-style-type: decimal">
<li>(1 punto) Calcule una expresión para la probabilidad que un
almacenero termine el programa de capacitación. Notar que la
expresión debe poder calcularse a partir de los datos observados
<span class="math inline">\(x_{ikt}\)</span> y los parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</li>
<li>(1 punto) Escriba la log-verosimilitud del problema. Al igual
que en el caso anterior, exprese la log-verosimilitud en
términos de <span class="math inline">\(x_{ikt}\)</span>, <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</li>
</ol></li>
<li><p>Suponga que se estima el modelo usando el método de la máxima
verosimilitud resultando los valores de la Tabla:</p>
<table>
<caption><span class="math display">\[
\textbf{Tabla: } \text{Resumen de ventas para cada función.}
\]</span></caption>
<thead>
<tr class="header">
<th align="right">Variable</th>
<th align="right">Coeficiente</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.999</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\beta\)</span></td>
<td align="right">4.001</td>
</tr>
<tr class="odd">
<td align="right">N</td>
<td align="right">1,245</td>
</tr>
<tr class="even">
<td align="right">LL</td>
<td align="right">-2.583</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>La Figura reporta la distribución beta evaluada en los
estimadores máximos verosímiles de la Tabla. Por inspección de
la figura, provea una aproximación numérica a la probabilidad de
que un cliente no avance al siguiente nivel sea mayor que 0.8
(usando áreas de triángulos y rectángulos).</p>
<div class="float">
<img src="images/fig_beta_posterior_v2.png" style="width:60.0%" fig-align="center" alt="\textbf{Figura: } \text{Distribución posterior de la probabilidad de no continuar}" />
<div class="figcaption"><span class="math display">\[\textbf{Figura: } \text{Distribución posterior de la probabilidad de no continuar}\]</span></div>
</div></li>
<li><p>Calcule el intervalo de confianza al 95% del segundo parámetro
<span class="math inline">\(\beta\)</span>. Considere que el inverso del hessiano de la
log-verosimilitud, evaluada en el estimador máximo verosímil,
viene dado por <span class="math inline">\(\Sigma^{-1}\)</span>:</p>
<p><span class="math display">\[
\Sigma^{-1} \;=\;
\begin{bmatrix}
0.16 &amp; 0.04 \\
0.04 &amp; 0.36
\end{bmatrix}.
\]</span></p></li>
</ol></li>
<li><p>Suponga ahora que se rediseña el programa de modo que los contenidos
de un módulo son independientes de los otros y, por tanto, un
almacenero puede atender cualquier módulo sin necesidad de haber
completado los anteriores. Suponga que ya se han desarrollado tres
módulos y falta uno por realizar. Escriba la verosimilitud de
observar que un almacenero atiende a los tres módulos y otro atiende
solo a uno, suponiendo que la asistencia se describe por un modelo
beta-binomial.</p></li>
<li><p>Si los estimadores máximos verosímiles de la beta binomial son
<span class="math inline">\(\alpha = 3.543\)</span> y <span class="math inline">\(\beta = 1.231\)</span>, escriba una expresión para el
valor esperado de la probabilidad que un almacenero atienda al
último módulo, si ya atendió a los tres primeros.</p></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Sea <span class="math inline">\(D_{it}\)</span> el número de niveles cursado por el almacenero <span class="math inline">\(i\)</span> en
el año de ejecución <span class="math inline">\(t\)</span> y sea <span class="math inline">\(s_{ikt}\)</span> una variable binaria que
toma el valor 1 si el almacenero cumple el curso
<span class="math inline">\(\,s_{ikt}=\begin{cases} \mathbb{1} &amp; \text{si} \, \sum_h x_{iht} = 4 \\ 0 &amp; \text{en otro caso} \end{cases}\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>La expresión es directa: <span class="math display">\[
\Pr(D_{it}=k\mid \alpha,\beta)=\frac{B(\alpha+1,\ \beta+k-1)}{B(\alpha,\beta)}
\]</span></p></li>
<li><p>Usando las definiciones de arriba, la log-verosimilitud: <span class="math display">\[
LL=\sum_{t}\sum_{i}\sum_{k} s_{ikt}\,\log\!\Big(\mathbb{P}(D_{it}=4\mid \alpha,\beta)\Big)
=\sum_{t}\sum_{i}\sum_{k} s_{ikt}\,\log\!\left(\frac{B(\alpha+1,\ \beta+k-1)}{B(\alpha,\beta)}\right)
\]</span></p>
<p>O bien, se puede absorber la suma para cada individuo <span class="math inline">\(i\)</span> si
<span class="math inline">\(n_{kt}=\sum_i s_{ikt}\)</span>, correspondiente al número de
almaceneros que cursaron <span class="math inline">\(k\)</span> niveles. En dicho caso: <span class="math display">\[
LL=\sum_{t}\sum_{k} n_{kt}\,\log\!\Big(\mathbb{P}(D_{it}=k\mid \alpha,\beta)\Big)
=\sum_{t}\sum_{k} n_{kt}\,\log\!\left(\frac{B(\alpha+1,\ \beta+k-1)}{B(\alpha,\beta)}\right)
\]</span></p></li>
</ol></li>
<li><p>Para el primer caso:</p>
<ol style="list-style-type: lower-alpha">
<li><p>La probabilidad <span class="math inline">\(p\)</span> corresponde al área bajo la curva, que puede
aproximarse como<br />
<span class="math display">\[
p \approx 0.2\cdot 2 + 0.2\cdot 2/2 = 0.6.
\]</span></p>
<div class="float">
<img src="images/fig_beta_posterior_shaded_08_1.png" style="width:60.0%" fig-align="center" alt="\text{Figura: Distribución posterior con área sombreada}" />
<div class="figcaption"><span class="math display">\[\text{Figura: Distribución posterior con área sombreada}\]</span></div>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Usando el inverso del hessiano, el ientervalo de confianza
viene dado por <span class="math inline">\(4.001 \pm 1.96 \sqrt{0.36}\)</span>, donde el
coeficiente <span class="math inline">\(\beta\)</span> corresponde la componente
<span class="math inline">\(\Sigma_{22}^{-1}\)</span>.</li>
</ol></li>
</ol></li>
<li><p>Solo tenemos que multiplicar la probabilidad de los dos eventos:</p>
<p><span class="math display">\[
\begin{aligned}
L(\theta) &amp;= \mathbb{P}(D_{it} = 3 \mid \alpha, \beta) \mathbb{P}(D_{it} = 3 \mid \alpha, \beta) \\
&amp;= {3 \choose 3} \frac{\mathbb{B}(\alpha + 3, \beta)}{\mathbb{B}(\alpha, \beta)} \, {3 \choose 1} \frac{\mathbb{B}(\alpha + 1, \beta + 2)}{\mathbb{B}(\alpha, \beta)}
\end{aligned}
\]</span></p></li>
<li><p>La probabilidad solicitada es simplemente la esperanza condicional
del parámetro. En este caso, la distribución condicional de observar
tres visitas positivas en tres módulos es
<span class="math inline">\(\mathbb{B}(\alpha + 3, \beta)\)</span>. La esperanza condicional de la
probabilidad viene dada por</p>
<p><span class="math display">\[\frac{\alpha + 3}{\alpha + \beta + 3} = 0.842\]</span></p></li>
</ol>
</div>
<div id="problema-4" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Problema 4<a href="modelos-probabilisticos.html#problema-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En 1972, la <em>National Association of Food Chains</em> (NAFC) impulsó el uso
de códigos de barras para administrar los precios en las góndolas de los
supermercados en Estados Unidos. Desde aquel entonces, ha existido una
continua preocupación respecto a la precisión de estos mecanismos para
mantener información precisa respecto de los precios. Uno de los
problemas potenciales más relevantes del sistema es que los precios
cargados en el sistema podrían no estar bien coordinados con la
información de precios desplegada a los clientes en los flejes de las
góndolas. En simple, como la información de precios se realiza
manualmente, es posible que se generen diferencias entre lo que se
despliega de cara al cliente al momento de la elección, con lo que
efectivamente se cobra en caja.</p>
<p>Motivados por este problema, se ha decidido investigar la situación
actual de la precisión con que se despliegan los precios en la industria
supermercadista chilena. Más allá de la existencia de discrepancias, nos
interesa investigar la duración de estos eventos en que el precio
informado difiere del precio efectivamente cobrado. Para investigar
estas preguntas, se ha construido una base de datos que contiene
alrededor de 75.000 observaciones de precios realizadas durante 28 días
en una sala de supermercado de la Región Metropolitana, que considera
tanto el precio registrado en el sistema de cajas como el precio
exhibido en góndola. Mientras que los precios de cajas se obtienen
directamente de los sistemas transaccionales de la compañía, los precios
en góndola resultan de una inspección visual en sala, por un equipo de
revisores entrenados para ese propósito. La medición visual se hace
sobre una lista predefinida de productos sobre los que se registra el
precio exhibido.</p>
<p>Habiendo realizado la medición, se identifica que más de un 10% de los
precios registrados tiene asociada alguna discrepancia, es decir, que el
precio cobrado en caja no coincide con el precio exhibido en el fleje de
la góndola. Notar que las discrepancias pueden ser favorables para el
cliente o favorables para el supermercado. Por convención, llamaremos
discrepancias de tipo I a aquellas que favorecen al cliente y de tipo II
a las que favorecen al supermercado. Para entender con más detalle este
fenómeno de discrepancias, se ha seleccionado una base con todos los
registros con precios discrepantes. En esta base, cada fila se compone
de las siguientes variables:</p>
<ul>
<li><strong>Id</strong>: Identificador de un evento de discrepancia de precios.</li>
<li><strong>Day</strong>: Día de la semana que se registra la discrepancia (con lunes
= 1 y domingo = 7).</li>
<li><strong>Type</strong>: Variable categórica con el tipo de discrepancia (Tipo I o
Tipo II).</li>
<li><strong>Section</strong>: Categoría del supermercado a la que pertenece el
producto que presenta un diferencial (Abarrotes, Limpieza, Bebidas,
Galletas y Cocktail).</li>
<li><strong>Duration</strong>: Número de días que dura la discrepancia de precios
entre el fleje y el sistema transaccional.</li>
<li><strong>Tag_price</strong>: Precio que aparece en el fleje.</li>
<li><strong>Real_price</strong>: Precio cobrado en caja.</li>
<li><strong>diff</strong>: Diferencia entre precio fleje y precio real.</li>
</ul>
<p>Para ilustrar la estructura de la base, las primeras entradas se
presentan en la Tabla 1:</p>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="16%" />
<col width="14%" />
<col width="16%" />
<col width="17%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="right">Day</th>
<th align="center">Type</th>
<th align="left">Section</th>
<th align="right">Duration</th>
<th align="right">Tag_price</th>
<th align="right">Real_price</th>
<th align="right">diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="center">I</td>
<td align="left">limpieza</td>
<td align="right">1</td>
<td align="right">1668</td>
<td align="right">1467</td>
<td align="right">201</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="center">II</td>
<td align="left">abarrotes</td>
<td align="right">7</td>
<td align="right">1162</td>
<td align="right">9183</td>
<td align="right">-8021</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="center">I</td>
<td align="left">bebidas</td>
<td align="right">1</td>
<td align="right">7517</td>
<td align="right">6616</td>
<td align="right">901</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="center">I</td>
<td align="left">bebidas</td>
<td align="right">1</td>
<td align="right">1319</td>
<td align="right">1160</td>
<td align="right">158</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="center">I</td>
<td align="left">galletas</td>
<td align="right">3</td>
<td align="right">1411</td>
<td align="right">1241</td>
<td align="right">169</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">3</td>
<td align="center">II</td>
<td align="left">galletas</td>
<td align="right">2</td>
<td align="right">1411</td>
<td align="right">1641</td>
<td align="right">-231</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla: Muestra de los primeros 6 registros de la base de discrepancias} \]</span></p>
<ol style="list-style-type: decimal">
<li><p>Describa un modelo de duración probabilístico que permita describir
cuántos días se mantienen las discrepancias y escriba la
log-verosimilitud correspondiente. Defina cuidadosamente las
variables de la función, especificando qué es parámetro y qué es
dato. Para los datos, indique cómo se obtienen de los datos
ilustrados en la Tabla 1.</p></li>
<li><p>Suponga que complementario a los modelos de duración, se estiman dos
modelos de regresión lineal para describir la duración de las
discrepancias como variable dependiente. Los resultados de estos dos
modelos se reportan en la Tabla 2.</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="right">Coef. M1</th>
<th align="center">p-valor M1</th>
<th align="right">Coef. M2</th>
<th align="center">p-valor M2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intercepto</td>
<td align="right">3.55</td>
<td align="center">0.0901</td>
<td align="right">-1.353</td>
<td align="center">0.1607</td>
</tr>
<tr class="even">
<td align="left">diff</td>
<td align="right">-0.0002</td>
<td align="center">0.7830</td>
<td align="right">–</td>
<td align="center">–</td>
</tr>
<tr class="odd">
<td align="left">log(Tag_price)</td>
<td align="right">-0.2688</td>
<td align="center">0.3661</td>
<td align="right">–</td>
<td align="center">–</td>
</tr>
<tr class="even">
<td align="left">log(diff)</td>
<td align="right">–</td>
<td align="center">–</td>
<td align="right">0.563</td>
<td align="center">0.0019</td>
</tr>
<tr class="odd">
<td align="left">type.I</td>
<td align="right">1.51</td>
<td align="center">0.0210</td>
<td align="right">2.168</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="left">type.I:diff</td>
<td align="right">0.0046</td>
<td align="center">0.1165</td>
<td align="right">–</td>
<td align="center">–</td>
</tr>
<tr class="odd">
<td align="left">day.1</td>
<td align="right">–</td>
<td align="center">–</td>
<td align="right">-1.013</td>
<td align="center">0.0061</td>
</tr>
<tr class="even">
<td align="left">section.limpieza</td>
<td align="right">–</td>
<td align="center">–</td>
<td align="right">4.394</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="left">section.cocktail</td>
<td align="right">–</td>
<td align="center">–</td>
<td align="right">-1.329</td>
<td align="center">0.0221</td>
</tr>
<tr class="even">
<td align="left"><strong>R²</strong></td>
<td align="right"><strong>0.096</strong></td>
<td align="center"></td>
<td align="right"><strong>0.136</strong></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left"><strong>Adj. R²</strong></td>
<td align="right"><strong>0.086</strong></td>
<td align="center"></td>
<td align="right"><strong>0.120</strong></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla: Resultados de dos modelos de regresión lineal para la duración de la discrepancia.} \]</span></p>
<p>Más allá de la varianza explicada por cada modelo, ¿qué modelo le
parece más adecuado? Provea al menos dos razones por las cuales
prefiere el modelo elegido.</p></li>
<li><p>Suponga que ahora se estiman tres modelos para describir la duración
de discrepancias tipo I (aquellas que favorecen al cliente): un
modelo geométrico desplazado sin heterogeneidad, un modelo
beta-geométrico desplazado y un modelo de regresión geométrico
desplazado en que el parámetro del modelo se asume dependiendo de la
magnitud de la discrepancia (<span class="math inline">\(\text{Diff}\)</span>) y si corresponde a la
categoría de limpieza. Para garantizar que el parámetro <span class="math inline">\(\theta\)</span>
esté en el rango <span class="math inline">\([0,1]\)</span> para incluir variables explicativas se
aplica la transformación <span class="math display">\[
\theta_i \;=\; \frac{\exp(\beta\cdot x_i)}{1+\exp(\beta\cdot x_i)}.
\]</span> Los estimadores máximo-verosímiles se muestran a continuación.
Elija dos de los modelos y, para cada uno, calcule la probabilidad
de que una discrepancia para un producto de limpieza, cuya
diferencia de precios es 201, dure más de 3 días (deje la expresión
simbólica; no es necesario valor numérico).</p>
<table>
<colgroup>
<col width="16%" />
<col width="31%" />
<col width="22%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parámetros</th>
<th align="right">Geométrico desplazado</th>
<th align="right">Beta geométrico</th>
<th align="right">Regresión geométrica</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\theta_0\)</span></td>
<td align="right">0.33</td>
<td align="right">–</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">–</td>
<td align="right">2.08</td>
<td align="right">–</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta\)</span></td>
<td align="right">–</td>
<td align="right">2.62</td>
<td align="right">–</td>
</tr>
<tr class="even">
<td align="left">Diff</td>
<td align="right">–</td>
<td align="right">–</td>
<td align="right">-0.43</td>
</tr>
<tr class="odd">
<td align="left">limpieza</td>
<td align="right">–</td>
<td align="right">–</td>
<td align="right">-0.87</td>
</tr>
<tr class="even">
<td align="left"><strong>LL</strong></td>
<td align="right">-788</td>
<td align="right">-761</td>
<td align="right">-566</td>
</tr>
<tr class="odd">
<td align="left"><strong>AIC</strong></td>
<td align="right">1278</td>
<td align="right">1526</td>
<td align="right">1142</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla: Estimadores y criterios de información de tres modelos de duración.} \]</span></p></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Dado que la duración la observamos en días, parece más natural
considerar un modelo de duración en tiempo discreto (la muestra de
datos también sugiere que el proceso podría ser bastante discreto).
Sea:</p>
<ul>
<li><span class="math inline">\(\theta\)</span> = Probabilidad de que un producto deje de estar en
discrepancia en un día dado.</li>
<li><span class="math inline">\(T_i\)</span> = la duración de la discrepancia de la observación <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\tau\)</span> = el máximo período de observación (28 días).</li>
<li><span class="math inline">\(n_t\)</span> = el número de casos en que observamos que la discrepancia
dura <span class="math inline">\(t\)</span> días.</li>
</ul>
<p>Entonces, la log-verosimilitud viene dada por:</p>
<p><span class="math display">\[
LL \;=\; n_{\tau}\,\ln\!\big((1-\theta)^{\tau}\big)\;+\;\sum_{t=1}^{\tau-1} n_t\,\ln\!\big((1-\theta)^{t-1}\,\theta\big)
\]</span></p>
<p>Acá, <span class="math inline">\(\theta\)</span> es el único parámetro del modelo. Los datos son <span class="math inline">\(n_t\)</span>
y <span class="math inline">\(n_{\tau}\)</span> y se obtienen directamente a través de un conteo
condicional en los valores de la columna Duration.</p></li>
<li><p>Hay varias consideraciones que sugieren que el <strong>Modelo 2</strong> podría
ser preferible.</p>
<ul>
<li><code>diff</code> no es significativo en modelo 1, pero <code>log(diff)</code> sí lo
es en modelo 2.</li>
<li>El p-valor del tipo es menor en el modelo 2.</li>
<li>La interacción que agrega el modelo 1 (<code>type.I × diff</code>) no es
significativa.</li>
<li>Las variables adicionales del modelo 2 sí son significativas.</li>
</ul></li>
<li><p>Las expresiones se derivan directamente de las definiciones y vienen
dadas por:</p>
<ul>
<li><p><strong>Geométrica:</strong> <span class="math inline">\(\Pr(T&gt;3\mid \theta_0)=(1-0.33)^3\)</span>.</p></li>
<li><p><strong>Beta-Geométrica:</strong> <span class="math display">\[
\Pr(T&gt;3\mid \alpha,\beta)\;=\;\frac{B(2.08,\;2.62+3)}{B(2.08,\;2.62)}.
\]</span></p></li>
<li><p><strong>Regresión Geométrica:</strong> <span class="math display">\[
\Pr(T&gt;3\mid \theta_0,\theta_{\text{Diff}},\theta_{\text{lim}})\;=\;\left(\frac{1}{1+\exp(0.46+0.43\cdot 201+0.87)}\right)^{3}.
\]</span></p></li>
</ul></li>
</ol>
</div>
<div id="problema-5" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Problema 5<a href="modelos-probabilisticos.html#problema-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se acerca el verano (sí, hay que usar la imaginación) y tu última
práctica profesional. Como has sido una estudiante excepcional, pudiste
elegir con cuidado dónde realizarla y después de descartar varias
ofertas, decidiste aceptar la oferta de NotComida, una startup chilena
exitosa que basa su propuesta de valor en el diseño y manufactura de
productos alimenticios basados en plantas que funcionan como sucedáneos
cercanos a otros productos de origen animal, como la leche, el helado o
las hamburguesas. Cada vez que te piensas en lo que viene, se te escapa
un suspiro de satisfacción. Piensas en lo terrible que sería para ti
trabajar en una compañía que no esté alineada con tus ideales. A fin de
cuentas, entraste a estudiar ingeniería para cambiar el mundo. Para ti
este es solo el primer paso.</p>
<p>Todavía quedan dos semanas para que empiece la práctica, pero ya estás
ansiosa, por lo que recibes con entusiasmo y sorpresa un correo
electrónico de Kiara, quien será tu supervisora directa durante tu
estadía en la compañía. <em>“¡Hola! Esperando que estés muy bien, te
escribo para contarte los próximos desafíos en los que vamos a estar
trabajando en el equipo en los próximos seis meses. Por supuesto que no
es necesario que hagas absolutamente nada, pero como queremos que te
sientas integrada te vamos a ir copiando en las</em> <em>comunicaciones
internas del equipo”.</em> Antes de cerrar el mensaje, te das el tiempo de
darle un vistazo rápido al diccionario de datos que viene adjunto:</p>
<table>
<colgroup>
<col width="26%" />
<col width="47%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Descripción</th>
<th align="center">Media</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IdCliente</td>
<td align="left">Identificador de cliente</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="left">Mes</td>
<td align="left">Mes {enero, febrero, …, diciembre}</td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="left">Año</td>
<td align="left">Año</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="left">Categoría</td>
<td align="left">Categoría de producto {Hamburguesas, Leche, Helados}</td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="left">Tienda</td>
<td align="left">Identificador de la tienda dónde se realizó la compra</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="left">Edad</td>
<td align="left">Edad del panelista</td>
<td align="center">31.3</td>
</tr>
<tr class="odd">
<td align="left">Mujer</td>
<td align="left">1 si la panelista se identifica como mujer</td>
<td align="center">0.51</td>
</tr>
<tr class="even">
<td align="left">Ingreso</td>
<td align="left">Ingreso mensual declarado por el panelista [millones CLP]</td>
<td align="center">0.56</td>
</tr>
<tr class="odd">
<td align="left">Zona Oriente</td>
<td align="left">1 si el panelista vive en la zona oriente de Santiago</td>
<td align="center">0.11</td>
</tr>
<tr class="even">
<td align="left">NCompras</td>
<td align="left">Número de compras en esa categoría y mes</td>
<td align="center">2.34</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla 1: Diccionario de datos del panel (variables y media cuando corresponde).} \]</span></p>
<p>Tienes súper claro que, de verdad, no tienes que hacer nada. Sin
embargo, te dan unas ganas enormes de empezar ya a pensar en cómo puedes
contribuir. El equipo se ha embarcado en una serie de proyectos para
entender el comportamiento de compra de los clientes y tú sabes que
tienes las herramientas para hacer una contribución. Aunque no estás tan
segura de en qué subproyecto te quieres involucrar, ya has delineado un
plan bastante claro de lo que te gustaría hacer. Considerando que la
fuente de datos principal es un panel de compras con el número de
unidades y montos comprados por cliente, se te ocurre que tu primer
modelo puede estar basado en un modelo de conteo.</p>
<ol style="list-style-type: decimal">
<li><p>Proponga un modelo de regresión de Poisson en que la tasa de compra
depende de cada individuo, categoría, tienda y semana. Escriba la
log-verosimilitud del problema considerando que <span class="math inline">\(n_{icst}\)</span> es el
número de unidades compradas por el cliente <span class="math inline">\(i\)</span> en la categoría <span class="math inline">\(c\)</span>
en la tienda <span class="math inline">\(s\)</span> el mes <span class="math inline">\(t\)</span>. Para esto considere que:</p>
<ol style="list-style-type: lower-alpha">
<li>Existe un efecto fijo por categoría y uno por tienda.</li>
<li>El género induce diferencias relevantes en las ventas y el
efecto del género es distinto para la zona oriente de la
capital.</li>
<li>Existe una tendencia creciente en las ventas. Como el
crecimiento es relativamente pequeño, puede modelarse con un
efecto fijo a nivel de año.</li>
<li>Aunque en el consumo es relativamente constante a lo largo del
año, hay dos categorías que presentan una estacionalidad
relevante. Mientras los helados tienen un patrón marcadamente
diferente en los meses de diciembre, enero y febrero, las
hamburguesas declinan sus ventas en el mes de septiembre.</li>
</ol></li>
<li><p>La investigación exploratoria de los datos sugiere que,
restringiendo el análisis a la categoría <span class="math inline">\(c=\)</span> Hamburguesas, podría
haber dos clases latentes. Un segmento de alto consumo y otro de
consumo más bien ocasional. Para acomodar esta regularidad se
propone un modelo sencillo en que la tasa de compra de un cliente
<span class="math inline">\(i\)</span>, independiente del mes, viene dado por:</p>
<p><span class="math display">\[
\log(\lambda_i) \;=\; \beta_{0i} + \beta_1 \text{MUJER}_i
\]</span>Donde <span class="math inline">\(\beta_{0i}\)</span> toma el valor <span class="math inline">\(-1\)</span> con probabilidad <span class="math inline">\(0.4\)</span> y el
valor <span class="math inline">\(0.5\)</span> con probabilidad <span class="math inline">\(0.6\)</span>. ¿Cuál es la probabilidad de que
un cliente hombre, con MM$1 de ingreso que no compra en un mes
(<span class="math inline">\(n_i=1\)</span>) pertenezca al segmento 1? Deje computada la probabilidad.</p></li>
<li><p>Después de revisar los resultados de los modelos anteriores, te
preguntas si dado el bajo número de compras registrados cada mes,
quizás podría existir un modelo alternativo que pudiera complementar
los aprendizajes anteriores. Rápidamente se te ocurre que quizás
puedes definir una variable <span class="math inline">\(y_{icst}\)</span> que toma el valor 1 si el
cliente <span class="math inline">\(i\)</span> compra en la categoría <span class="math inline">\(c\)</span> en la tienda <span class="math inline">\(s\)</span> el mes <span class="math inline">\(t\)</span>
(sí o no). Con esto, te resulta evidente que puedes estimar un
modelo de elección discreta que describa la decisión de comprar o no
de los clientes de la base.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Considerando los datos de la Tabla 2, que describen todas las
compras observadas por el cliente 321045, escriba la
log-verosimilitud del historial de compra de este cliente.</p>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">IdCliente</th>
<th align="center">Mes</th>
<th align="center">Año</th>
<th align="center">Tienda</th>
<th align="left">Categoría</th>
<th align="center">Edad</th>
<th align="center">Mujer</th>
<th align="center">Ingresos</th>
<th align="center">Zona Oriente</th>
<th align="center">Ncompras</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">321045</td>
<td align="center">Julio</td>
<td align="center">2021</td>
<td align="center">S816</td>
<td align="left">Hamburguesa</td>
<td align="center">26</td>
<td align="center">0</td>
<td align="center">1.3</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">321045</td>
<td align="center">Septiembre</td>
<td align="center">2021</td>
<td align="center">S816</td>
<td align="left">Hamburguesa</td>
<td align="center">26</td>
<td align="center">0</td>
<td align="center">1.3</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla 2: Historial resumido de compras del cliente 321045.} \]</span></p></li>
</ol></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>En un modelo de regresión de Poisson, la distribución ya viene dada
y solo tenemos que especificar la tasa del proceso. Sea
<span class="math inline">\(\lambda_{icst}\)</span> la tasa de compras del cliente <span class="math inline">\(i\)</span> en la categoría
<span class="math inline">\(c\)</span> en la tienda <span class="math inline">\(s\)</span> el mes <span class="math inline">\(t\)</span>. Además, definamos:</p>
<ul>
<li><span class="math inline">\(\delta_{ta}=1\)</span> si el mes <span class="math inline">\(t\)</span> pertenece al año <span class="math inline">\(a\)</span>.</li>
<li><span class="math inline">\(\Delta^{1}_{ct}=1\)</span> si <span class="math inline">\(c=\text{Helado}\)</span> y
<span class="math inline">\(t\in\{\text{diciembre, enero, febrero}\}\)</span>.</li>
<li><span class="math inline">\(\Delta^{2}_{ct}=1\)</span> si <span class="math inline">\(c=\text{Hamburguesa}\)</span> y
<span class="math inline">\(t=\text{septiembre}\)</span>.</li>
</ul>
<p>Entonces, la tasa de compra puede escribirse como <span class="math display">\[
\lambda_{icst}
= \alpha_c + \alpha_s
+ \beta_1\,\text{MUJER}_i
+ \beta_2\,\text{MUJER}_i\cdot \text{ZORIENTE}_s
+ \sum_a \gamma_a\,\delta_{ta}
+ \theta_1\,\Delta^{1}_{ct}
+ \theta_2\,\Delta^{2}_{ct}.
\]</span></p>
<p>Tanto <span class="math inline">\(\Delta^{1}_{ct}=1\)</span> como <span class="math inline">\(\Delta^{2}_{ct}=1\)</span> pueden ser
obtenidos usando una interacción entre Categoría, Tiempo y una
indicatriz, que indique <span class="math inline">\(\mathbb{1}\)</span> cuando <span class="math inline">\(t\)</span> pertenece al mes
indicado, y <span class="math inline">\(0\)</span> en caso contrario.</p>
<p>Con esto, la <strong>log-verosimilitud</strong> viene dada por: <span class="math display">\[
LL
= \sum_{i,c,s,t}\ln\big(\Pr(N_{icst}=n_{icst})\big)
= \sum_{i,c,s,t}\ln\!\left(\frac{\lambda_{icst}^{\,n_{icst}}\,e^{-\lambda_{icst}}}{n_{icst}!}\right).
\]</span></p></li>
<li><p>Las tasas de compra de los dos segmentos vienen dadas por:</p>
<p><span class="math display">\[
log(\lambda_{i1}) = -1 + \beta_1 \text{MUJER}_i = -1 + 0 \implies \lambda_{i1} = e^{-1}
\]</span></p>
<p><span class="math display">\[
log(\lambda_{i2}) = 0.5 + \beta_1 \text{MUJER}_i = 0.5 + 0 \implies \lambda_{i1} = e^{-0.5}
\]</span></p>
<p>Por tanto, la probabilidad de comprar una vez en cada segmento es:</p>
<p><span class="math display">\[
\mathbb{P}(n_i = 1 \mid s_1) = \lambda_{i1} e^{-\lambda_{i1}} = e^{-1}e^{-e^{-1}}
\]</span></p>
<p><span class="math display">\[
\mathbb{P}(n_i = 0 \mid s_2) = \lambda_{i2} e^{-\lambda_{i2}} = e^{-0.5}e^{-e^{-0.5}}
\]</span></p>
<p>Aplicando Teorema de Bayes:</p>
<p><span class="math display">\[
\mathbb{P}(s_1 \mid n_i = 1) = \frac{\mathbb{P}(n_i = 0 \mid s_1)\mathbb{P}(s_1)}{\mathbb{P}(s_1 \mid n_i = 0) \mathbb{P}(s_1) + \mathbb{P}(s_2 \mid n_i = 0) \mathbb{P}(s_2)}
\]</span></p>
<p>Donde <span class="math inline">\(\mathbb{P}(s_1) \;=\; 0.4\)</span> y <span class="math inline">\(\mathbb{P}(s_2)  \;=\; 0.6\)</span>.</p></li>
<li><p>La utilidad que deriva el cliente <span class="math inline">\(i\)</span> por comprar en la categoría
<span class="math inline">\(c\)</span> en la tienda <span class="math inline">\(s\)</span> en el mes <span class="math inline">\(t\)</span> viene dado por:</p>
<p><span class="math display">\[
u_{icst} = \alpha_c + \alpha_c + (\beta_1 \text{MUJER}_i = 0) + (\beta_2 \text{MUJER}_i \text{ZORIENTE}_s = 0) + \sum_{a} \gamma_a \delta_{ta} + (\theta_1 \Delta_{ct}^1 = 0)+ \theta_2 \Delta_{ct}^2
\]</span></p>
<p>Donde <span class="math inline">\(\text{MUJER}_i \;=\; 0\)</span> porque el registro es de un hombre, y
<span class="math inline">\(\theta_1 \Delta_{ct}^1 = 0\)</span> porque aplica para helado y en los
meses de verano, no septiembre y hamburguesa. Con esto, la log
verosimilitud es:</p>
<p><span class="math display">\[
LL(\hat{\theta}) = \sum_{icst} y_{icst} ln\left(\frac{e^{u_{icst}}}{1+e^{u_{icst}}}\right) + (1-y_{icst})ln\left(\frac{1}{1+e^{u_{icst}}}\right)
\]</span></p></li>
</ol>
</div>
<div id="problema-6" class="section level3 hasAnchor" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> Problema 6<a href="modelos-probabilisticos.html#problema-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En los últimos 20 años, hemos visto un crecimiento explosivo en el uso
de redes sociales, con más de 4.4 billones de usuarios a nivel mundial y
con un promedio de más de 8 cuentas por usuario en las distintas
plataformas que han surgido en los últimos años. En este ecosistema, hay
un creciente interés por convertirse en <em>creador de contenido</em>, que les
permita generar audiencia que pueda eventualmente ser monetizada.
Cualquier persona con un dispositivo móvil puede crear contenido que
potencialmente puede volverse viral y captar niveles importantes de
atención de los usuarios. Ya sea tocando la guitarra y cantando, jugando
videojuegos o mostrando la ejecución de sofisticadas recetas de cocina,
muchos creadores buscan alcanzar altos niveles de visitas y generar
interacciones significativas con sus audiencias.</p>
<p>Considerando que existen un alto potencial comercial en la industria de
generación de contenido, se ha propuesto investigar en profundidad
cuáles son los factores que inciden en el nivel de interacciones entre
creadores y usuarios. Para estos efectos, se ha aliado con un nuevo
portal en que creadores de contenido pueden subir su material, el que es
exhibido a los usuarios de la plataforma usando un algoritmo interno que
personaliza el contenido de acuerdo con la probabilidad de generar
interacciones. Aunque hay varios niveles de interacción con el contenido
(ver, comentar, compartir), la plataforma considera que el número de <em>me
gusta</em> es la principal métrica para capturar el éxito relativo de una
publicación.</p>
<p>El portal tiene un módulo de analítica de datos que permite recolectar
algunas métricas claves de cada uno de los contenidos publicados en su
primer año de operación para todos los creadores registrados en el
portal. Entre los datos disponibles se encuentran las llaves para
identificar cada contenido y algunas características como la categoría
del contenido (información, humor o noticia), el número de caracteres,
el número de imágenes y la duración del video, si existiese.
Adicionalmente, y gracias a una alianza con una herramienta de
inteligencia artificial, se cuenta con el puntaje de cada contenido en
tres dimensiones distintos: producción, contenido y novedad.</p>
<table>
<colgroup>
<col width="26%" />
<col width="47%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Descripción</th>
<th align="center">Media</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IdCC</td>
<td align="left">Identificador de cliente</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="left">IdPost</td>
<td align="left">Identificador del contenido</td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="left">DatePost</td>
<td align="left">Fecha de publicación del contenido</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="left">Category</td>
<td align="left">Categoría de producto {Information, Humour, News}</td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="left">Nchar</td>
<td align="left">Número de caracteres en el texto del contenido publicado</td>
<td align="center">84.4</td>
</tr>
<tr class="even">
<td align="left">Npic</td>
<td align="left">Número de fotos en el contenido publicado</td>
<td align="center">0.4</td>
</tr>
<tr class="odd">
<td align="left">Tvid</td>
<td align="left">Duración [seg] de los videos que acompañan el contenido</td>
<td align="center">18.5</td>
</tr>
<tr class="even">
<td align="left">AIproduction</td>
<td align="left">AI score en la calidad de la producción [0,1]</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="left">AIcontent</td>
<td align="left">AI score en la calidad del contenido [0,1]</td>
<td align="center">0.3</td>
</tr>
<tr class="even">
<td align="left">AInovelty</td>
<td align="left">AI score en la novedad del contenido [0,1]</td>
<td align="center">0.2</td>
</tr>
<tr class="odd">
<td align="left">Nlikes</td>
<td align="left">Número de <em>me gusta</em> que ha recibido la publicación</td>
<td align="center">12.5</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \text{Tabla 1: Descripción base de contenidos en la plataforma de creadores.} \]</span></p>
<ol style="list-style-type: decimal">
<li><p>Modele el número de <em>me gusta</em> que recibe una publicación como un
proceso de conteo con heterogeneidad observable. Para este modelo:</p>
<ol style="list-style-type: lower-alpha">
<li>Justifique la inclusión de al menos dos variables explicativas
indicando cuál es el signo esperado del coeficiente
correspondiente.</li>
<li>Escriba la log-verosimilitud del problema. Indique cuáles son
los parámetros para estimar y explicite cuántos parámetros tiene
su modelo.</li>
<li>Suponiendo que ha estimado el modelo y los parámetros proveen
una buena descripción de la distribución del número de <em>me
gusta</em> que recibirá un post. Usando dichos estimadores, escriba
una expresión para la probabilidad de que un cliente reciba al
menos un <em>me gusta</em>.</li>
</ol></li>
<li><p>Una de las limitaciones del modelo anterior es que el uso del
algoritmo interno de la plataforma implica una distribución muy
heterogénea de exposiciones. Esto es, algunas publicaciones son
desplegadas miles de veces, mientras que otras reciben muy poca
exposición. Para hacer frente a este problema, se propone usar un
modelo de elección.</p>
<ol style="list-style-type: lower-alpha">
<li>Describa el proceso como un proceso de elección binaria con
heterogeneidad no observable y escriba la log-verosimilitud del
problema. Para eso, suponga que la base de datos también
contiene una variable <span class="math inline">\(Ndisp\)</span> que, para cada post, indica el
número de veces que fue expuesto.</li>
<li>Si al estimar el modelo, se encuentra que <span class="math inline">\(\alpha=1\)</span> y <span class="math inline">\(\beta=2\)</span>
son los estimadores máximo-verosímiles. En promedio, ¿con qué
probabilidad a un cliente le gusta una publicación en la
plataforma?</li>
<li>Considere una publicación que ha sido desplegada 100 veces y ha
recibido 10 <em>me gusta</em>. Considerando los valores de
<span class="math inline">\((\alpha,\beta)=(1,2)\)</span>, de la parte anterior, ¿cuántos <em>me
gusta</em> esperaría observar luego de mostrar el contenido 200
veces?</li>
</ol></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Se tiene:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Cualquiera de las variables listadas puede justificarse de
manera más o menos directa:</p>
<ul>
<li><p><strong>Efecto fijo por creador:</strong> hay creadores más populares que
otros.</p></li>
<li><p><strong>Efecto fijo por fecha:</strong> hay fechas en que los usuarios
son más activos.</p></li>
<li><p><strong>Dummies por categoría:</strong> hay categorías que pueden generar
más <em>me gusta</em>.</p></li>
<li><p><strong>Nchar:</strong> textos más largos o más cortos pueden ser más
atractivos.</p></li>
<li><p><strong>Npic:</strong> agregar más fotos puede ser más atractivo.</p></li>
<li><p><strong>Tvid:</strong> videos más largos o más cortos pueden ser
preferidos.</p></li>
<li><p><strong>AIproduction:</strong> material mejor producido puede generar más
<em>me gusta</em>.</p></li>
<li><p><strong>AIcontent:</strong> contenido de mejor calidad puede generar más
<em>me gusta</em>.</p></li>
<li><p><strong>AInovelty:</strong> material más novedoso puede generar más <em>me
gusta</em>.</p></li>
</ul></li>
<li><p>Aunque cualquier combinación de las variables arriba descritas
es admisible, para efectos ilustrativos consideraremos un modelo
en que la tasa de <em>me gusta</em> del contenido <span class="math inline">\(i\)</span> viene dada por:
<span class="math display">\[
   \lambda_i \;=\; \lambda_0 \cdot \exp\!\big(\beta_1\,\text{Nchar}_i + \beta_2\,\text{Npic}_i + \beta_3\,\text{Tvid}_i\big).
   \]</span> Con esto, la log-verosimilitud viene dada por: <span class="math display">\[
   LL \;=\; \sum_i \ln\!\left(\frac{\lambda_i^{\,\text{Nlikes}_i}\,e^{-\lambda_i}}{\text{Nlikes}_i!}\right).
   \]</span></p></li>
<li><p>La probabilidad de recibir al menos un <em>me gusta</em> viene dada
por: <span class="math display">\[
   \Pr(\text{Nlikes}_i &gt; 0 \mid \lambda_0,\boldsymbol{\beta})
   \;=\; 1 - \Pr(\text{Nlikes}_i = 0 \mid \lambda_0,\boldsymbol{\beta})
   \;=\; 1 - e^{-\lambda_i}.
   \]</span></p></li>
</ol></li>
<li><p>El modelo es una beta-binomial estándar. Recordar que la esperanza
de una <span class="math inline">\(\text{Beta}(\alpha,\beta)\)</span> es <span class="math inline">\(\alpha/(\alpha+\beta)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>La log-verosimilitud de una beta-binomial: <span class="math display">\[
LL \;=\; \sum_i \ln\!\left(
\binom{\text{NDisp}_i}{\text{Nlikes}_i}\;
\frac{B\!\big(\alpha + \text{Nlikes}_i,\; \beta + \text{NDisp}_i - \text{Nlikes}_i\big)}{B(\alpha,\beta)}
\right).
\]</span></p></li>
<li><p><span class="math display">\[
\mathbb{E}(\theta \mid \alpha,\beta) \;=\; \frac{\alpha}{\alpha+\beta} \;=\; \frac{1}{3}.
\]</span></p></li>
<li><p>Se tiene que despejar la esperanza condicional</p>
<p><span class="math display">\[
\mathbb{E}\!\left(\theta_i \mid \alpha,\beta,\text{NDisp}_i,\text{Nlikes}_i\right) =\frac{\alpha+\text{Nlikes}_i}{\alpha+\beta+\text{NDisp}_i} =\frac{11}{103}.
\]</span></p>
<p>Entonces, el número esperado de <em>me gusta</em> al mostrar el
contenido 200 veces es:<span class="math display">\[
200 \times \frac{11}{103} \approx 21.36.
\]</span></p>
<p>Notar que <span class="math inline">\(\frac{11}{103}\)</span> es el número esperado de likes de una
persona, dada su verosimilitud (información previa) por su
comportamiento esperado (distribución beta). Por eso, para 200
personas simplemente se multiplica.</p></li>
</ol></li>
</ol>
</div>
<div id="problema-7" class="section level3 hasAnchor" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> Problema 7<a href="modelos-probabilisticos.html#problema-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hippi es una empresa nacional dedicada a la fabricación de productos
para alta montaña. La empresa cuenta con una base de datos que registra
la compras que sus clientes en cada temporada y busca estudiar el numero
de parkas que los clientes comprarán en la temporada. Para esto, se ha
formulado un modelo probabilístico donde el comportamiento de los
clientes se describe como:</p>
<ul>
<li><p>Cada cliente compra un numero de parkas X que sigue una distribución
geométrica. Esto es, condicional en el parámetro p de cada cliente,
la función de probabilidad esta dada por:</p>
<p><span class="math display">\[
Pr(X = x|p) = p(1-p)^x
\]</span></p></li>
<li><p>Los clientes son heterogéneos en su parámetro p el que esta
distribuido en la población de acuerdo a una distribución Beta:</p></li>
</ul>
<p><span class="math display">\[g(p|\alpha,\beta) = \frac{1}{B(\alpha,\beta)} p^{\alpha - 1}(1-p)^{\beta-1}\]</span></p>
<p>Se puede mostrar que la distribución del número de compras para un
cliente en la población, y su respectiva esperanza están dadas por:</p>
<p><span class="math display">\[Pr(X=x) = \frac{B(\alpha + 1, \beta + x)}{B(\alpha,\beta)} \qquad \mathbb{E}(X) = \frac{\alpha}{\beta - 1}\]</span></p>
<p>Siguiendo la convención adoptada en el curso, llamamos a este modelo
Beta-Geométrico.</p>
<ol style="list-style-type: decimal">
<li><p>Muestre que la penetración de mercado (fracción de clientes que
compró al menos una unidad) puede expresarse como
<span class="math inline">\(\frac{\beta}{\alpha+\beta}\)</span>.</p></li>
<li><p>Para ello considere que la penetración de mercado es del 60 % y que
el numero promedio de parkas que compra un cliente (incluyendo
aquellos que no compraron) es igual a 2.5. Estime los parámetros del
modelo. <em>Hint: Realice un sistema de ecuaciones.</em></p></li>
<li><p>Se desea extender el modelo para que además incluya un segmento de
clientes que nunca compra. Para este segmento de clientes,
<span class="math inline">\(Pr(X = 0) = 1\)</span>. Sea <span class="math inline">\(\pi\)</span> la proporción de estos clientes en la
población, y <span class="math inline">\((1-\pi)\)</span> el segmento de clientes que se comporta de
acuerdo al modelo Beta-Geométrico descrito anteriormente. Suponga
que conoce <span class="math inline">\(x_i\)</span>, el numero de compras hechas por cada cliente i en
la base de datos (i = 1, …, n). Deduzca la función de
verosimilitud que utilizaría para estimar el modelo.</p></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Despejando <span class="math inline">\(p_0\)</span>:</p>
<p><span class="math display">\[
\begin{aligned} p_0 &amp;= 1 - \Pr(X=0) \\ &amp;= 1 - \frac{B(\alpha,\beta+1)}{B(\alpha,\beta)} \\ &amp;= 1 - \frac{\Gamma(\alpha)\Gamma(\beta+1)}{\Gamma(\alpha+\beta+1)} \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} \\ &amp;= 1 - \frac{\beta\,\Gamma(\beta)}{(\alpha+\beta)\,\Gamma(\beta)} \\ &amp;= \frac{\alpha}{\alpha+\beta}. \end{aligned}
\]</span></p></li>
<li><p>A partir de la penetración de compra se despeja <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
0.6=\frac{\beta}{\alpha+\beta}\quad\Rightarrow\quad\beta=0.6(\alpha+\beta)\ \Rightarrow\ 0.4\beta=0.6\alpha\ \Rightarrow\ \alpha=\tfrac{2}{3}\beta
\]</span></p>
<p>Despejando <span class="math inline">\(\beta\)</span> utilizando el número promedio de parkas comprado
por un cliente:</p>
<p><span class="math display">\[
2.5=\frac{\alpha}{\beta-1} \quad\Rightarrow\quad2.5=\frac{\tfrac{2}{3}\beta}{\beta-1} \Rightarrow\ \tfrac{2}{3}\beta=2.5(\beta-1) \Rightarrow\ \beta=\tfrac{15}{11}
\]</span></p>
<p>Entonces, sustituyendo:</p>
<p><span class="math display">\[
\alpha=\tfrac{2}{3}\beta=\tfrac{2}{3}\cdot\tfrac{15}{11}=\tfrac{10}{11}
\]</span></p></li>
<li><p>Sea <span class="math inline">\(n_x\)</span> el número de clientes que compra x parkas. Entonces, la
verosimilitud puede escribirse como:</p>
<p><span class="math display">\[
L(\alpha,\beta,\pi |x) = \prod_{x=0}^{\infty} \mathbb{P}(X=x|\alpha,\beta,\pi)^{n_x}
\]</span></p>
<p>Donde,</p>
<p><span class="math display">\[
\begin{aligned}Pr(X=x \mid \alpha,\beta,\pi) &amp;= \pi \, Pr(X=x \mid \text{no adopta}) + (1 - \pi)\, Pr(X=x \mid \text{puede adoptar}) \\[6pt]&amp;= \begin{cases}\pi + (1-\pi)\dfrac{B(\alpha+1,\beta)}{B(\alpha,\beta)}, &amp; x=0 \\[10pt](1-\pi)\dfrac{B(\alpha+1,\beta+x)}{B(\alpha,\beta)}, &amp; x&gt;0\end{cases}\end{aligned}
\]</span></p></li>
</ol>
</div>
<div id="problema-8" class="section level3 hasAnchor" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> Problema 8<a href="modelos-probabilisticos.html#problema-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para revitalizar el interés de los usuarios, Pokémon Go está pensando
introducir 7 nuevos personajes Pokémon en las comunas de Melipilla,
Talagante, Pirque, Colina, Alhue, Paine, Lampa y Buin. Para estudiar el
impacto en el atractivo del juego, los desarrolladores han estado
realizando pruebas para ver el interés de los jugadores en estos nuevos
personajes. Las pruebas se han desarrollado sobre una muestra de
jugadores de acuerdo a los números desplegados en la siguietne tabla:</p>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th>Pokemon</th>
<th>Melipilla</th>
<th>Talagante</th>
<th>Pirque</th>
<th>Colina</th>
<th>Alhue</th>
<th>Paine</th>
<th>Lampa</th>
<th>Buin</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Wigglytuff</td>
<td>5</td>
<td>834</td>
<td>504</td>
<td>117</td>
<td>763</td>
<td>424</td>
<td>387</td>
<td>683</td>
<td>3,717</td>
</tr>
<tr class="even">
<td>Slowbrow</td>
<td>24</td>
<td>975</td>
<td>8</td>
<td>342</td>
<td>715</td>
<td>362</td>
<td>788</td>
<td>793</td>
<td>4,007</td>
</tr>
<tr class="odd">
<td>Lickitung</td>
<td>101</td>
<td>651</td>
<td>200</td>
<td>993</td>
<td>562</td>
<td>614</td>
<td>691</td>
<td>595</td>
<td>4,407</td>
</tr>
<tr class="even">
<td>Chansley</td>
<td>198</td>
<td>517</td>
<td>960</td>
<td>788</td>
<td>441</td>
<td>844</td>
<td>836</td>
<td>438</td>
<td>5,022</td>
</tr>
<tr class="odd">
<td>Tangela</td>
<td>79</td>
<td>990</td>
<td>756</td>
<td>868</td>
<td>210</td>
<td>944</td>
<td>509</td>
<td>233</td>
<td>4,589</td>
</tr>
<tr class="even">
<td>Ditto</td>
<td>69</td>
<td>587</td>
<td>96</td>
<td>365</td>
<td>182</td>
<td>634</td>
<td>373</td>
<td>419</td>
<td>2,725</td>
</tr>
<tr class="odd">
<td>Phanpy</td>
<td>138</td>
<td>969</td>
<td>971</td>
<td>890</td>
<td>586</td>
<td>764</td>
<td>585</td>
<td>361</td>
<td>5,264</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\textbf{Tabla: } \text{Número de veces que un determinado pokemón fue mostrado a un jugador.}
\]</span></p>
<p>Existe dos parámetros relevantes para entender el grado de interacción
entre jugadores y personajes. El primer parámetro corresponde a <span class="math inline">\(q_{k}\)</span>
que corresponde a la probabilidad de atrapar a un personaje, condicional
de que un jugador intente atraparlo. Aunque esta probabilidad es
relevante para saber en qué medida los usuarios aumentan su mazo, el
parámetro es ajustado internamente en la plataforma y, por tanto, no hay
incertidumbre desde el punto de vista de los usuarios. El segundo
parámetro que denominamos como <span class="math inline">\(p_k\)</span>, mide la probabilidad que un
usuario intente atrapar un personaje <span class="math inline">\(k\)</span> si este le aparece disponible
en la aplicación móvil. Desde el punto de vista de la jugabilidad es
importante disponibilizar personajes que los usuarios quieran atrapar.
Para entender el comportamiento de esta intención de atrapar personajes,
la tabla siguiente despliega el número de intentos para los personajes y
comunas que forman parte del estudio piloto:</p>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th>Pokemon</th>
<th>Melipilla</th>
<th>Talagante</th>
<th>Pirque</th>
<th>Colina</th>
<th>Alhue</th>
<th>Paine</th>
<th>Lampa</th>
<th>Buin</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Wigglytuff</td>
<td>0</td>
<td>218</td>
<td>98</td>
<td>39</td>
<td>31</td>
<td>63</td>
<td>26</td>
<td>43</td>
<td>518</td>
</tr>
<tr class="even">
<td>Slowbrow</td>
<td>8</td>
<td>186</td>
<td>4</td>
<td>110</td>
<td>393</td>
<td>79</td>
<td>240</td>
<td>113</td>
<td>1,133</td>
</tr>
<tr class="odd">
<td>Lickitung</td>
<td>8</td>
<td>47</td>
<td>13</td>
<td>98</td>
<td>183</td>
<td>180</td>
<td>219</td>
<td>60</td>
<td>808</td>
</tr>
<tr class="even">
<td>Chansley</td>
<td>49</td>
<td>31</td>
<td>274</td>
<td>24</td>
<td>48</td>
<td>91</td>
<td>205</td>
<td>42</td>
<td>764</td>
</tr>
<tr class="odd">
<td>Tangela</td>
<td>14</td>
<td>294</td>
<td>71</td>
<td>35</td>
<td>59</td>
<td>304</td>
<td>116</td>
<td>2</td>
<td>895</td>
</tr>
<tr class="even">
<td>Ditto</td>
<td>14</td>
<td>180</td>
<td>14</td>
<td>110</td>
<td>33</td>
<td>84</td>
<td>0</td>
<td>10</td>
<td>445</td>
</tr>
<tr class="odd">
<td>Phanpy</td>
<td>4</td>
<td>19</td>
<td>66</td>
<td>189</td>
<td>9</td>
<td>37</td>
<td>92</td>
<td>33</td>
<td>449</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\textbf{Tabla: } \text{Número de veces que un jugador intentó atrapar a un determinado pokemón.}
\]</span> A partir de los datos presentados:</p>
<ol style="list-style-type: decimal">
<li>Use el método de los momentos para estimar un modelo binomial sin
heterogeneidad que caracterice la probabilidad que un usuario
intente atrapar a wigglytuff. <em><strong>Hint:</strong> Con usar el método de los
momentos, se refiere a que el primer momento de una distribución es
el valor esperado, donde el valor esperado ed una distribución
binomial es</em> <span class="math inline">\(np\)</span><em>.</em></li>
<li>Escriba ahora un modelo que incorpore heterogeneidad para
caracterizar la probabilidad que un número de usuarios intente
atrapar a un pokemón <span class="math inline">\(k\)</span> en una comuna <span class="math inline">\(c\)</span>.</li>
<li>Escriba la log-verosimilitud del modelo anterior, para entender la
popularidad de cada uno de los personajes del estudio.</li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Definimos una variable aleatoria que signifique lo buscado</p>
<p><span class="math display">\[
X_{w} := \text{# de usuarios que intentan atrapar a wigglytuf}
\]</span>Tenemos un número de experimentos Bernoulli (# de personas a las
que se les muestra wigglytuf) y un número de “éxitos” entre estos
experimentos (# de personas que intentan atrapar a wigglytuf cuando
se les muestra) que ocurren con alguna probabilidad desconocidad
<span class="math inline">\(p_w\)</span> fija, ya que nos piden el caso homogéneo (único valor). Por lo
tanto, tenemos que la probabilidad que queremos caracterizar sería
de la forma:</p>
<p><span class="math display">\[
P(X_w = x_w) =  {n_w \choose x_w} p_{w}^{x_w} (1-p_w)^{n_w - x_w}
\]</span>Donde <span class="math inline">\(n_w\)</span> es la cantidad de personas a las que se les mostró el
pokemón (dato en la primera Tabla). Esdecir,
<span class="math inline">\(X_w \thicksim Bin(n_w,p_w)\)</span>. Sabemos que el primer momento de una
distribución es su media y que la media de una binomial es
<span class="math inline">\(n_w p_W\)</span>. Por otro lado, estimamos el valor de la media con algún
promedio muestras (con muestras del mismo tamaño) de número de
personas que intentaron atrapar a wigglytuf, pero en este caso este
número es único, por lo que usamos este valor (total de personas que
intentaron atrapar a wigglytuf de la última tabla) que, en este
caso, es 518. Por lo tanto, podemos obtener la probabilidad <span class="math inline">\(p_w\)</span>
con la igualdad del primer momento:</p>
<p><span class="math display">\[
518 = n_w p_w \\
518 = 3717 p_w \\
p_w \approx 0,1393
\]</span></p>
<p>Esto tiene mucho sentido, ya que estamos obteniendo la probabilidad
de manera empírica con la fracción de personas que intentaron
atraparlo y el número de personas a las que se les mostró.</p></li>
<li><p>Como debemos considerar heterogeneidad, ahora el parámetro de la
distribución que nos intersa, <span class="math inline">\(p_k\)</span>, no lo asumimos como único, sino
que sigue una distribución de probabilidad. Como el parámetro es una
probabilidad (<span class="math inline">\(p_k \in [0,1]\)</span>), utilizamos la distribución a priori
<span class="math inline">\(Beta(\alpha_k,\beta_k)\)</span>, con <span class="math inline">\(\alpha_k\)</span> y <span class="math inline">\(\beta_k\)</span> parámetros a
estimar (<span class="math inline">\(p_k \thicksim Beta(\alpha_k , \beta_k)\)</span>, por eso el sub
<span class="math inline">\(k\)</span>, ya que cada pokemón tiene un probabilidad <span class="math inline">\(p_k\)</span> asociada y no
tienen porqué seguir la misma distribución). Luego, tenemos que cada
comuna nos va a estar aportando en realidad datos sobre la
heterogeneidad existente para cada pokemón (sería el equivalente a
tener distintas observaciones para distintos individuos). Así, la
probabilidad quedaría, para cada pokemón y comuna, con la v.a.
anterior, pero segmentando por comuna:</p></li>
</ol>
<p><span class="math display">\[
P(X_{k,c} = x_{k,c}) = \int_0^1 P(X_{k,c} = x_{k,c} | p_k)Beta(p_k|\alpha_k, \beta_k) dp_k \\
= \int_0^1 \left( {n_{k,c} \choose x_{k,c}} p_{k}^{x_{k,c}} (1-p_{k})^{n_{k,c} - x_{k,c}}\right)   \left(\frac{p_k^{\alpha_k -1} (1-p_k)^{\beta_k -1}}{B(\alpha_k,\beta_k)} \right) dp_k\\
={n_{k,c} \choose x_{k,c}} \frac{B(\alpha_k + x_{k,c},\beta_k + n_{k,c}- x_{k,c})}{B(\alpha_k,\beta_k)}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Nos interesa analizar cada personaje por separado, por lo tanto
vamos a tener una expresión de la log-verosimilitud del parámetro
<span class="math inline">\(p_k\)</span> para cada pokemón. Luego, la muestra que tenemos de la v.a. en
cuestión para cada pokemón <span class="math inline">\(k\)</span> es de la forma
<span class="math inline">\(\{ x_{k,1},x_{k,2},...,x_{k,7} \}\)</span>, donde el segundo índice es para
cada una de las comunas. Sigue que la log-verosimilitud es el
logaritmo de la función de verosimilitud con esta muestra para cada
pokemón:</p>
<p><span class="math display">\[
\begin{aligned}
\ell (p_k |  x_{k,1}, ...,  x_{k,8}) &amp;= \ln (\mathcal{L}(p_k |  x_{k,1}, ...,  x_{k,8})) \\
&amp;= \ln(P(X_{k,1}=x_{k,1}, ...,X_{k,8}=x_{k,8} |p_k)) \\
&amp;= \ln \left( \prod_{c=1}^8 P(X_{x,c} = x_{x,c}|p_k) \right) \\
&amp;= \sum_{c=1}^8 \ln(P(X_{k,c}=x_{k,c}|p_k)) \\
&amp;= \sum_{c=1}^8 \ln \left( {n_{k,c} \choose x_{k,c}}\frac{B(\alpha_k + x_{k,c},\beta_k + n_{k,c}- x_{k,c})}{B(\alpha_k,\beta_k)} \right)
\end{aligned}
\]</span></p>
<p>Esta es la expresión pedida de la log-verosimilitud para cada
pokemón k. En el tercer paso asumimos indepndencia de las v.a. entre
columnas y en el último paso reemplazamos por la expresión
encontrada en la parte anterior.</p></li>
</ol>
</div>
<div id="problema-9" class="section level3 hasAnchor" number="3.4.9">
<h3><span class="header-section-number">3.4.9</span> Problema 9<a href="modelos-probabilisticos.html#problema-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inmersos en la era digital, los consumidores están cada vez conectados
en distintos dispositivos los cuales pueden ser usados como canales
durante el proceso de compra. En este contexto, algunas empresas han
decidido lanzar aplicaciones móviles que funcionan en base a información
georreferenciada de los dispositivos de sus clientes, y que permiten
enviarles promociones personalizadas cuando identifica que este se
encuentra cercano a un punto de venta.</p>
<p>La aplicación que más éxito ha tenido en el mercado, quiere evaluar la
efectividad de las campañas que envían a sus usuarios, y así poder
ofrecer un mejor servicio a las empresas que lo contratan. Para esto,
cuenta con información de los <span class="math inline">\(m_{i}\)</span> mensajes promocionales que envía
al cliente <span class="math inline">\(i\)</span>, y el número <span class="math inline">\(x_{i}\)</span> de esos que son efectivamente
utilizados por el cliente.</p>
<ol style="list-style-type: decimal">
<li><p>Plantee un modelo de elección para determinar la probabilidad de
respuesta de cada cliente, en cada ocasión de compra. En particular,</p>
<ol style="list-style-type: lower-alpha">
<li>Escriba la log-verosimilitud del problema.</li>
<li>Sea <span class="math inline">\(N\)</span> el número de clientes. Si se observa el comportamiento
por <span class="math inline">\(T\)</span> períodos y en promedio se envían <span class="math inline">\(M\)</span> promociones por
cliente, ¿cuántos parámetros deben estimarse?</li>
</ol></li>
</ol>
<!-- -->
<ol start="2" style="list-style-type: decimal">
<li><p>Considere que se cuenta con información demográfica de los usuarios
de la aplicación móvil, como edad, Ingreso y frecuencia de uso de la
app. Reformule el modelo anterior incorporando variables
explicativas considerando además que existe un segmento de clientes
que realiza pocos canjes y otro que realiza muchos (es decir, un
segmento canjeador <em>C</em> y otro no-canjeador <em>N</em>). <em><strong>Hint</strong>: Recuerde
que si</em> <span class="math inline">\(x\in\mathbb{R}\)</span><em>, entonces</em>
<span class="math inline">\(\frac{exp(x)}{1+exp(x)}\in(0,1)\)</span>.</p></li>
<li><p>Suponga que se ha estimado el modelo anterior y se encuentra que los
segmento canjeadores y no-canjeadores tienen el mismo tamaño y que
los parámetros asociados a las variables explicativas son tales que
para un usuario <span class="math inline">\(i\)</span> con un vector de variables explicativas <span class="math inline">\(z_{i}\)</span>,
<span class="math inline">\(\beta&#39;_{C}x_{i}=ln(2)\)</span> y <span class="math inline">\(\beta&#39;_{N}x_{i}=ln(1/2)\)</span>. Si al usuario
le han enviado dos promociones y ha canjeado las dos, ¿cuál es la
probabilidad que este usuario pertenezca al segmento de canjeadores?</p></li>
<li><p>Suponga ahora que del total de <span class="math inline">\(m_{i}\)</span> mensajes que recibe un
usuario este lee <span class="math inline">\(n_{i}\)</span> de ellos. De los <span class="math inline">\(n_{i}\)</span> mensajes que
efectivamente lee, decide canjear <span class="math inline">\(x_{i}\)</span> de ellos. Modele el
comportamiento anteriormente descrito como un modelo integrado
elección-elección. Plantee explícitamente la probabilidad de canje y
la log-verosimilitud del problema.</p></li>
</ol>
<p><strong>Solución</strong></p>
<ol style="list-style-type: decimal">
<li><p>Por partes:</p>
<ol style="list-style-type: decimal">
<li>Sea <span class="math inline">\(X_i\)</span> el número de veces que la persona <span class="math inline">\(i\)</span> hace efectivo un
cupón. La probabilidad de respuesta es <span class="math display">\[
\mathbb{P}(X_i=x_i \mid p_i) = \binom{m_i}{x_i}\, p_i^{\,x_i} (1-p_i)^{\,m_i-x_i}
\]</span> donde la log-verosimilitud viene dada por <span class="math display">\[
LL(p) = \sum_i \ln\!\Big(\binom{m_i}{x_i}\, p_i^{\,x_i} (1-p_i)^{\,m_i-x_i}\Big)
\]</span></li>
<li>Se deben estimar <span class="math inline">\(N\)</span> parámetros, uno para cada cliente (lo que
sugiere introducir heterogeneidad).</li>
</ol></li>
<li><p>Modelo de elección con dos segmentos. Sea <span class="math inline">\(p_{iC}\)</span> la probabilidad
de canje si <span class="math inline">\(i\)</span> pertenece al segmento canjeador y <span class="math inline">\(p_{iN}\)</span> si
pertenece al segmento no canjeador. Sea <span class="math inline">\(\pi\)</span> la fracción de
clientes canjeadores. Entonces
<span class="math display">\[\mathbb{P}(X_i=x_i \mid \beta,\pi) = \pi \binom{m_i}{x_i} p_{iC}^{\,x_i}(1-p_{iC})^{\,m_i-x_i} + (1-\pi) \binom{m_i}{x_i} p_{iN}^{\,x_i}(1-p_{iN})^{\,m_i-x_i}\]</span>
donde
<span class="math display">\[p_{iC} = \frac{\exp(\beta_C&#39; z_i)}{1+\exp(\beta_C&#39; z_i)}, \qquad p_{iN} = \frac{\exp(\beta_N&#39; z_i)}{1+\exp(\beta_N&#39; z_i)}\]</span>
y la log-verosimilitud es
<span class="math display">\[LL = \sum_i \ln\!\Big( \pi \binom{m_i}{x_i} p_{iC}^{\,x_i}(1-p_{iC})^{\,m_i-x_i} + (1-\pi) \binom{m_i}{x_i} p_{iN}^{\,x_i}(1-p_{iN})^{\,m_i-x_i} \Big)\]</span></p></li>
<li><p>Probabilidad posterior de pertenecer al segmento canjeador dado
<span class="math inline">\(X_i=2\)</span> (usando probabilidades condicionales):</p>
<p><span class="math display">\[
\mathbb{P}(C \mid X_i=2) = \frac{\mathbb{P}(X_i=2 \mid C)\,\mathbb{P}(C)} {\mathbb{P}(X_i=2 \mid C)\,\mathbb{P}(C) + \mathbb{P}(X_i=2 \mid N)\,\mathbb{P}(N)}
\]</span> donde, para <span class="math inline">\(m_i=2\)</span>, <span class="math display">\[
\mathbb{P}(X_i=2 \mid C) = \binom{2}{2} \left[\frac{\exp(\beta_C&#39; z_i)}{1+\exp(\beta_C&#39; z_i)}\right]^2 \left[\frac{1}{1+\exp(\beta_C&#39; z_i)}\right]^{2-2} = \frac{4}{9}
\]</span></p>
<p><span class="math display">\[
\mathbb{P}(X_i=2 \mid N) = \binom{2}{2} \left[\frac{\exp(\beta_N&#39; z_i)}{1+\exp(\beta_N&#39; z_i)}\right]^2 \left[\frac{1}{1+\exp(\beta_N&#39; z_i)}\right]^{2-2} = \frac{1}{9}
\]</span> y, tomando <span class="math inline">\(\mathbb{P}(C)=\mathbb{P}(N)=\tfrac12\)</span>, <span class="math display">\[
\mathbb{P}(C \mid X_i=2) = \frac{\frac{4}{9}\cdot \frac12}{\frac{4}{9}\cdot \frac12 + \frac{1}{9}\cdot \frac12} = \frac{4}{5}
\]</span></p></li>
<li><p>Lectura y canje con dos etapas. La probabilidad de leer un mensaje
es:</p>
<p><span class="math display">\[
\begin{aligned}        \mathbb{P}(X_i=x_i \mid p_{\text{canjear}}, p_{\text{leer}})      &amp;= \sum_{n_i=x_i}^{m_i}         \mathbb{P}(X_i=x_i \mid p_{\text{canjear}}, n_i)\,         \mathbb{P}(N_i=n_i \mid p_{\text{leer}}) \\      &amp;= \sum_{n_i=x_i}^{m_i}         \binom{n_i}{x_i}\, p_{\text{canjear}}^{\,x_i}(1-p_{\text{canjear}})^{\,n_i-x_i}\,         \binom{m_i}{n_i}\, p_{\text{leer}}^{\,n_i}(1-p_{\text{leer}})^{\,m_i-n_i}    
\end{aligned}
\]</span></p>
<p>y la log-verosimilitud se describe como:</p>
<p><span class="math display">\[
    LL      = \sum_i \ln\!\big(\mathbb{P}(X_i=x_i \mid p_{\text{canjear}}, p_{\text{leer}})\big)    
\]</span></p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-de-regresion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-estructurales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/03-probabilisticos.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
